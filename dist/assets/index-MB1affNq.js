import{j as e,O as de,l as ot,u as it,a as nt,E as We,c as ct,e as pe}from"./index-BQSr_3cM.js";import{r as d,R as tt}from"./vendor-react-KfUPlHYY.js";import{R as dt}from"./ReportModal-DIEB58x6.js";import"./vendor-supabase-D20mg4W1.js";const _e=[{id:"cabeca",label:"ðŸ‘’ CabeÃ§a",items:["BonÃ©s","ChapÃ©us","Tiaras","LenÃ§os"]},{id:"parte-de-cima",label:"ðŸ‘• Parte de Cima",items:["Camisetas","Blusas","Regatas","Tops","Camisas","Bodies","Jaquetas","Casacos","Blazers","Moletons"]},{id:"parte-de-baixo",label:"ðŸ‘– Parte de Baixo",items:["CalÃ§as","Shorts","Bermudas","Saias","Leggings","Shorts Fitness"]},{id:"pecas-inteiras",label:"ðŸ‘— PeÃ§as Inteiras",items:["Vestidos","MacacÃµes","Jardineiras","BiquÃ­nis","MaiÃ´s"]},{id:"calcados",label:"ðŸ‘Ÿ CalÃ§ados",items:["TÃªnis","SandÃ¡lias","Botas","Sapatos","Chinelos"]},{id:"acessorios",label:"ðŸ’ AcessÃ³rios",items:["Bolsas","Cintos","RelÃ³gios","Ã“culos","Bijuterias","Mochilas","Outros AcessÃ³rios"]}],Je=x=>_e.find(u=>u.items.includes(x)),Fe=[{id:1,title:"Produtos",icon:"fa-box"},{id:2,title:"CenÃ¡rio",icon:"fa-mountain-sun"},{id:3,title:"EstÃ©tica",icon:"fa-camera-retro"},{id:4,title:"Frame & Configs",icon:"fa-sliders"}],U=({text:x,isDark:u})=>{const[r,l]=tt.useState(!1);return e.jsxs("span",{className:"relative inline-flex ml-1.5 align-middle",children:[e.jsx("button",{type:"button",onClick:I=>{I.stopPropagation(),l(!r)},className:(u?"text-neutral-500 hover:text-amber-400":"text-gray-400 hover:text-amber-500")+" transition-colors","aria-label":"Mais informaÃ§Ãµes",children:e.jsx("i",{className:"fas fa-circle-question text-[11px]"})}),r&&e.jsx("div",{className:"absolute left-0 top-full mt-1.5 z-30 w-64 rounded-lg p-3 text-xs leading-relaxed border "+(u?"bg-neutral-800 border-neutral-700 text-neutral-300":"bg-white border-gray-200 text-gray-600 "),children:x})]})};function mt(x){let r=0,l=0;x.mainProduct&&(l+=1,x.mainProductView==="both"&&(l+=1)),l+=x.additionalProducts.length,r+=l;let I=0;x.surfaceReference&&I++,x.environmentReference&&I++,x.compositionReference&&I++,x.lightingReference&&I++,x.visualStyleReference&&I++,r+=I;const ve=x.compositionElements.filter(me=>me.image).length,B=14-r,A=Math.min(ve,B),w=ve-A;return r+=A,{totalUsed:r,products:l,references:I,elementsAsImage:A,elementsAsText:w}}const xt=({theme:x,products:u,wizardState:r,onUpdateState:l,onGenerate:I,onBack:ve,userCredits:B})=>{var Le,Me,Ve,Oe;const[A,w]=d.useState(r.mainProduct?2:1),[me,ee]=d.useState(!1),[se,F]=d.useState(!1),[C,te]=d.useState(""),[M,q]=d.useState(""),[V,s]=d.useState(""),[S,Ce]=d.useState("catalog"),[le,ae]=d.useState(""),[re,oe]=d.useState(""),[G,xe]=d.useState(""),[Q,$]=d.useState(""),[W,n]=d.useState(null),[O,Y]=d.useState(!1),J=d.useRef(null),ie=d.useRef(null),[ne,m]=d.useState(!1),a=x==="dark",ue=Fe.length,K=d.useMemo(()=>u.filter(t=>{const o=!C||t.name.toLowerCase().includes(C.toLowerCase())||(t.sku||"").toLowerCase().includes(C.toLowerCase()),i=Je(t.category),g=!M||(i==null?void 0:i.id)===M,E=!V||t.category===V;return o&&g&&E}),[u,C,M,V]),je=d.useMemo(()=>u.filter(t=>{const o=!re||t.name.toLowerCase().includes(re.toLowerCase())||(t.sku||"").toLowerCase().includes(re.toLowerCase()),i=Je(t.category),g=!G||(i==null?void 0:i.id)===G,E=!Q||t.category===Q;return o&&g&&E}),[u,re,G,Q]),c=((Me=(Le=r.mainProduct)==null?void 0:Le.id)==null?void 0:Me.startsWith("upload-"))??!1,j=r.mainProduct?c?W:jt(r.mainProduct.category):null,R=ze(j),T=()=>A===1?!(!r.mainProduct||c&&!W||!c&&r.mainProductView==="back"&&!ge(r.mainProduct)):!0,Z=()=>{A<ue&&T()&&w(t=>t+1)},ce=()=>{A>1?w(t=>t-1):ve()},X=t=>{var o,i,g,E,D,be,z,ke,L,we;if((i=(o=t.generatedImages)==null?void 0:o.productStudio)!=null&&i.length){const he=t.generatedImages.productStudio[t.generatedImages.productStudio.length-1];if((g=he.images)!=null&&g.length){const fe=he.images.find(Ee=>Ee.angle==="front");if(fe!=null&&fe.url)return fe.url;if((E=he.images[0])!=null&&E.url)return he.images[0].url}}return(be=(D=t.originalImages)==null?void 0:D.front)!=null&&be.url?t.originalImages.front.url:(ke=(z=t.images)==null?void 0:z[0])!=null&&ke.url?t.images[0].url:(we=(L=t.images)==null?void 0:L[0])!=null&&we.base64?t.images[0].base64:""},ge=t=>{var o,i,g,E,D;return!!(t.hasBackImage||(i=(o=t.generatedImages)==null?void 0:o.productStudio)!=null&&i.length&&(g=t.generatedImages.productStudio[t.generatedImages.productStudio.length-1].images)!=null&&g.find(z=>z.angle==="back")||(D=(E=t.originalImages)==null?void 0:E.back)!=null&&D.url)},ye=t=>{if(r.additionalProducts.length>=4)return;const o={product_id:t.id||"",product_name:t.name,product_image_url:X(t),position_description:le,source:"catalog"};l({additionalProducts:[...r.additionalProducts,o]}),F(!1),ae(""),oe("")},f=async t=>{var g;const o=(g=t.target.files)==null?void 0:g[0];if(!o||r.additionalProducts.length>=4)return;const i=new FileReader;i.onload=()=>{const E=i.result.split(",")[1],D={product_id:"",product_name:o.name.replace(/\.[^/.]+$/,""),product_image_url:i.result,position_description:le,source:"upload",upload_base64:E,upload_mime_type:o.type};l({additionalProducts:[...r.additionalProducts,D]}),F(!1),ae("")},i.readAsDataURL(o),J.current&&(J.current.value="")},h=t=>{l({additionalProducts:r.additionalProducts.filter((o,i)=>i!==t)})},p=t=>o=>{var E;const i=(E=o.target.files)==null?void 0:E[0];if(!i)return;const g=new FileReader;g.onload=()=>{const D=g.result.split(",")[1];l({[t]:{base64:D,mimeType:i.type}})},g.readAsDataURL(i)},v=t=>{const o=new FileReader;o.onload=()=>{const i=o.result,g={id:`upload-${Date.now()}`,name:t.name.replace(/\.[^/.]+$/,""),images:[{name:t.name,url:i}],originalImages:{front:{name:t.name,url:i}},category:"",color:"",sku:""};l({mainProduct:g,productPresentation:"ai_choose",customPresentationText:""}),n(null)},o.readAsDataURL(t)},P=t=>{var i;const o=(i=t.target.files)==null?void 0:i[0];o&&v(o),ie.current&&(ie.current.value="")},N=t=>{var i;t.preventDefault(),m(!1);const o=(i=t.dataTransfer.files)==null?void 0:i[0];o&&o.type.startsWith("image/")&&v(o)},y=t=>"rounded-xl p-3 text-left transition-all cursor-pointer border "+(t?a?"bg-amber-500/20 border-amber-500/50 ring-1 ring-amber-500/30":"bg-amber-50 border-amber-400 ring-1 ring-amber-300":a?"bg-neutral-900 border-neutral-800 hover:border-neutral-700":"bg-white border-gray-200 hover:border-gray-300"),k=(t,o)=>e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas "+o+" mr-2 text-xs opacity-50"}),t]}),_=()=>e.jsx("div",{className:"my-5 border-t "+(a?"border-neutral-800":"border-gray-200")}),H=(t,o)=>o?e.jsxs("div",{className:"relative inline-block mt-2",children:[e.jsx("img",{src:`data:${o.mimeType};base64,${o.base64}`,alt:"Ref",className:"w-20 h-20 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>l({[t]:null}),className:"absolute -top-1.5 -right-1.5 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-[10px]",children:e.jsx("i",{className:"fas fa-times"})})]}):e.jsxs("label",{className:"inline-flex items-center gap-1.5 mt-2 px-3 py-1.5 rounded-lg border border-dashed cursor-pointer text-xs transition-colors "+(a?"border-neutral-700 hover:border-amber-500/50 text-neutral-500":"border-gray-300 hover:border-amber-400 text-gray-400"),children:[e.jsx("i",{className:"fas fa-cloud-arrow-up text-[10px]"}),"ReferÃªncia visual (opcional)",e.jsx("input",{type:"file",accept:"image/*",onChange:p(t),className:"hidden"})]}),Pe=()=>e.jsxs("div",{children:[k("Qual o produto principal?","fa-box"),r.mainProduct?e.jsxs("div",{className:"rounded-xl p-4 flex items-center gap-4 "+(a?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200 "),children:[e.jsx("div",{className:"w-16 h-16 rounded-lg overflow-hidden flex-shrink-0 "+(a?"bg-neutral-800":"bg-gray-100"),children:X(r.mainProduct)?e.jsx(de,{src:X(r.mainProduct)||"",alt:"",className:"w-full h-full",size:"thumb"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-image "+(a?"text-neutral-700":"text-gray-300")})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-sm font-medium truncate",children:r.mainProduct.name}),e.jsxs("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:[r.mainProduct.color&&e.jsx("span",{children:r.mainProduct.color}),r.mainProduct.category&&e.jsxs("span",{children:[" Â· ",r.mainProduct.category]})]})]}),e.jsx("button",{onClick:()=>{l({mainProduct:null,productPresentation:"ai_choose",customPresentationText:""}),n(null)},className:(a?"text-amber-400 hover:text-amber-300":"text-amber-600 hover:text-amber-500")+" text-xs font-medium",children:"Trocar"})]}):e.jsxs("div",{className:"space-y-0",children:[e.jsxs("button",{onClick:()=>ee(!0),className:"w-full rounded-t-xl p-4 text-left flex items-center gap-4 transition-all border border-b-0 "+(a?"bg-neutral-900 border-neutral-800 hover:border-amber-500/50":"bg-white border-gray-200 hover:border-amber-400 "),children:[e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 "+(a?"bg-blue-500/20":"bg-blue-100"),children:e.jsx("i",{className:"fas fa-box text-sm "+(a?"text-blue-400":"text-blue-500")})}),e.jsxs("div",{children:[e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-sm font-medium",children:"Selecionar do catÃ¡logo"}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:"Escolha um produto jÃ¡ cadastrado"})]}),e.jsx("i",{className:"fas fa-chevron-right ml-auto text-xs "+(a?"text-neutral-600":"text-gray-400")})]}),e.jsxs("div",{className:"flex items-center border-x "+(a?"border-neutral-800 bg-neutral-900":"border-gray-200 bg-white"),children:[e.jsx("div",{className:"flex-1 h-px "+(a?"bg-neutral-800":"bg-gray-200")}),e.jsx("span",{className:(a?"text-neutral-600":"text-gray-400")+" text-[10px] font-medium uppercase tracking-wider px-4 py-2",children:"ou"}),e.jsx("div",{className:"flex-1 h-px "+(a?"bg-neutral-800":"bg-gray-200")})]}),e.jsxs("div",{onDragOver:t=>{t.preventDefault(),m(!0)},onDragLeave:()=>m(!1),onDrop:N,className:"w-full rounded-b-xl p-6 text-center transition-all cursor-pointer border "+(ne?a?"border-amber-500 bg-amber-500/10 text-amber-400":"border-amber-400 bg-amber-50 text-amber-500":a?"bg-neutral-900 border-neutral-800 hover:border-amber-500/50 text-neutral-500 hover:text-amber-400":"bg-white border-gray-200 hover:border-amber-400 text-gray-400 hover:text-amber-500"),onClick:()=>{var t;return(t=ie.current)==null?void 0:t.click()},children:[e.jsx("i",{className:"text-2xl mb-2 block fas "+(ne?"fa-arrow-down":"fa-cloud-arrow-up")}),e.jsx("span",{className:"text-sm font-medium block",children:ne?"Solte a imagem aqui":"Subir imagem ou tirar foto"}),e.jsx("span",{className:"text-[10px] block mt-1 "+(a?"text-neutral-600":"text-gray-400"),children:"Arraste e solte, ou clique para selecionar Â· JPG, PNG, WebP"}),e.jsx("input",{ref:ie,type:"file",accept:"image/*",capture:"environment",onChange:P,className:"hidden"})]})]}),r.mainProduct&&!c&&e.jsxs(e.Fragment,{children:[_(),k("Qual vista do produto?","fa-camera-rotate"),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["front","back","both"].map(t=>{const o={front:"Frente",back:"Costas",both:"Ambos"},i=t!=="front"&&!ge(r.mainProduct);return e.jsx("button",{onClick:()=>!i&&l({mainProductView:t}),className:i?"rounded-xl p-3 text-center border opacity-50 cursor-not-allowed "+(a?"bg-neutral-900/50 border-neutral-800":"bg-gray-50 border-gray-200"):y(r.mainProductView===t)+" text-center",children:e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:o[t]})},t)})}),r.mainProductView==="both"&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs mb-2",children:"Qual Ã© o destaque?"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["front","back"].map(t=>e.jsx("button",{onClick:()=>l({mainProductHighlight:t}),className:y(r.mainProductHighlight===t)+" text-center",children:e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t==="front"?"Frente":"Costas"})},t))})]})]}),r.mainProduct&&c&&e.jsxs(e.Fragment,{children:[_(),k("Que tipo de produto Ã©?","fa-tag"),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:vt.map(t=>e.jsxs("button",{onClick:()=>{n(t.id),ze(t.id).find(i=>i.id===r.productPresentation)||l({productPresentation:"ai_choose",customPresentationText:""})},className:y(W===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(W===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id))})]}),r.mainProduct&&j&&e.jsxs(e.Fragment,{children:[_(),k("Como quer exibir o produto?","fa-shirt"),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:R.map(t=>e.jsxs("button",{onClick:()=>l({productPresentation:t.id,...t.id!=="custom"?{customPresentationText:""}:{}}),className:y(r.productPresentation===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.productPresentation===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id))}),r.productPresentation==="custom"&&e.jsx("textarea",{value:r.customPresentationText,onChange:t=>l({customPresentationText:t.target.value}),placeholder:"Ex: BonÃ© apoiado de lado sobre uma superfÃ­cie de madeira...",rows:3,className:"w-full rounded-lg px-3 py-2 text-sm outline-none border transition-colors resize-none mt-3 "+(a?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-600 focus:border-amber-500/50":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400 focus:border-amber-400")})]}),r.mainProduct&&e.jsxs(e.Fragment,{children:[_(),e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-up-right-and-down-left-from-center mr-2 text-xs opacity-50"}),"Escala na imagem",e.jsx(U,{isDark:a,text:"Define o quÃ£o prÃ³ximo o produto aparece na foto. Close-up mostra detalhes de textura, Completo mostra o produto inteiro com espaÃ§o ao redor."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:Ue.map(t=>e.jsxs("button",{onClick:()=>l({productScale:t.id}),className:y(r.productScale===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.productScale===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id))})]}),_(),k("Produtos complementares (atÃ© 4)","fa-layer-group"),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs mb-3 -mt-1",children:"Adicione outros produtos para compor a cena (opcional)"}),r.additionalProducts.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:r.additionalProducts.map((t,o)=>e.jsxs("div",{className:"rounded-lg p-3 flex items-center gap-3 "+(a?"bg-neutral-900 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[t.product_image_url?e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden flex-shrink-0 "+(a?"bg-neutral-800":"bg-gray-100"),children:e.jsx(de,{src:t.product_image_url||"",alt:"",className:"w-full h-full",size:"thumb"})}):e.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 "+(a?"bg-neutral-800":"bg-gray-200"),children:e.jsx("i",{className:"fas fa-image text-xs "+(a?"text-neutral-600":"text-gray-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:t.product_name}),e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded-full mt-0.5 inline-block "+(t.source==="catalog"?a?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-600":a?"bg-green-500/20 text-green-400":"bg-green-100 text-green-600"),children:t.source==="catalog"?"CatÃ¡logo":"Upload"})]}),e.jsx("button",{onClick:()=>h(o),className:(a?"text-neutral-600 hover:text-red-400":"text-gray-400 hover:text-red-500")+" transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]},o))}),r.additionalProducts.length<4&&e.jsxs("button",{onClick:()=>F(!0),className:"w-full rounded-lg p-3 border border-dashed text-center text-xs font-medium transition-colors "+(a?"border-neutral-700 hover:border-amber-500/50 text-neutral-500 hover:text-amber-400":"border-gray-300 hover:border-amber-400 text-gray-400 hover:text-amber-500"),children:[e.jsx("i",{className:"fas fa-plus mr-1.5"}),"Adicionar produto"]})]}),De=()=>e.jsxs("div",{children:[e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-table mr-2 text-xs opacity-50"}),"SuperfÃ­cie",e.jsx(U,{isDark:a,text:"A base onde o produto serÃ¡ colocado. Ex: mÃ¡rmore branco, madeira rÃºstica, concreto polido, areia."})]}),e.jsx("textarea",{value:r.surfaceDescription,onChange:t=>l({surfaceDescription:t.target.value}),placeholder:'Ex: "MÃ¡rmore branco com veios dourados", "Madeira rÃºstica envelhecida"',className:"w-full rounded-lg p-3 text-sm resize-none h-20 "+(a?"bg-neutral-900 border border-neutral-800 text-white placeholder-neutral-600":"bg-white border border-gray-200 text-gray-900 placeholder-gray-400")}),H("surfaceReference",r.surfaceReference),_(),e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-mountain-sun mr-2 text-xs opacity-50"}),"Ambiente / Contexto",e.jsx(U,{isDark:a,text:"O fundo e cenÃ¡rio ao redor. Ex: jardim com plantas tropicais, estÃºdio minimalista, praia ao entardecer."})]}),e.jsx("textarea",{value:r.environmentDescription,onChange:t=>l({environmentDescription:t.target.value}),placeholder:'Ex: "Jardim tropical ao fundo", "EstÃºdio com parede de tijolos"',className:"w-full rounded-lg p-3 text-sm resize-none h-20 "+(a?"bg-neutral-900 border border-neutral-800 text-white placeholder-neutral-600":"bg-white border border-gray-200 text-gray-900 placeholder-gray-400")}),H("environmentReference",r.environmentReference),_(),e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-leaf mr-2 text-xs opacity-50"}),"Elementos de composiÃ§Ã£o",e.jsx(U,{isDark:a,text:"Objetos decorativos que complementam a cena. Ex: flores secas, folhas, conchas, velas, tecidos."})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs mb-3 -mt-1",children:"Adicione elementos decorativos para a cena (atÃ© 6)"}),r.compositionElements.length>0&&e.jsx("div",{className:"space-y-2 mb-3",children:r.compositionElements.map((t,o)=>e.jsxs("div",{className:"rounded-lg p-3 flex items-start gap-3 "+(a?"bg-neutral-900 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{value:t.description,onChange:i=>{const g=[...r.compositionElements];g[o]={...g[o],description:i.target.value},l({compositionElements:g})},placeholder:"Descreva o elemento...",rows:2,className:"w-full rounded-md px-2 py-1.5 text-xs resize-none "+(a?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-white border border-gray-200 text-gray-900 placeholder-gray-400")}),t.image?e.jsxs("div",{className:"relative inline-block mt-2",children:[e.jsx("img",{src:`data:${t.image.mimeType};base64,${t.image.base64}`,alt:"",className:"w-16 h-16 object-cover rounded-lg"}),e.jsx("button",{onClick:()=>{const i=[...r.compositionElements];i[o]={...i[o],image:void 0},l({compositionElements:i})},className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white rounded-full flex items-center justify-center text-[8px]",children:e.jsx("i",{className:"fas fa-times"})})]}):e.jsxs("label",{className:"inline-flex items-center gap-1 mt-2 px-2 py-1 rounded border border-dashed cursor-pointer text-[10px] transition-colors "+(a?"border-neutral-700 text-neutral-500 hover:border-amber-500/50":"border-gray-300 text-gray-400 hover:border-amber-400"),children:[e.jsx("i",{className:"fas fa-image"})," Imagem (opcional)",e.jsx("input",{type:"file",accept:"image/*",onChange:i=>{var D;const g=(D=i.target.files)==null?void 0:D[0];if(!g)return;const E=new FileReader;E.onload=()=>{const be=E.result.split(",")[1],z=[...r.compositionElements];z[o]={...z[o],image:{base64:be,mimeType:g.type}},l({compositionElements:z})},E.readAsDataURL(g)},className:"hidden"})]})]}),e.jsx("button",{onClick:()=>{l({compositionElements:r.compositionElements.filter((i,g)=>g!==o)})},className:(a?"text-neutral-600 hover:text-red-400":"text-gray-400 hover:text-red-500")+" transition-colors mt-1",children:e.jsx("i",{className:"fas fa-times"})})]},o))}),r.compositionElements.length<6&&e.jsxs("button",{onClick:()=>l({compositionElements:[...r.compositionElements,{description:""}]}),className:"w-full rounded-lg p-3 border border-dashed text-center text-xs font-medium transition-colors "+(a?"border-neutral-700 hover:border-amber-500/50 text-neutral-500 hover:text-amber-400":"border-gray-300 hover:border-amber-400 text-gray-400 hover:text-amber-500"),children:[e.jsx("i",{className:"fas fa-plus mr-1.5"}),"Adicionar elemento"]}),_(),e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-image mr-2 text-xs opacity-50"}),"ReferÃªncia de composiÃ§Ã£o (opcional)",e.jsx(U,{isDark:a,text:"Uma foto de referÃªncia para o estilo geral de composiÃ§Ã£o que vocÃª quer. A IA usarÃ¡ como inspiraÃ§Ã£o."})]}),H("compositionReference",r.compositionReference),_(),e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-sun mr-2 text-xs opacity-50"}),"Mood / EstaÃ§Ã£o",e.jsx(U,{isDark:a,text:"Define a atmosfera e paleta de cores geral. Influencia tons, texturas e sensaÃ§Ã£o da imagem."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:Qe.map(t=>e.jsx("button",{onClick:()=>l({moodSeason:t.id,...t.id!=="custom"?{customMoodSeason:""}:{}}),className:y(r.moodSeason===t.id),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.moodSeason===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]})},t.id))}),r.moodSeason==="custom"&&e.jsx("textarea",{value:r.customMoodSeason,onChange:t=>l({customMoodSeason:t.target.value}),placeholder:"Descreva o mood/estaÃ§Ã£o desejado...",rows:2,className:"w-full rounded-lg px-3 py-2 text-sm resize-none mt-3 "+(a?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-gray-50 border border-gray-200 text-gray-900 placeholder-gray-400")})]}),Ne=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"rounded-xl p-4 mb-4 "+(a?"bg-neutral-900/50 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-4",children:[e.jsx("i",{className:"fas fa-camera mr-2 text-xs opacity-50"}),"Enquadramento"]}),e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs font-medium mb-2",children:["Modelo da Lente",e.jsx(U,{isDark:a,text:"A lente define a perspectiva e o estilo visual da foto. Wide cria drama, Standard Ã© versÃ¡til, Portrait desfoca o fundo, Macro captura detalhes extremos."})]}),["wide","standard","portrait","macro","ai"].map(t=>{const o=Ze.filter(g=>g.category===t),i={wide:"Wide",standard:"Standard",portrait:"Portrait",macro:"Macro",ai:""};return e.jsxs("div",{className:"mb-2",children:[i[t]&&e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] font-medium uppercase tracking-wide mb-1",children:i[t]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:o.map(g=>e.jsxs("button",{onClick:()=>l({lensModel:g.id}),className:y(r.lensModel===g.id),children:[e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium block",children:g.label}),e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] block",children:g.description})]},g.id))})]},t)}),e.jsx("div",{className:"my-4 border-t "+(a?"border-neutral-800":"border-gray-200")}),e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs font-medium mb-2",children:["Ã‚ngulo de cÃ¢mera",e.jsx(U,{isDark:a,text:"Define de onde a cÃ¢mera aponta para o produto. Top-Down Ã© visto de cima, 45Â° Ã© angular, Eye-Level Ã© frontal, Low Angle Ã© de baixo para cima."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-4",children:Xe.map(t=>e.jsxs("button",{onClick:()=>l({cameraAngle:t.id}),className:y(r.cameraAngle===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.cameraAngle===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id))}),e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs font-medium mb-2",children:["Profundidade de campo",e.jsx(U,{isDark:a,text:"Controla o desfoque do fundo. Ã€ esquerda tudo fica nÃ­tido, Ã  direita sÃ³ o produto fica em foco (efeito bokeh)."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] w-16 text-right",children:"Tudo em foco"}),e.jsx("input",{type:"range",min:0,max:100,value:r.depthOfField,onChange:t=>l({depthOfField:Number(t.target.value)}),className:"flex-1 accent-amber-500"}),e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] w-16",children:"Bokeh intenso"})]})]}),e.jsxs("div",{className:"rounded-xl p-4 mb-4 "+(a?"bg-neutral-900/50 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-4",children:[e.jsx("i",{className:"fas fa-palette mr-2 text-xs opacity-50"}),"Estilo Visual",e.jsx(U,{isDark:a,text:"Combina cor, contraste e textura da imagem final. Cada preset aplica uma combinaÃ§Ã£o coerente desses elementos."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-2",children:Ye.map(t=>e.jsxs("button",{onClick:()=>l({visualStyle:t.id,...t.id!=="custom"?{customVisualStyle:""}:{}}),className:y(r.visualStyle===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.visualStyle===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id))}),r.visualStyle==="custom"&&e.jsx("textarea",{value:r.customVisualStyle,onChange:t=>l({customVisualStyle:t.target.value}),placeholder:"Descreva o estilo visual desejado (cores, contraste, grÃ£o, temperatura)...",rows:2,className:"w-full rounded-lg px-3 py-2 text-sm resize-none mb-2 "+(a?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-white border border-gray-200 text-gray-900 placeholder-gray-400")}),H("visualStyleReference",r.visualStyleReference)]}),e.jsxs("div",{className:"rounded-xl p-4 "+(a?"bg-neutral-900/50 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsxs("h3",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold mb-4",children:[e.jsx("i",{className:"fas fa-lightbulb mr-2 text-xs opacity-50"}),"IluminaÃ§Ã£o"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2 mb-2",children:[Ke.map(t=>e.jsxs("button",{onClick:()=>l({lighting:t.id,...t.id!=="custom"?{customLighting:""}:{}}),className:y(r.lighting===t.id),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas "+t.icon+" text-xs "+(r.lighting===t.id?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:t.label})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:t.description})]},t.id)),e.jsxs("button",{onClick:()=>l({lighting:"custom"}),className:y(r.lighting==="custom"),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("i",{className:"fas fa-pen text-xs "+(r.lighting==="custom"?a?"text-amber-400":"text-amber-500":a?"text-neutral-500":"text-gray-400")}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:"Personalizado"})]}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:"Descreva a iluminaÃ§Ã£o"})]})]}),r.lighting==="custom"&&e.jsx("textarea",{value:r.customLighting,onChange:t=>l({customLighting:t.target.value}),placeholder:"Descreva a iluminaÃ§Ã£o desejada...",rows:2,className:"w-full rounded-lg px-3 py-2 text-sm resize-none mb-2 "+(a?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-white border border-gray-200 text-gray-900 placeholder-gray-400")}),H("lightingReference",r.lightingReference)]})]}),Te=()=>{var we,he,fe,Ee,Be,qe,Se,Ge,$e;const t=mt(r),o=r.lighting==="custom"?r.customLighting||"Personalizado":((we=Ke.find(b=>b.id===r.lighting))==null?void 0:we.label)||r.lighting,i=((he=Ze.find(b=>b.id===r.lensModel))==null?void 0:he.label)||r.lensModel,g=((fe=Xe.find(b=>b.id===r.cameraAngle))==null?void 0:fe.label)||r.cameraAngle,E=r.visualStyle==="custom"?r.customVisualStyle||"Personalizado":((Ee=Ye.find(b=>b.id===r.visualStyle))==null?void 0:Ee.label)||r.visualStyle,D=((Be=et.find(b=>b.id===r.frameRatio))==null?void 0:Be.label)||r.frameRatio,be=((qe=Ue.find(b=>b.id===r.productScale))==null?void 0:qe.label)||r.productScale,z=r.moodSeason==="custom"?r.customMoodSeason||"Personalizado":((Se=Qe.find(b=>b.id===r.moodSeason))==null?void 0:Se.label)||r.moodSeason,ke=r.productPresentation==="custom"?r.customPresentationText||"Personalizado":((Ge=Ae.find(b=>b.id===r.productPresentation))==null?void 0:Ge.label)||r.productPresentation,L=({icon:b,label:Re,value:st,onEdit:lt})=>e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("i",{className:"fas "+b+" text-xs w-4 text-center "+(a?"text-neutral-600":"text-gray-400")}),e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs w-20 flex-shrink-0",children:Re}),e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:st})]}),e.jsx("button",{onClick:lt,className:(a?"text-amber-400 hover:text-amber-300":"text-amber-600 hover:text-amber-500")+" text-[10px] font-medium flex-shrink-0 ml-2",children:"Editar"})]});return e.jsxs("div",{children:[k("Formato da imagem","fa-crop-simple"),e.jsx("div",{className:"grid grid-cols-4 gap-2 mb-4",children:et.map(b=>e.jsxs("button",{onClick:()=>l({frameRatio:b.id}),className:y(r.frameRatio===b.id)+" text-center",children:[e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold block",children:b.label}),e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] block",children:b.description})]},b.id))}),_(),k("ResoluÃ§Ã£o","fa-display"),e.jsx("div",{className:"grid grid-cols-2 gap-2 mb-4",children:ft.map(b=>e.jsxs("button",{onClick:()=>l({resolution:b.id}),className:y(r.resolution===b.id)+" text-center",children:[e.jsx("span",{className:(a?"text-white":"text-gray-900")+" text-sm font-semibold block",children:b.label}),e.jsx("span",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] block",children:b.description})]},b.id))}),_(),k("VariaÃ§Ãµes","fa-clone"),e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("input",{type:"range",min:1,max:10,value:r.variationsCount,onChange:b=>l({variationsCount:Number(b.target.value)}),className:"flex-1 accent-amber-500"}),e.jsx("div",{className:"px-3 py-1.5 rounded-lg text-sm font-bold min-w-[3rem] text-center "+(a?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-600"),children:r.variationsCount})]}),e.jsxs("p",{className:(a?"text-amber-400/80":"text-amber-600")+" text-xs",children:[e.jsx("i",{className:"fas fa-coins mr-1.5 text-[10px]"}),r.variationsCount," ",r.variationsCount===1?"crÃ©dito serÃ¡ utilizado":"crÃ©ditos serÃ£o utilizados"]}),_(),e.jsxs("div",{className:"flex items-start gap-3 mb-6",children:[e.jsx("input",{type:"checkbox",checked:r.saveAsTemplate,onChange:b=>l({saveAsTemplate:b.target.checked}),className:"mt-1 accent-amber-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium",children:"Salvar este estilo como template"}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px]",children:"Para reutilizar com outros produtos"}),r.saveAsTemplate&&e.jsx("input",{value:r.templateName,onChange:b=>l({templateName:b.target.value}),placeholder:"Nome do template...",className:"mt-2 w-full rounded-lg px-3 py-2 text-sm "+(a?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-gray-50 border border-gray-200 text-gray-900 placeholder-gray-400")})]})]}),_(),k("Resumo do seu Vizzu Still CriativoÂ®","fa-clipboard-list"),e.jsxs("div",{className:"rounded-xl overflow-hidden divide-y "+(a?"bg-neutral-900 border border-neutral-800 divide-neutral-800":"bg-white border border-gray-200 divide-gray-100 "),children:[e.jsxs("div",{className:"px-4",children:[e.jsx(L,{icon:"fa-box",label:"Produto",value:((($e=r.mainProduct)==null?void 0:$e.name)||"Nenhum")+(r.mainProductView==="both"?" (Ambos)":r.mainProductView==="back"?" (Costas)":" (Frente)"),onEdit:()=>w(1)}),r.additionalProducts.length>0&&e.jsx("div",{className:"pb-2",children:r.additionalProducts.map((b,Re)=>e.jsxs("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[10px] ml-6 pl-1",children:["+ ",b.product_name]},Re))})]}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-shirt",label:"ExibiÃ§Ã£o",value:ke,onEdit:()=>w(1)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-up-right-and-down-left-from-center",label:"Escala",value:be,onEdit:()=>w(1)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-table",label:"SuperfÃ­cie",value:r.surfaceDescription||"NÃ£o definido",onEdit:()=>w(2)})}),r.environmentDescription&&e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-mountain-sun",label:"Ambiente",value:r.environmentDescription,onEdit:()=>w(2)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-sun",label:"Mood",value:z,onEdit:()=>w(2)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-lightbulb",label:"IluminaÃ§Ã£o",value:o,onEdit:()=>w(3)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-circle-dot",label:"Lente",value:i,onEdit:()=>w(3)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-rotate",label:"Ã‚ngulo",value:g,onEdit:()=>w(3)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-palette",label:"Estilo Visual",value:E,onEdit:()=>w(3)})}),e.jsx("div",{className:"px-4",children:e.jsx(L,{icon:"fa-crop-simple",label:"Formato",value:D+" Â· "+r.resolution.toUpperCase(),onEdit:()=>w(4)})})]}),e.jsxs("div",{className:"mt-4 rounded-xl overflow-hidden "+(a?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200 "),children:[e.jsxs("button",{onClick:()=>Y(!O),className:"w-full px-4 py-3 flex items-center justify-between text-left "+(a?"hover:bg-neutral-800/50":"hover:bg-gray-50"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"ðŸ“Š"}),e.jsxs("span",{className:(a?"text-white":"text-gray-900")+" text-xs font-semibold",children:["Budget de Imagens (",t.totalUsed,"/14 usadas)",e.jsx(U,{isDark:a,text:"A IA aceita atÃ© 14 imagens por geraÃ§Ã£o. Produtos tÃªm prioridade mÃ¡xima, depois referÃªncias, depois elementos."})]})]}),e.jsx("i",{className:"fas fa-chevron-"+(O?"up":"down")+" text-xs "+(a?"text-neutral-500":"text-gray-400")})]}),O&&e.jsx("div",{className:"px-4 pb-3 space-y-1.5 border-t "+(a?"border-neutral-800":"border-gray-200"),children:e.jsxs("div",{className:"pt-2",children:[e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs",children:[e.jsx("span",{className:"font-medium",children:"Produtos:"})," ",t.products," ",t.products===1?"imagem":"imagens"," (prioridade mÃ¡xima)"]}),e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs",children:[e.jsx("span",{className:"font-medium",children:"ReferÃªncias visuais:"})," ",t.references," ",t.references===1?"imagem":"imagens"]}),e.jsxs("p",{className:(a?"text-neutral-400":"text-gray-600")+" text-xs",children:[e.jsx("span",{className:"font-medium",children:"Elementos de composiÃ§Ã£o:"})," ",t.elementsAsImage," como imagem",t.elementsAsText>0?`, ${t.elementsAsText} transcritos em texto`:""]})]})})]})]})},at=()=>{switch(A){case 1:return Pe();case 2:return De();case 3:return Ne();case 4:return Te();default:return null}},rt=A===ue;return e.jsxs("div",{className:"flex-1 overflow-y-auto "+(a?"":"bg-cream"),style:{paddingTop:"max(1rem, env(safe-area-inset-top, 1rem))"},children:[e.jsxs("div",{className:"max-w-2xl mx-auto p-4 md:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ce,className:(a?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-900")+" p-2 -ml-2 rounded-lg transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:(a?"text-white":"text-[#1A1A1A]")+" text-lg font-extrabold",children:"Vizzu Still CriativoÂ®"}),e.jsxs("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:["Passo ",A," de ",ue]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium "+(a?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-amber-50 text-amber-600 border border-amber-200"),children:[e.jsx("i",{className:"fas fa-coins text-[10px]"}),e.jsx("span",{children:B.toLocaleString()})]})]}),e.jsx("div",{className:"flex items-center gap-1 mb-6",children:Fe.map((t,o)=>e.jsxs(tt.Fragment,{children:[e.jsxs("button",{onClick:()=>{t.id<A&&w(t.id)},className:"flex items-center gap-1.5 px-2 py-1 rounded-full text-[10px] font-medium transition-all "+(t.id===A?a?"bg-amber-500/20 text-amber-400 border border-amber-500/40":"bg-amber-100 text-amber-600 border border-amber-300":t.id<A?a?"bg-green-500/20 text-green-400 border border-green-500/30 cursor-pointer":"bg-green-100 text-green-600 border border-green-300 cursor-pointer":a?"bg-neutral-800 text-neutral-600 border border-neutral-700":"bg-gray-100 text-gray-400 border border-gray-200"),children:[e.jsx("i",{className:"fas "+(t.id<A?"fa-check":t.icon)+" text-[8px]"}),e.jsx("span",{className:"hidden md:inline",children:t.title})]}),o<Fe.length-1&&e.jsx("div",{className:"flex-1 h-px "+(t.id<A?a?"bg-green-500/30":"bg-green-300":a?"bg-neutral-800":"bg-gray-200")})]},t.id))}),at(),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{onClick:ce,className:"flex-1 py-3 rounded-xl font-medium text-sm transition-all "+(a?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Voltar"]}),rt?e.jsxs("button",{onClick:I,disabled:B<r.variationsCount,className:"flex-1 py-3 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-xl font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles mr-2"}),"Gerar ",r.variationsCount," ",r.variationsCount===1?"VariaÃ§Ã£o":"VariaÃ§Ãµes"," (",r.variationsCount," ",r.variationsCount===1?"crÃ©dito":"crÃ©ditos",")"]}):T()&&e.jsxs("button",{onClick:Z,className:"flex-1 py-3 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-xl font-medium text-sm",children:["Continuar",e.jsx("i",{className:"fas fa-arrow-right ml-2"})]})]})]}),me&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:(a?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" rounded-2xl border w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:(a?"border-neutral-800":"border-gray-200")+" border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:(a?"text-white":"text-gray-900")+" text-lg font-semibold font-serif",children:"Selecione o produto"}),e.jsxs("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:[K.length," produto",K.length!==1?"s":""," disponÃ­veis"]})]}),e.jsx("button",{onClick:()=>{ee(!1),te(""),q(""),s("")},className:(a?"text-neutral-500 hover:text-white":"text-gray-400 hover:text-gray-600")+" w-8 h-8 flex items-center justify-center rounded-lg hover:bg-neutral-800/50 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-4 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("i",{className:(a?"text-neutral-600":"text-gray-400")+" fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-sm"}),e.jsx("input",{type:"text",placeholder:"Buscar produto...",value:C,onChange:t=>te(t.target.value),className:(a?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full pl-10 pr-4 py-2.5 border rounded-xl text-sm focus:outline-none focus:border-amber-500/50",autoFocus:!0})]}),e.jsxs("select",{value:M,onChange:t=>{q(t.target.value),s("")},className:(a?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Categoria"}),_e.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]}),M&&e.jsxs("select",{value:V,onChange:t=>s(t.target.value),className:(a?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Subcategoria"}),(Ve=_e.find(t=>t.id===M))==null?void 0:Ve.items.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pt-0",children:K.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:K.map(t=>{const o=X(t);return e.jsxs("div",{onClick:()=>{l({mainProduct:t,mainProductView:"front",productPresentation:"ai_choose",customPresentationText:""}),n(null),ee(!1),te(""),q(""),s("")},className:(a?"bg-neutral-800 border-neutral-700 hover:border-amber-500/50":"bg-gray-50 border-gray-200 hover:border-amber-300")+" rounded-xl border overflow-hidden cursor-pointer transition-all group",children:[e.jsxs("div",{className:(a?"bg-neutral-700":"bg-gray-100")+" aspect-square relative overflow-hidden",children:[e.jsx(de,{src:o,size:"preview",alt:t.name,className:"w-full h-full group-hover:scale-105 transition-transform"}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("button",{className:"w-full py-1.5 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-lg font-medium text-[10px]",children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Selecionar"]})})]}),e.jsxs("div",{className:"p-2.5",children:[e.jsx("p",{className:(a?"text-neutral-500":"text-gray-400")+" text-[8px] font-medium uppercase tracking-wide",children:t.sku}),e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium truncate mt-0.5",children:t.name}),t.category&&e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[9px] mt-1",children:t.category})]})]},t.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:(a?"bg-neutral-800":"bg-gray-100")+" w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:(a?"text-neutral-600":"text-gray-400")+" fas fa-search text-xl"})}),e.jsx("p",{className:(a?"text-white":"text-gray-900")+" font-medium text-sm mb-1",children:"Nenhum produto encontrado"}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:"Tente ajustar os filtros"})]})})]})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:(a?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" rounded-2xl border w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:(a?"border-neutral-800":"border-gray-200")+" border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:(a?"text-white":"text-gray-900")+" text-lg font-semibold font-serif",children:"Adicionar Produto"}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:"Selecione um produto adicional para a composiÃ§Ã£o"})]}),e.jsx("button",{onClick:()=>{F(!1),oe(""),xe(""),$("")},className:(a?"text-neutral-500 hover:text-white":"text-gray-400 hover:text-gray-600")+" w-8 h-8 flex items-center justify-center rounded-lg hover:bg-neutral-800/50 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"flex border-b "+(a?"border-neutral-800":"border-gray-200"),children:[{id:"catalog",label:"Do CatÃ¡logo",icon:"fa-box"},{id:"upload",label:"Foto / Upload",icon:"fa-camera"}].map(t=>e.jsxs("button",{onClick:()=>Ce(t.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2.5 text-xs font-medium transition-colors border-b-2 "+(S===t.id?a?"border-amber-500 text-amber-400":"border-amber-500 text-amber-600":a?"border-transparent text-neutral-500 hover:text-white":"border-transparent text-gray-400 hover:text-gray-600"),children:[e.jsx("i",{className:"fas "+t.icon+" text-[10px]"}),t.label]},t.id))}),e.jsx("div",{className:"p-4 pb-0",children:e.jsx("input",{value:le,onChange:t=>ae(t.target.value),placeholder:"Posicionamento: ex. ao lado esquerdo, levemente inclinado",className:(a?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-4 py-2.5 border rounded-xl text-sm focus:outline-none focus:border-amber-500/50"})}),S==="catalog"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 pb-0 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("i",{className:(a?"text-neutral-600":"text-gray-400")+" fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-sm"}),e.jsx("input",{type:"text",placeholder:"Buscar produto...",value:re,onChange:t=>oe(t.target.value),className:(a?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full pl-10 pr-4 py-2.5 border rounded-xl text-sm focus:outline-none focus:border-amber-500/50"})]}),e.jsxs("select",{value:G,onChange:t=>{xe(t.target.value),$("")},className:(a?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Categoria"}),_e.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))]}),G&&e.jsxs("select",{value:Q,onChange:t=>$(t.target.value),className:(a?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Subcategoria"}),(Oe=_e.find(t=>t.id===G))==null?void 0:Oe.items.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:je.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:je.map(t=>{const o=X(t);return e.jsxs("div",{onClick:()=>ye(t),className:(a?"bg-neutral-800 border-neutral-700 hover:border-amber-500/50":"bg-gray-50 border-gray-200 hover:border-amber-300")+" rounded-xl border overflow-hidden cursor-pointer transition-all group",children:[e.jsxs("div",{className:(a?"bg-neutral-700":"bg-gray-100")+" aspect-square relative overflow-hidden",children:[e.jsx(de,{src:o,size:"preview",alt:t.name,className:"w-full h-full group-hover:scale-105 transition-transform"}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("button",{className:"w-full py-1.5 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-lg font-medium text-[10px]",children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Adicionar"]})})]}),e.jsxs("div",{className:"p-2.5",children:[e.jsx("p",{className:(a?"text-neutral-500":"text-gray-400")+" text-[8px] font-medium uppercase tracking-wide",children:t.sku}),e.jsx("p",{className:(a?"text-white":"text-gray-900")+" text-xs font-medium truncate mt-0.5",children:t.name}),t.category&&e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-[9px] mt-1",children:t.category})]})]},t.id)})}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:(a?"bg-neutral-800":"bg-gray-100")+" w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:(a?"text-neutral-600":"text-gray-400")+" fas fa-search text-xl"})}),e.jsx("p",{className:(a?"text-white":"text-gray-900")+" font-medium text-sm mb-1",children:"Nenhum produto encontrado"}),e.jsx("p",{className:(a?"text-neutral-500":"text-gray-500")+" text-xs",children:"Tente ajustar os filtros"})]})})]}),S==="upload"&&e.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:e.jsxs("label",{className:"block rounded-xl p-8 border-2 border-dashed cursor-pointer transition-colors w-full text-center "+(a?"border-neutral-700 hover:border-amber-500/50 text-neutral-500":"border-gray-300 hover:border-amber-400 text-gray-400"),children:[e.jsx("i",{className:"fas fa-camera text-3xl mb-3 block"}),e.jsx("span",{className:"text-sm font-medium block",children:"Tirar foto ou selecionar imagem"}),e.jsx("span",{className:"text-[10px] block mt-1",children:"JPG, PNG ou WebP"}),e.jsx("input",{ref:J,type:"file",accept:"image/*",capture:"environment",onChange:f,className:"hidden"})]})})]})})]})},ut=`
 @keyframes stillColorCycle {
 0%, 100% { filter: sepia(1) saturate(3) hue-rotate(20deg) brightness(1.1); }
 33% { filter: sepia(1) saturate(3) hue-rotate(35deg) brightness(1.2); }
 66% { filter: sepia(1) saturate(2.5) hue-rotate(10deg) brightness(1.1); }
 }
 .vizzu-still-lottie-gradient {
 animation: stillColorCycle 3s ease-in-out infinite;
 }
`,He=["Preparando a composiÃ§Ã£o criativa...","Analisando a estÃ©tica escolhida...","Montando a superfÃ­cie e cenÃ¡rio...","Posicionando o produto principal...","Adicionando elementos decorativos...","Ajustando a iluminaÃ§Ã£o da cena...","Configurando cÃ¢mera e lente...","Renderizando em alta qualidade...","Aplicando acabamentos finais...","Quase pronto! Ãšltimos ajustes..."];function gt(x){return x?x.variation_urls&&x.variation_urls.length>0?x.variation_urls:[x.variation_1_url,x.variation_2_url].filter(Boolean):[]}function bt(x){return x<=2?"grid-cols-1 md:grid-cols-2":x<=6?"grid-cols-2 md:grid-cols-3":"grid-cols-2 md:grid-cols-3 lg:grid-cols-4"}const ht=({theme:x,generation:u,wizardState:r,isGenerating:l,progress:I,loadingText:ve,onBackToHome:B,onGenerateAgain:A,onSaveTemplate:w,onMinimize:me,isMinimized:ee})=>{var c,j,R,T,Z,ce,X,ge,ye,f;const{openViewer:se}=ot(),[F,C]=d.useState(null),[te,M]=d.useState(!1),[q,V]=d.useState(""),[s,S]=d.useState(!1),[Ce,le]=d.useState(!1),[ae,re]=d.useState(!1),[oe,G]=d.useState(!1),[xe,Q]=d.useState(null),{user:$}=it(),{showToast:W}=nt(),n=x==="dark",O=d.useMemo(()=>gt(u),[u]),Y=(u==null?void 0:u.variations_requested)??r.variationsCount??2,J=(u==null?void 0:u.credits_used)??Y,[ie,ne]=d.useState(0);d.useEffect(()=>{if(!l)return;ne(0);const h=setInterval(()=>{ne(p=>(p+1)%He.length)},3e3);return()=>clearInterval(h)},[l]),d.useEffect(()=>{if(l)re(!0);else if(ae&&O.length>0&&(u==null?void 0:u.status)!=="failed"){le(!0);const h=setTimeout(()=>le(!1),2500);return()=>clearTimeout(h)}},[l,ae,O.length,u==null?void 0:u.status]);const m=async()=>{if(q.trim()){S(!0);try{await w(q),M(!1),V("")}finally{S(!1)}}},a=async h=>{var v,P,N,y,k,_,H;if(!$||!xe)return;const p=await ct({userId:$.id,userEmail:$.email||"",userName:$.name||$.email||"",generationType:"creative-still",generationId:u==null?void 0:u.id,productName:((v=r.mainProduct)==null?void 0:v.name)||"Still Criativo",generatedImageUrl:xe,originalImageUrl:((y=(N=(P=r.mainProduct)==null?void 0:P.originalImages)==null?void 0:N.front)==null?void 0:y.url)||((H=(_=(k=r.mainProduct)==null?void 0:k.images)==null?void 0:_[0])==null?void 0:H.url)||void 0,observation:h});if(p.success)W("Report enviado! Analisaremos em atÃ© 24h.","success");else throw new Error(p.error||"Erro ao enviar report")},ue=(h,p)=>{var P;const v=document.createElement("a");v.href=h,v.download=`still-criativo-${((P=r.mainProduct)==null?void 0:P.name)||"produto"}-v${p}.png`,v.click()};if(l&&!ee)return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-xl "+(n?"bg-black/80":"bg-white/80")}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center max-w-md mx-auto p-6",children:[me&&e.jsx("button",{onClick:me,className:"absolute top-2 right-2 w-10 h-10 rounded-xl flex items-center justify-center transition-all "+(n?"bg-white/10 border border-white/20 text-neutral-300 hover:text-white hover:bg-white/15":"bg-black/5 border border-gray-200 text-gray-500 hover:text-gray-700 hover:bg-black/10"),title:"Minimizar",children:e.jsx("i",{className:"fas fa-minus text-sm"})}),e.jsx("style",{children:ut}),e.jsx("div",{className:"w-64 h-64 mb-6 vizzu-still-lottie-gradient",children:e.jsx(We,{src:"https://lottie.host/d29d70f3-bf03-4212-b53f-932dbefb9077/kIkLDFupvi.lottie",loop:!0,autoplay:!0,style:{width:"100%",height:"100%"}})}),e.jsx("h2",{className:(n?"text-white":"text-[#1A1A1A]")+" text-2xl font-bold font-serif mb-2 text-center",children:"Criando seu Vizzu Still CriativoÂ®..."}),e.jsx("p",{className:(n?"text-neutral-400":"text-gray-500")+" text-sm mb-6 text-center min-h-[20px] transition-all duration-300",children:He[ie]}),e.jsxs("div",{className:"w-full max-w-xs mb-4",children:[e.jsx("div",{className:"h-2 rounded-full overflow-hidden "+(n?"bg-neutral-800":"bg-gray-200"),children:e.jsx("div",{className:"h-full bg-gradient-to-r from-amber-500 to-[#FF9F43] rounded-full transition-all duration-500",style:{width:`${I}%`}})}),e.jsxs("p",{className:(n?"text-white":"text-[#1A1A1A]")+" text-sm font-medium text-center mt-2",children:[I,"%"]})]}),r.mainProduct&&e.jsx("div",{className:(n?"bg-neutral-900/80 border-neutral-800":"bg-gray-50 border-gray-200")+" rounded-xl p-4 border mb-6 w-full max-w-xs",children:e.jsxs("div",{className:"flex items-center gap-3",children:[(j=(c=r.mainProduct.originalImages)==null?void 0:c.front)!=null&&j.url||(T=(R=r.mainProduct.images)==null?void 0:R[0])!=null&&T.url?e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx(de,{src:((ce=(Z=r.mainProduct.originalImages)==null?void 0:Z.front)==null?void 0:ce.url)||((ge=(X=r.mainProduct.images)==null?void 0:X[0])==null?void 0:ge.url)||"",alt:r.mainProduct.name,className:"w-full h-full",size:"thumb"})}):e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0 "+(n?"bg-neutral-800":"bg-gray-200"),children:e.jsx("i",{className:"fas fa-image "+(n?"text-neutral-600":"text-gray-400")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(n?"text-white":"text-[#1A1A1A]")+" text-sm font-medium truncate",children:r.mainProduct.name}),e.jsxs("p",{className:(n?"text-neutral-500":"text-gray-500")+" text-xs",children:[Y," ",Y===1?"variaÃ§Ã£o":"variaÃ§Ãµes"," Â· ",J," ",J===1?"crÃ©dito":"crÃ©ditos"]})]})]})}),e.jsx("p",{className:(n?"text-neutral-600":"text-gray-400")+" text-xs text-center",children:"A geraÃ§Ã£o pode levar atÃ© 2 minutos"})]})]});if(Ce)return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 backdrop-blur-xl "+(n?"bg-black/80":"bg-white/80")}),e.jsx("div",{className:"relative z-10 flex flex-col items-center justify-center",children:e.jsx("div",{className:"w-72 h-72",children:e.jsx(We,{src:"https://lottie.host/c73f7881-d168-4dee-be3a-3c73bd916083/vnLD4LVey6.lottie",autoplay:!0,style:{width:"100%",height:"100%"}})})})]});if((u==null?void 0:u.status)==="failed")return e.jsx("div",{className:"flex-1 overflow-y-auto flex items-center justify-center p-4 "+(n?"":"bg-cream"),children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl flex items-center justify-center mb-6 "+(n?"bg-red-500/20":"bg-red-100"),children:e.jsx("i",{className:"fas fa-exclamation-triangle text-3xl "+(n?"text-red-400":"text-red-500")})}),e.jsx("h2",{className:(n?"text-white":"text-gray-900")+" text-xl font-bold font-serif mb-2",children:"Erro na geraÃ§Ã£o"}),e.jsx("p",{className:(n?"text-neutral-500":"text-gray-500")+" text-sm mb-6",children:u.error_message||"Ocorreu um erro ao gerar suas imagens. Tente novamente."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx("button",{onClick:B,className:(n?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700")+" px-4 py-2.5 rounded-xl text-sm font-medium transition-colors",children:"Voltar"}),e.jsxs("button",{onClick:A,className:"px-6 py-2.5 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-xl text-sm font-semibold",children:[e.jsx("i",{className:"fas fa-redo mr-2 text-xs"}),"Tentar novamente"]})]})]})});const K=Math.max(O.length,Y),je=Array.from({length:K},(h,p)=>({index:p,url:O[p]||null}));return e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 "+(n?"":"bg-cream"),style:{paddingTop:"max(1rem, env(safe-area-inset-top, 1rem))"},children:[e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:B,className:(n?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-900")+" p-2 -ml-2 rounded-lg transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:(n?"text-white":"text-[#1A1A1A]")+" text-lg font-extrabold",children:"Resultado"}),e.jsxs("p",{className:(n?"text-neutral-500":"text-gray-500")+" text-xs",children:[((ye=r.mainProduct)==null?void 0:ye.name)||"Vizzu Still Criativo"," Â· ",Y," ",Y===1?"variaÃ§Ã£o":"variaÃ§Ãµes"]})]})]})}),e.jsx("div",{className:`grid ${bt(K)} gap-4 mb-6`,children:je.map(({index:h,url:p})=>{const v=h+1,P=F===v;return e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>C(v),className:"w-full rounded-xl overflow-hidden border-2 transition-all "+(P?n?"border-amber-500 ring-2 ring-amber-500/30":"border-amber-400 ring-2 ring-amber-300":n?"border-neutral-800 hover:border-neutral-700":"border-gray-200 hover:border-gray-300"),children:e.jsx("div",{className:"aspect-[4/5] flex items-center justify-center "+(n?"bg-neutral-900":"bg-gray-100"),children:p?e.jsx(de,{src:p,alt:`VariaÃ§Ã£o ${v}`,className:"w-full h-full",size:"preview"}):e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-image text-4xl mb-2 "+(n?"text-neutral-700":"text-gray-300")}),e.jsxs("p",{className:(n?"text-neutral-600":"text-gray-400")+" text-sm",children:["VariaÃ§Ã£o ",v]}),e.jsx("p",{className:(n?"text-neutral-700":"text-gray-300")+" text-xs mt-1",children:"Preview disponÃ­vel apÃ³s integraÃ§Ã£o com n8n"})]})})}),e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full border-2 flex items-center justify-center "+(P?"border-amber-500 bg-amber-500":n?"border-neutral-700":"border-gray-300"),children:P&&e.jsx("i",{className:"fas fa-check text-[8px] text-white"})}),e.jsxs("span",{className:(n?"text-neutral-400":"text-gray-500")+" text-xs",children:["VariaÃ§Ã£o ",v]})]}),p&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>se(p,{alt:`VariaÃ§Ã£o ${v}`}),className:(n?"text-neutral-400 hover:text-neutral-300":"text-gray-500 hover:text-gray-600")+" text-xs font-medium",children:[e.jsx("i",{className:"fas fa-search-plus mr-1"}),"Zoom"]}),e.jsxs("button",{onClick:()=>ue(p,v),className:(n?"text-amber-400 hover:text-amber-300":"text-amber-600 hover:text-amber-500")+" text-xs font-medium",children:[e.jsx("i",{className:"fas fa-download mr-1"}),"Download"]}),e.jsxs("button",{onClick:()=>{Q(p),G(!0)},className:(n?"text-amber-400/70 hover:text-amber-400":"text-amber-500 hover:text-amber-600")+" text-xs font-medium",children:[e.jsx("i",{className:"fas fa-flag mr-1"}),"Report"]})]})]})]},h)})}),e.jsxs("div",{className:"rounded-xl p-4 flex flex-col md:flex-row items-stretch md:items-center gap-3 "+(n?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200 "),children:[e.jsxs("button",{onClick:A,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors "+(n?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-900 hover:bg-gray-200"),children:[e.jsx("i",{className:"fas fa-redo text-xs"}),"Gerar Novas VariaÃ§Ãµes"]}),e.jsxs("button",{onClick:()=>M(!0),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors "+(n?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-900 hover:bg-gray-200"),children:[e.jsx("i",{className:"fas fa-bookmark text-xs"}),"Salvar Template"]}),e.jsxs("button",{onClick:B,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-xl text-sm font-semibold",children:[e.jsx("i",{className:"fas fa-check text-xs"}),"Finalizar"]})]})]}),e.jsx(dt,{isOpen:oe,onClose:()=>{G(!1),Q(null)},onSubmit:a,generationType:"creative-still",productName:(f=r.mainProduct)==null?void 0:f.name,theme:x}),te&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",onClick:()=>M(!1),children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsx("div",{onClick:h=>h.stopPropagation(),className:"relative w-full max-w-sm mx-4 rounded-2xl overflow-hidden "+(n?"bg-neutral-900 border border-neutral-800":"bg-white "),children:e.jsxs("div",{className:"p-5",children:[e.jsx("div",{className:"w-12 h-12 mx-auto rounded-xl flex items-center justify-center mb-4 "+(n?"bg-amber-500/20":"bg-amber-100"),children:e.jsx("i",{className:"fas fa-bookmark text-xl "+(n?"text-amber-400":"text-amber-500")})}),e.jsx("h3",{className:(n?"text-white":"text-gray-900")+" text-base font-semibold font-serif text-center mb-1",children:"Salvar como Template"}),e.jsx("p",{className:(n?"text-neutral-500":"text-gray-500")+" text-xs text-center mb-4",children:"Este template poderÃ¡ ser usado para criar stills com outros produtos mantendo o mesmo estilo."}),e.jsx("input",{value:q,onChange:h=>V(h.target.value),placeholder:"Nome do template...",className:"w-full rounded-lg px-3 py-2.5 text-sm mb-4 "+(n?"bg-neutral-800 border border-neutral-700 text-white placeholder-neutral-600":"bg-gray-50 border border-gray-200 text-gray-900 placeholder-gray-400"),autoFocus:!0}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>M(!1),className:"flex-1 px-4 py-2.5 rounded-xl text-sm font-medium transition-colors "+(n?"bg-neutral-800 text-neutral-400 hover:text-white":"bg-gray-100 text-gray-500 hover:text-gray-700"),children:"Cancelar"}),e.jsx("button",{onClick:m,disabled:!q.trim()||s,className:"flex-1 px-4 py-2.5 bg-gradient-to-r from-amber-500 to-[#FF9F43] text-white rounded-xl text-sm font-semibold disabled:opacity-50 disabled:cursor-not-allowed",children:s?e.jsx("i",{className:"fas fa-spinner fa-spin"}):"Salvar"})]})]})})]})]})},Ue=[{id:"close-up",label:"Close-up",description:"Bem prÃ³ximo, destaque nos detalhes",icon:"fa-magnifying-glass-plus"},{id:"medium",label:"MÃ©dio",description:"Enquadramento intermediÃ¡rio",icon:"fa-expand"},{id:"full",label:"Completo",description:"Produto inteiro visÃ­vel com contexto",icon:"fa-up-right-and-down-left-from-center"},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir",icon:"fa-wand-magic-sparkles"}],Qe=[{id:"verao_tropical",label:"VerÃ£o Tropical",icon:"fa-sun"},{id:"alto_verao_resort",label:"Alto VerÃ£o Resort",icon:"fa-umbrella-beach"},{id:"primavera_floral",label:"Primavera Floral",icon:"fa-seedling"},{id:"inverno_urbano",label:"Inverno Urbano",icon:"fa-snowflake"},{id:"outono_rustico",label:"Outono RÃºstico",icon:"fa-leaf"},{id:"colecao_festa",label:"ColeÃ§Ã£o Festa",icon:"fa-champagne-glasses"},{id:"basics_atemporal",label:"Basics Atemporal",icon:"fa-circle"},{id:"ai_choose",label:"IA Escolhe",icon:"fa-wand-magic-sparkles"},{id:"custom",label:"Personalizado",icon:"fa-pen"}],Ye=[{id:"clean_natural",label:"Clean Natural",description:"Cores fiÃ©is, sem grÃ£o, neutro. Ideal para catÃ¡logo.",icon:"fa-droplet"},{id:"warm_soft",label:"Warm & Soft",description:"Tons dourados, leve desaturaÃ§Ã£o, grÃ£o sutil.",icon:"fa-sun"},{id:"cool_crisp",label:"Cool & Crisp",description:"Tons azulados, alto contraste, sem grÃ£o.",icon:"fa-snowflake"},{id:"film_analog",label:"Filme AnalÃ³gico",description:"Tons quentes, contraste suave, grÃ£o de pelÃ­cula.",icon:"fa-film"},{id:"vintage_faded",label:"Vintage Faded",description:"Baixo contraste, pretos lavados, grÃ£o moderado.",icon:"fa-clock-rotate-left"},{id:"moody_dark",label:"Moody / Dark",description:"Sombras profundas, tons escuros, grÃ£o sutil.",icon:"fa-moon"},{id:"vibrant_pop",label:"Vibrante Pop",description:"SaturaÃ§Ã£o alta, cores vivas, sem grÃ£o.",icon:"fa-palette"},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir o melhor estilo.",icon:"fa-wand-magic-sparkles"},{id:"custom",label:"Personalizado",description:"Descreva o estilo visual desejado.",icon:"fa-pen"}],ft=[{id:"2k",label:"2K",description:"ResoluÃ§Ã£o padrÃ£o"},{id:"4k",label:"4K",description:"Alta resoluÃ§Ã£o"}],Ke=[{id:"natural_soft",label:"Natural Suave",description:"Luz do dia suave, sombras gentis",icon:"fa-cloud-sun"},{id:"golden_hour",label:"Golden Hour",description:"Tons quentes de pÃ´r do sol",icon:"fa-sun"},{id:"leaf_shadows",label:"Sombras de Folha",description:"Luz filtrada por folhas",icon:"fa-leaf"},{id:"studio_soft",label:"EstÃºdio Soft",description:"IluminaÃ§Ã£o profissional softbox",icon:"fa-lightbulb"},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir",icon:"fa-wand-magic-sparkles"}],Ze=[{id:"canon_24mm_f14",label:"Canon EF 24mm f/1.4L II",category:"wide",description:"Wide dramÃ¡tico"},{id:"sony_24mm_gm",label:"Sony 24mm f/1.4 GM",category:"wide",description:"Sharp, moderno"},{id:"sigma_35mm_art",label:"Sigma 35mm f/1.4 Art",category:"standard",description:"Nitidez extrema"},{id:"leica_35mm",label:"Leica Summilux 35mm f/1.4",category:"standard",description:"Look analÃ³gico"},{id:"canon_50mm_f12",label:"Canon EF 50mm f/1.2L",category:"standard",description:"Bokeh cremoso"},{id:"zeiss_50mm",label:"Zeiss Planar 50mm f/1.4",category:"standard",description:"Vintage, suave"},{id:"sony_85mm_gm",label:"Sony 85mm f/1.4 GM",category:"portrait",description:"Rei do portrait"},{id:"canon_85mm_f12",label:"Canon EF 85mm f/1.2L",category:"portrait",description:"Bokeh suave"},{id:"canon_100mm_macro",label:"Canon 100mm f/2.8L Macro",category:"macro",description:"Detalhes extremos"},{id:"sony_90mm_macro",label:"Sony 90mm f/2.8 Macro G",category:"macro",description:"Textura perfeita"},{id:"ai_choose",label:"IA Escolhe",category:"ai",description:"Melhor lente para a composiÃ§Ã£o"}],Xe=[{id:"top_down",label:"Top-Down (90Â°)",description:"Diretamente de cima",icon:"fa-arrow-down"},{id:"45deg",label:"45Â°",description:"Vista angular",icon:"fa-arrows-turn-right"},{id:"eye_level",label:"Eye-Level",description:"Frontal",icon:"fa-arrows-left-right"},{id:"low_angle",label:"Low Angle",description:"De baixo",icon:"fa-arrow-up"},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir",icon:"fa-wand-magic-sparkles"}],pt={Camisetas:"clothing",Blusas:"clothing",Regatas:"clothing",Tops:"clothing",Camisas:"clothing",Bodies:"clothing",Jaquetas:"clothing",Casacos:"clothing",Blazers:"clothing",Moletons:"clothing",CalÃ§as:"clothing",Shorts:"clothing",Bermudas:"clothing",Saias:"clothing",Leggings:"clothing","Shorts Fitness":"clothing",Vestidos:"fullpiece",MacacÃµes:"fullpiece",Jardineiras:"fullpiece",BiquÃ­nis:"clothing",MaiÃ´s:"clothing",CalÃ§ados:"footwear",TÃªnis:"footwear",SandÃ¡lias:"footwear",Botas:"footwear",BonÃ©s:"headwear",ChapÃ©us:"headwear",Tiaras:"headwear",LenÃ§os:"clothing",Bolsas:"bags",Cintos:"accessories",RelÃ³gios:"accessories",Ã“culos:"accessories",Bijuterias:"accessories",AcessÃ³rios:"accessories","Outros AcessÃ³rios":"accessories"},vt=[{id:"clothing",label:"Roupa",description:"Camiseta, calÃ§a, vestido, etc.",icon:"fa-shirt"},{id:"footwear",label:"CalÃ§ado",description:"TÃªnis, bota, sandÃ¡lia, etc.",icon:"fa-shoe-prints"},{id:"bags",label:"Bolsa",description:"Bolsa, mochila, clutch, etc.",icon:"fa-bag-shopping"},{id:"headwear",label:"ChapÃ©u / BonÃ©",description:"ChapÃ©u, bonÃ©, tiara, etc.",icon:"fa-hat-cowboy"},{id:"accessories",label:"AcessÃ³rio",description:"Ã“culos, relÃ³gio, cinto, etc.",icon:"fa-gem"}],Ae=[{id:"open",label:"Aberto / Estendido",description:"PeÃ§a aberta e esticada",icon:"fa-expand",types:["clothing","fullpiece"]},{id:"folded",label:"Dobrado",description:"Dobrado com cuidado",icon:"fa-shirt",types:["clothing"]},{id:"hanging",label:"Pendurado",description:"Pendurado em cabide ou gancho",icon:"fa-grip-lines",types:["clothing","fullpiece"]},{id:"rolled",label:"Enrolado",description:"Enrolado de forma estilosa",icon:"fa-toilet-paper",types:["clothing"]},{id:"natural",label:"Jogado Natural",description:"Solto de forma casual e natural",icon:"fa-wind",types:["clothing","fullpiece"]},{id:"standing",label:"Em PÃ©",description:"Posicionado em pÃ©, ereto",icon:"fa-shoe-prints",types:["footwear"]},{id:"side_view",label:"Vista Lateral",description:"Lateral mostrando o perfil",icon:"fa-arrows-left-right",types:["footwear"]},{id:"pair",label:"Par Cruzado",description:"Par sobreposto em composiÃ§Ã£o",icon:"fa-xmarks-lines",types:["footwear"]},{id:"flat_lay",label:"Flat Lay",description:"Deitado visto de cima",icon:"fa-arrow-down",types:["footwear","bags","headwear","accessories"]},{id:"upright",label:"Em PÃ© / Ereto",description:"Posicionado verticalmente",icon:"fa-arrow-up",types:["bags"]},{id:"open_bag",label:"Aberta",description:"Bolsa aberta mostrando interior",icon:"fa-box-open",types:["bags"]},{id:"worn_style",label:"Estilo Vestido",description:"Posicionado como se estivesse sendo usado",icon:"fa-user",types:["headwear","accessories"]},{id:"display",label:"Em Display",description:"Em suporte ou expositor",icon:"fa-display",types:["accessories","headwear"]},{id:"custom",label:"Personalizado",description:"Descreva como quer exibir",icon:"fa-pen",types:["clothing","fullpiece","footwear","bags","headwear","accessories"]},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir",icon:"fa-wand-magic-sparkles",types:["clothing","fullpiece","footwear","bags","headwear","accessories"]}],ze=x=>x?Ae.filter(u=>u.types.includes(x)):Ae.filter(u=>u.id==="ai_choose"),jt=x=>x&&pt[x]||null,Ct=Ae,Pt=[{id:"center",label:"Centralizado",description:"Centro da composiÃ§Ã£o",icon:"fa-crosshairs"},{id:"left_third",label:"TerÃ§o Esquerdo",description:"Regra dos terÃ§os, Ã  esquerda",icon:"fa-align-left"},{id:"right_third",label:"TerÃ§o Direito",description:"Regra dos terÃ§os, Ã  direita",icon:"fa-align-right"},{id:"slight_left",label:"Levemente Esquerda",description:"Deslocado sutil para esquerda",icon:"fa-arrow-left"},{id:"slight_right",label:"Levemente Direita",description:"Deslocado sutil para direita",icon:"fa-arrow-right"},{id:"ai_choose",label:"IA Escolhe",description:"Deixar a IA decidir",icon:"fa-wand-magic-sparkles"}],et=[{id:"1:1",label:"1:1",description:"Feed quadrado",icon:"fa-square"},{id:"4:5",label:"4:5",description:"Feed vertical",icon:"fa-rectangle-portrait"},{id:"9:16",label:"9:16",description:"Stories/Reels",icon:"fa-mobile-screen"},{id:"16:9",label:"16:9",description:"Banner",icon:"fa-rectangle-wide"}],Ie={mainProduct:null,mainProductView:"front",mainProductHighlight:"front",productPresentation:"ai_choose",customPresentationText:"",productScale:"ai_choose",additionalProducts:[],surfaceDescription:"",surfaceReference:null,environmentDescription:"",environmentReference:null,compositionElements:[],compositionReference:null,moodSeason:"ai_choose",customMoodSeason:"",lighting:"ai_choose",customLighting:"",lightingReference:null,lensModel:"ai_choose",cameraAngle:"ai_choose",depthOfField:50,visualStyle:"ai_choose",customVisualStyle:"",visualStyleReference:null,frameRatio:"4:5",resolution:"2k",variationsCount:2,saveAsTemplate:!1,templateName:""},kt=({theme:x,products:u,userCredits:r,userId:l,onDeductCredits:I,onAddHistoryLog:ve,onCheckCredits:B,currentPlan:A,onBack:w,onOpenPlanModal:me,initialProduct:ee,onClearInitialProduct:se,onSetGenerating:F,onSetProgress:C,onSetMinimized:te,isMinimized:M})=>{const[q,V]=d.useState("home"),[s,S]=d.useState({...Ie}),[Ce,le]=d.useState([]),[ae,re]=d.useState([]),[oe,G]=d.useState([]),[xe,Q]=d.useState(!1),[$,W]=d.useState(null),[n,O]=d.useState(!1),[Y,J]=d.useState(0),[ie,ne]=d.useState(""),m=x==="dark";d.useEffect(()=>{ee&&(S(c=>({...c,mainProduct:ee})),V("wizard"),se==null||se())},[ee,se]);const a=d.useCallback(async()=>{if(l){Q(!0);try{const{data:c}=await pe.from("creative_still_templates").select("*").eq("user_id",l).order("created_at",{ascending:!1});c&&le(c);const{data:j}=await pe.from("creative_still_generations").select("*").eq("user_id",l).neq("status","failed").order("created_at",{ascending:!1}).limit(20);j&&(re(j),G(j.filter(R=>R.is_favorite)))}catch(c){console.error("Erro ao carregar dados do Vizzu Still Criativo:",c)}finally{Q(!1)}}},[l]);d.useEffect(()=>{a()},[a]);const ue=()=>{S({...Ie}),V("wizard")},K=async()=>{if(!s.mainProduct)return;const c=s.variationsCount;if(B&&!B(c,"creative-still"))return;O(!0),F==null||F(!0),J(10),C==null||C(10),ne(""),V("results");const{data:j,error:R}=await pe.from("creative_still_generations").insert({user_id:l,product_id:s.mainProduct.id||"",additional_products:s.additionalProducts.map(f=>({product_id:f.product_id,product_name:f.product_name,product_image_url:f.product_image_url,position_description:f.position_description,source:f.source})),settings_snapshot:{mainProductView:s.mainProductView,mainProductHighlight:s.mainProductHighlight,productPresentation:s.productPresentation,customPresentationText:s.customPresentationText,productScale:s.productScale,surfaceDescription:s.surfaceDescription,surfaceReference:s.surfaceReference?"attached":null,environmentDescription:s.environmentDescription,environmentReference:s.environmentReference?"attached":null,compositionElements:s.compositionElements.map(f=>({description:f.description,hasImage:!!f.image})),compositionReference:s.compositionReference?"attached":null,moodSeason:s.moodSeason,customMoodSeason:s.customMoodSeason,lighting:s.lighting,customLighting:s.customLighting,lightingReference:s.lightingReference?"attached":null,lensModel:s.lensModel,cameraAngle:s.cameraAngle,depthOfField:s.depthOfField,visualStyle:s.visualStyle,customVisualStyle:s.customVisualStyle,visualStyleReference:s.visualStyleReference?"attached":null,frameRatio:s.frameRatio,resolution:s.resolution,variationsCount:s.variationsCount,product_image_url:(()=>{var p,v,P,N,y,k,_,H,Pe;const f=s.mainProduct,h=s.mainProductView==="both"?"front":s.mainProductView;if((v=(p=f.generatedImages)==null?void 0:p.productStudio)!=null&&v.length){const Ne=(P=f.generatedImages.productStudio[f.generatedImages.productStudio.length-1].images)==null?void 0:P.find(Te=>Te.angle===h);if(Ne!=null&&Ne.url)return Ne.url}return h==="back"&&((y=(N=f.originalImages)==null?void 0:N.back)!=null&&y.url)?f.originalImages.back.url:(_=(k=f.originalImages)==null?void 0:k.front)!=null&&_.url?f.originalImages.front.url:(Pe=(H=f.images)==null?void 0:H[0])!=null&&Pe.url?f.images[0].url:""})(),product_detail_image_url:(()=>{var h,p,v,P,N;const f=s.mainProduct;if((p=(h=f.generatedImages)==null?void 0:h.productStudio)!=null&&p.length){const k=(v=f.generatedImages.productStudio[f.generatedImages.productStudio.length-1].images)==null?void 0:v.find(_=>_.angle==="detail");if(k!=null&&k.url)return k.url}return(N=(P=f.originalImages)==null?void 0:P.detail)!=null&&N.url?f.originalImages.detail.url:null})(),product_name:s.mainProduct.name,product_category:s.mainProduct.category||"",product_color:s.mainProduct.color||""},variations_requested:s.variationsCount,resolution:s.resolution,variation_urls:[],variation_1_url:null,variation_2_url:null,credits_used:c,status:"pending"}).select().single();if(R||!j){console.error("Erro ao criar geraÃ§Ã£o:",R),O(!1),F==null||F(!1),W({id:crypto.randomUUID(),user_id:l||"",template_id:null,product_id:s.mainProduct.id||"",additional_products:[],settings_snapshot:{},variation_urls:[],variation_1_url:null,variation_2_url:null,variations_requested:s.variationsCount,selected_variation:null,reference_image_url:null,resolution:s.resolution,credits_used:0,status:"failed",error_message:"Erro ao iniciar geraÃ§Ã£o. Tente novamente.",created_at:new Date().toISOString(),completed_at:null});return}const T=j.id;let Z=10;const ce=setInterval(()=>{const f=90-Z,h=Math.max(f*.08,.5);Z=Math.min(Z+h,90),J(Math.round(Z)),C==null||C(Math.round(Z))},1e3),X=3e3,ge=3e5,ye=Date.now();try{const f=await new Promise((h,p)=>{let v=!1;const P=async()=>{if(Date.now()-ye>ge){p(new Error("Tempo limite excedido"));return}try{const{data:N,error:y}=await pe.from("creative_still_generations").select("*").eq("id",T).single();if(y){p(y);return}N.status==="completed"||N.status==="failed"?h(N):v?p(new Error("Falha na comunicaÃ§Ã£o com o servidor de geraÃ§Ã£o.")):setTimeout(P,X)}catch(N){p(N)}};fetch("https://n8nwebhook.brainia.store/webhook/vizzu/still/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({generation_id:T,user_id:l})}).then(N=>{N.ok||(console.error("Webhook retornou erro:",N.status),v=!0)}).catch(N=>{console.error("Erro ao chamar webhook n8n:",N),v=!0}),setTimeout(P,2e3)});clearInterval(ce),J(95),C==null||C(95),await new Promise(h=>setTimeout(h,500)),J(100),C==null||C(100),W(f);try{const h=`vizzu_bg_notified_${l}`,p=JSON.parse(localStorage.getItem(h)||"[]");p.push(`still-${T}`),localStorage.setItem(h,JSON.stringify(p.slice(-200)))}catch{}a()}catch{clearInterval(ce),await pe.from("creative_still_generations").update({status:"failed",error_message:"Erro ao gerar imagem."}).eq("id",T);const{data:h}=await pe.from("creative_still_generations").select("*").eq("id",T).single();W(h||{id:T,user_id:l||"",template_id:null,product_id:s.mainProduct.id||"",additional_products:[],settings_snapshot:{},variation_urls:[],variation_1_url:null,variation_2_url:null,variations_requested:s.variationsCount,selected_variation:null,reference_image_url:null,resolution:s.resolution,credits_used:0,status:"failed",error_message:"Erro ao gerar imagem. Tente novamente.",created_at:new Date().toISOString(),completed_at:null})}finally{O(!1),F==null||F(!1)}},je=()=>{V("home"),W(null),S({...Ie}),a()};return q==="home"?e.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 "+(m?"":"bg-cream"),style:{paddingTop:"max(1rem, env(safe-area-inset-top, 1rem))"},children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[w&&e.jsx("button",{onClick:w,className:"w-10 h-10 rounded-xl flex items-center justify-center transition-all "+(m?"bg-white/10 backdrop-blur-xl border border-white/20 text-neutral-300 hover:text-white hover:bg-white/15 shadow-lg":"bg-white/60 backdrop-blur-xl border border-gray-200/60 text-gray-500 hover:text-gray-700 hover:bg-white/80 shadow-sm"),children:e.jsx("i",{className:"fas fa-arrow-left text-sm"})}),e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center backdrop-blur-xl "+(m?"bg-white/10 border border-white/15":"bg-white/60 border border-gray-200/60 shadow-sm"),children:e.jsx("i",{className:"fas fa-palette text-sm "+(m?"text-neutral-200":"text-[#1A1A1A]")})}),e.jsxs("div",{children:[e.jsx("h1",{className:(m?"text-white":"text-[#1A1A1A]")+" text-lg font-extrabold",children:"Vizzu Still CriativoÂ®"}),e.jsx("p",{className:(m?"text-neutral-500":"text-gray-500")+" text-xs font-serif italic",children:"ComposiÃ§Ãµes artÃ­sticas para Instagram e e-commerce"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium "+(m?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-amber-50 text-amber-600 border border-amber-200"),children:[e.jsx("i",{className:"fas fa-coins text-[10px]"}),e.jsx("span",{children:"1 crÃ©dito/variaÃ§Ã£o"})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("button",{onClick:()=>ue(),className:"group relative overflow-hidden rounded-xl p-5 text-left transition-all hover:scale-[1.02] w-full "+(m?"bg-neutral-900 border border-neutral-800 hover:border-amber-500/50":"bg-white border-2 border-gray-200 hover:border-amber-400 "),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 "+(m?"bg-gradient-to-r from-amber-500/20 to-[#FF9F43]/15":"bg-gradient-to-r from-amber-100 to-[#FF9F43]/10"),children:e.jsx("i",{className:"fas fa-wand-magic-sparkles text-lg "+(m?"text-amber-400":"text-amber-500")})}),e.jsxs("div",{children:[e.jsx("h3",{className:(m?"text-white":"text-gray-900")+" font-semibold text-sm mb-1",children:"Novo Still"}),e.jsx("p",{className:(m?"text-neutral-500":"text-gray-500")+" text-xs leading-relaxed",children:"4 passos: Produto, CenÃ¡rio, EstÃ©tica e Frame. Controle total sobre cada detalhe."})]})]})})}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:(m?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-images mr-2 text-xs opacity-50"}),"Stills Gerados"]}),xe?e.jsx("div",{className:"rounded-xl p-8 text-center "+(m?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200"),children:e.jsx("i",{className:"fas fa-spinner fa-spin text-lg text-neutral-500"})}):ae.length===0?e.jsxs("div",{className:"rounded-xl p-8 text-center "+(m?"bg-neutral-900/50 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsx("div",{className:"w-14 h-14 mx-auto rounded-xl flex items-center justify-center mb-3 "+(m?"bg-neutral-800":"bg-gray-200"),children:e.jsx("i",{className:"fas fa-images text-xl "+(m?"text-neutral-600":"text-gray-400")})}),e.jsx("p",{className:(m?"text-neutral-500":"text-gray-500")+" text-sm",children:"VocÃª ainda nÃ£o gerou nenhum still."}),e.jsx("p",{className:(m?"text-neutral-600":"text-gray-400")+" text-xs mt-1",children:"Crie seu primeiro still criativo e ele aparecerÃ¡ aqui!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:ae.map(c=>e.jsxs("div",{className:"group rounded-xl overflow-hidden text-left transition-all hover:scale-[1.02] "+(m?"bg-neutral-900 border border-neutral-800 hover:border-amber-500/50":"bg-white border border-gray-200 hover:border-amber-400 "),children:[e.jsx("div",{className:"aspect-square flex items-center justify-center "+(m?"bg-neutral-800":"bg-gray-100"),children:(()=>{var T;const j=(T=c.variation_urls)!=null&&T.length?c.variation_urls:[c.variation_1_url,c.variation_2_url].filter(Boolean),R=c.selected_variation!=null&&j[c.selected_variation-1]?j[c.selected_variation-1]:j[0]||null;return R?e.jsx(de,{src:R,alt:"",className:"w-full h-full",size:"thumb"}):e.jsx("i",{className:"fas fa-image text-2xl "+(m?"text-neutral-700":"text-gray-300")})})()}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:(m?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:c.status==="completed"?"Still gerado":c.status==="processing"?"Gerando...":"Falhou"}),e.jsx("p",{className:(m?"text-neutral-600":"text-gray-400")+" text-[10px] mt-0.5",children:new Date(c.created_at).toLocaleDateString("pt-BR")})]})]},c.id))})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:(m?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-heart mr-2 text-xs opacity-50"}),"Meus Stills Favoritos"]}),oe.length===0?e.jsxs("div",{className:"rounded-xl p-8 text-center "+(m?"bg-neutral-900/50 border border-neutral-800":"bg-gray-50 border border-gray-200"),children:[e.jsx("div",{className:"w-14 h-14 mx-auto rounded-xl flex items-center justify-center mb-3 "+(m?"bg-neutral-800":"bg-gray-200"),children:e.jsx("i",{className:"fas fa-heart text-xl "+(m?"text-neutral-600":"text-gray-400")})}),e.jsx("p",{className:(m?"text-neutral-500":"text-gray-500")+" text-sm",children:"Nenhum favorito ainda."}),e.jsx("p",{className:(m?"text-neutral-600":"text-gray-400")+" text-xs mt-1",children:"Favorite seus melhores stills para acessÃ¡-los rapidamente!"})]}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:oe.map(c=>e.jsxs("div",{className:"group rounded-xl overflow-hidden text-left transition-all hover:scale-[1.02] "+(m?"bg-neutral-900 border border-neutral-800 hover:border-[#FF6B6B]/50":"bg-white border border-gray-200 hover:border-[#FF6B6B]/50 "),children:[e.jsxs("div",{className:"aspect-square flex items-center justify-center relative "+(m?"bg-neutral-800":"bg-gray-100"),children:[(()=>{var T;const j=(T=c.variation_urls)!=null&&T.length?c.variation_urls:[c.variation_1_url,c.variation_2_url].filter(Boolean),R=c.selected_variation!=null&&j[c.selected_variation-1]?j[c.selected_variation-1]:j[0]||null;return R?e.jsx(de,{src:R,alt:"",className:"w-full h-full",size:"thumb"}):e.jsx("i",{className:"fas fa-image text-2xl "+(m?"text-neutral-700":"text-gray-300")})})(),e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("i",{className:"fas fa-heart text-[#FF6B6B] text-sm drop-"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("p",{className:(m?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:"Still favorito"}),e.jsx("p",{className:(m?"text-neutral-600":"text-gray-400")+" text-[10px] mt-0.5",children:new Date(c.created_at).toLocaleDateString("pt-BR")})]})]},c.id))})]})]})}):q==="wizard"?e.jsx(xt,{theme:x,products:u,wizardState:s,onUpdateState:c=>S(j=>({...j,...c})),onGenerate:K,onBack:()=>V("home"),userCredits:r}):e.jsx(ht,{theme:x,generation:$,wizardState:s,isGenerating:n,progress:Y,loadingText:ie,onBackToHome:je,onGenerateAgain:K,onMinimize:()=>te==null?void 0:te(!0),isMinimized:M,onSaveTemplate:async c=>{if(!l)return;const{error:j}=await pe.from("creative_still_templates").insert({user_id:l,name:c,surface_description:s.surfaceDescription,environment_description:s.environmentDescription||null,elements_description:s.compositionElements.map(R=>R.description).join("; ")||null,elements_images:[],mood_season:s.moodSeason||null,product_presentation:s.productPresentation||null,product_scale:s.productScale||null,lighting:s.lighting,lens_model:s.lensModel,camera_angle:s.cameraAngle,depth_of_field:s.depthOfField,visual_style:s.visualStyle,frame_ratio:s.frameRatio,resolution:s.resolution,default_variations:s.variationsCount});j?console.error("Erro ao salvar template:",j):a()}})};export{Ae as ALL_PRESENTATIONS,Xe as CAMERA_ANGLES,pt as CATEGORY_TO_TYPE,kt as CreativeStill,et as FRAME_RATIOS,Ze as LENS_OPTIONS,Ke as LIGHTING_OPTIONS,Qe as MOOD_SEASONS,Pt as PRODUCT_PLACEMENTS,Ct as PRODUCT_PRESENTATIONS,Ue as PRODUCT_SCALES,vt as PRODUCT_TYPES_FOR_UPLOAD,ft as RESOLUTIONS,Ye as VISUAL_STYLES,ze as getPresentationsForType,jt as getProductTypeGroup};
