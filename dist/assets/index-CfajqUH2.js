import{u as fs,a as hs,j as e,E as bs,O as Q,Z as ps,s as Aa,b as js,c as ys,d as Ns,e as Lt,R as vs,g as $a}from"./index-BQSr_3cM.js";import{r as m,R as ws}from"./vendor-react-KfUPlHYY.js";import{L as ks}from"./LookComposer-CzC2TUXi.js";import{R as Fs}from"./ReportModal-DIEB58x6.js";import{g as Bs,R as Cs,a as Is,s as Ea,h as Ss}from"./Resolution4KConfirmModal-BpTR6s-c.js";import"./vendor-supabase-D20mg4W1.js";const $s={head:"Cabeça",top:"Parte de Cima",bottom:"Parte de Baixo",feet:"Calçados",accessory1:"Acessório 1",accessory2:"Acessório 2"},Es={head:"fa-hat-wizard",top:"fa-shirt",bottom:"fa-person",feet:"fa-shoe-prints",accessory1:"fa-gem",accessory2:"fa-ring"},Ps=({product:n,generatedImageUrl:Y,generatedBackImageUrl:me,generationId:it,lookMode:Ue,lookComposition:Me,describedLook:Z,selectedModel:je,backgroundType:$,creditsUsed:z,userCredits:Ee,onSave:kt,onRegenerate:We,onDelete:Pe,onBack:ot,onNewLook:ct,theme:dt="dark"})=>{var be;const[Oe,ye]=m.useState(!1),[De,ne]=m.useState(!1),[Qe,ge]=m.useState(!1),[Re,ie]=m.useState(!1),[E,Ne]=m.useState(!1),[l,ve]=m.useState(null),[te,xt]=m.useState("agora"),[H,b]=m.useState("high"),[I,oe]=m.useState(!1),[G,we]=m.useState(!0),[D,ae]=m.useState(!1),{user:ue}=fs(),{showToast:S}=hs();m.useEffect(()=>{const y=setTimeout(()=>we(!1),2500);return()=>clearTimeout(y)},[]);const[O,p]=m.useState("front"),R=!!me,_=R?2:1,[ce,T]=m.useState(!1),[ke,V]=m.useState({x:0,y:0}),de=m.useRef(null),i=dt==="dark";m.useEffect(()=>{(()=>{xt("agora")})();const A=setInterval(()=>{},6e4);return()=>clearInterval(A)},[]);const fe=y=>{var A,se,Ge,Ve,qe,a,x,o,c,f,j;if((se=(A=n.generatedImages)==null?void 0:A.productStudio)!=null&&se.length){const k=n.generatedImages.productStudio[n.generatedImages.productStudio.length-1];if((Ge=k.images)!=null&&Ge.length){const L=k.images.find(W=>W.angle===y);if(L!=null&&L.url)return L.url}}if(y==="front"){if((qe=(Ve=n.originalImages)==null?void 0:Ve.front)!=null&&qe.url)return n.originalImages.front.url;if((x=(a=n.images)==null?void 0:a[0])!=null&&x.url)return n.images[0].url;if((c=(o=n.images)==null?void 0:o[0])!=null&&c.base64)return n.images[0].base64}else if((j=(f=n.originalImages)==null?void 0:f.back)!=null&&j.url)return n.originalImages.back.url;return""},M=fe("front"),ze=fe("back"),K=()=>O==="back"&&me?me:Y,C=E?O==="back"&&ze?ze:M:K(),Te=y=>{if(!de.current)return;const A=de.current.getBoundingClientRect(),se=(y.clientX-A.left)/A.width*100,Ge=(y.clientY-A.top)/A.height*100;V({x:se,y:Ge})},re=()=>{ye(!0),kt()},X=async()=>{const y=K();if(!y)return;const A=R?`-${O}`:"";await Aa(y,{filename:`${n.sku}-look-composer${A}.png`,shareTitle:"Vizzu Look Composer",shareText:`${n.name} - ${O==="front"?"Frente":"Costas"}`})},Fe=async()=>{const y=[];Y&&y.push({source:Y,filename:`${n.sku}-look-composer-frente.png`}),me&&y.push({source:me,filename:`${n.sku}-look-composer-costas.png`}),y.length>0&&await js(y,"Vizzu Look Composer")},Ze=async y=>{if(!ue)return;const A=K();if(!A)return;const se=await ys({userId:ue.id,userEmail:ue.email||"",userName:ue.name||ue.email||"",generationType:"look-composer",generationId:it,productName:n.name,generatedImageUrl:A,originalImageUrl:M||void 0,observation:y});if(se.success)S("Report enviado! Analisaremos em até 24h.","success");else throw new Error(se.error||"Erro ao enviar report")},Nt=()=>{Oe?ot():(ve("back"),ne(!0))},he=y=>{y&&re(),ne(!1),l==="back"&&ot(),ve(null)},w=()=>{ge(!1),Pe()},_e=Me?Object.entries(Me):[];return G?e.jsx("div",{className:"min-h-screen flex items-center justify-center "+(i?"bg-black":"bg-gray-50"),children:e.jsx("div",{className:"w-72 h-72",children:e.jsx(bs,{src:"https://lottie.host/c73f7881-d168-4dee-be3a-3c73bd916083/vnLD4LVey6.lottie",autoplay:!0,style:{width:"100%",height:"100%"}})})}):e.jsxs("div",{className:"min-h-screen flex flex-col overflow-y-auto "+(i?"bg-black":"bg-gray-50"),children:[e.jsx("div",{className:"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] px-4 py-3 sticky top-0 z-40 flex-shrink-0",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Nt,className:"w-9 h-9 rounded-xl bg-white/20 backdrop-blur-sm text-white flex items-center justify-center hover:bg-white/30 transition-all",children:e.jsx("i",{className:"fas fa-arrow-left text-sm"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-white text-sm font-semibold",children:"Look Criado!"}),e.jsx("p",{className:"text-white/70 text-xs truncate max-w-[150px] md:max-w-none",children:n.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white/20 backdrop-blur-sm rounded-lg",children:[e.jsxs("span",{className:"text-white/80 text-[10px]",children:["-",z]}),e.jsx("i",{className:"fas fa-ticket text-white/80 text-[8px]"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-white/20 backdrop-blur-sm rounded-lg",children:[e.jsx("span",{className:"text-white font-semibold text-[10px]",children:Ee}),e.jsx("i",{className:"fas fa-coins text-yellow-300 text-[8px]"})]})]})]})}),e.jsx("div",{className:"flex-1 max-w-7xl mx-auto w-full p-4 md:p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-4 md:gap-6",children:[e.jsx("div",{className:"lg:col-span-3 flex flex-col",children:e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-2xl border overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-b "+(i?"border-neutral-800":"border-gray-100"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:(i?"text-neutral-400":"text-gray-500")+" text-[10px] uppercase tracking-wide",children:E?"Produto Original":"Look Gerado"}),R&&e.jsxs("div",{className:"flex items-center gap-1 p-0.5 rounded-lg "+(i?"bg-neutral-800":"bg-gray-100"),children:[e.jsxs("button",{onClick:()=>p("front"),className:"px-2.5 py-1 rounded-md text-[10px] font-medium transition-all "+(O==="front"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":i?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"Frente"]}),e.jsxs("button",{onClick:()=>p("back"),className:"px-2.5 py-1 rounded-md text-[10px] font-medium transition-all "+(O==="back"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":i?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"Costas"]})]})]}),e.jsxs("button",{onClick:()=>Ne(!E),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all "+(i?"bg-neutral-800 text-neutral-300 hover:bg-neutral-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[e.jsx("i",{className:"fas "+(E?"fa-wand-magic-sparkles":"fa-image")}),e.jsx("span",{children:E?"Ver Look":"Ver Original"})]})]}),e.jsx("div",{ref:de,className:"relative flex items-center justify-center p-4 md:p-6 min-h-[280px] md:min-h-[450px] cursor-zoom-in overflow-hidden "+(i?"bg-neutral-800/50":"bg-gray-100"),onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),onMouseMove:Te,onClick:()=>ie(!0),children:C?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:C,alt:`${n.name} - ${E?"original":"look"}`,className:"max-w-full max-h-[260px] md:max-h-[420px] object-contain rounded-lg transition-opacity duration-200 "+(ce?"opacity-0 lg:opacity-0":"opacity-100"),style:{display:ce?"none":"block"}}),ce&&e.jsx("div",{className:"hidden lg:block absolute inset-0 bg-no-repeat",style:{backgroundImage:`url(${C})`,backgroundPosition:`${ke.x}% ${ke.y}%`,backgroundSize:"150%"}}),e.jsx("img",{src:C,alt:`${n.name}`,className:"lg:hidden max-w-full max-h-[260px] object-contain rounded-lg "+(ce?"":"hidden")}),e.jsx("div",{className:"hidden lg:flex absolute bottom-3 right-3 w-8 h-8 rounded-lg items-center justify-center transition-all pointer-events-none "+(i?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:e.jsx("i",{className:"fas fa-search-plus text-sm"})}),e.jsxs("div",{className:"absolute top-3 left-3 flex flex-col gap-1",children:[e.jsx("div",{className:"px-2 py-1 rounded-lg text-[10px] font-medium "+(E?"bg-neutral-600 text-white":"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white"),children:E?"Original":"Look Gerado"}),R&&e.jsxs("div",{className:"px-2 py-1 rounded-lg text-[10px] font-medium "+(i?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1 text-[8px]"}),O==="front"?"Frente":"Costas"]})]}),R&&e.jsxs("div",{className:"absolute top-3 right-3 px-2 py-1 rounded-lg text-[10px] font-bold "+(i?"bg-purple-500/80 text-white":"bg-purple-500 text-white"),children:[e.jsx("i",{className:"fas fa-images mr-1 text-[8px]"}),_," fotos"]})]}):e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsx("i",{className:(i?"text-neutral-600":"text-gray-400")+" fas fa-image text-3xl"})})})]})}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-3",children:[e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-3",children:[e.jsxs("h3",{className:(i?"text-white":"text-gray-900")+" text-xs font-semibold mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-layer-group text-[#FF6B6B] text-[10px]"}),Ue==="composer"?"Peças do Look":"Look Descrito"]}),Ue==="composer"&&_e.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg bg-[#FF6B6B]/10 border border-[#FF6B6B]/20",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg overflow-hidden flex-shrink-0",children:M&&e.jsx(Q,{src:M,alt:n.name,className:"w-full h-full",size:"thumb"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(i?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:n.name}),e.jsx("p",{className:"text-[#FF6B6B] text-[10px]",children:"Peça Principal"})]})]}),_e.map(([y,A])=>e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-lg "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsx("div",{className:(i?"bg-neutral-700":"bg-gray-200")+" w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0 overflow-hidden",children:A.image?e.jsx(Q,{src:A.image,alt:A.name,className:"w-full h-full",size:"thumb"}):e.jsx("i",{className:(i?"text-neutral-500":"text-gray-400")+" fas "+(Es[y]||"fa-shirt")})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(i?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:A.name||"Sem nome"}),e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[10px]",children:$s[y]||y})]})]},y))]}):Ue==="describe"&&Z?e.jsxs("div",{className:"space-y-2 text-xs",children:[Z.top&&e.jsxs("div",{className:"p-2 rounded-lg "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsx("span",{className:i?"text-neutral-500":"text-gray-500",children:"Cima:"}),e.jsx("span",{className:(i?"text-white":"text-gray-900")+" ml-2",children:Z.top})]}),Z.bottom&&e.jsxs("div",{className:"p-2 rounded-lg "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsx("span",{className:i?"text-neutral-500":"text-gray-500",children:"Baixo:"}),e.jsx("span",{className:(i?"text-white":"text-gray-900")+" ml-2",children:Z.bottom})]}),Z.shoes&&e.jsxs("div",{className:"p-2 rounded-lg "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsx("span",{className:i?"text-neutral-500":"text-gray-500",children:"Calçados:"}),e.jsx("span",{className:(i?"text-white":"text-gray-900")+" ml-2",children:Z.shoes})]}),Z.accessories&&e.jsxs("div",{className:"p-2 rounded-lg "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsx("span",{className:i?"text-neutral-500":"text-gray-500",children:"Acessórios:"}),e.jsx("span",{className:(i?"text-white":"text-gray-900")+" ml-2",children:Z.accessories})]})]}):e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-xs",children:"Nenhuma peça adicional"})]}),e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-3",children:[e.jsxs("h3",{className:(i?"text-white":"text-gray-900")+" text-xs font-semibold mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-chart-simple text-[#FF6B6B] text-[10px]"}),"Informações"]}),e.jsxs("div",{className:"space-y-2",children:[je&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:(i?"bg-neutral-800":"bg-gray-100")+" w-7 h-7 rounded-lg flex items-center justify-center overflow-hidden",children:(be=je.images)!=null&&be.front?e.jsx(Q,{src:je.images.front,alt:je.name,className:"w-full h-full",size:"thumb"}):e.jsx("i",{className:(i?"text-neutral-400":"text-gray-500")+" fas fa-user text-[10px]"})}),e.jsxs("div",{children:[e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[9px] uppercase tracking-wide",children:"Modelo"}),e.jsx("p",{className:(i?"text-white":"text-gray-900")+" text-xs font-medium",children:je.name})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:(i?"bg-neutral-800":"bg-gray-100")+" w-7 h-7 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:(i?"text-neutral-400":"text-gray-500")+" fas fa-image text-[10px]"})}),e.jsxs("div",{children:[e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[9px] uppercase tracking-wide",children:"Fundo"}),e.jsx("p",{className:(i?"text-white":"text-gray-900")+" text-xs font-medium",children:$==="studio"?"Estúdio":"Personalizado"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-green-500/20 w-7 h-7 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check text-green-400 text-[10px]"})}),e.jsxs("div",{children:[e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[9px] uppercase tracking-wide",children:"Status"}),e.jsx("p",{className:"text-green-400 text-xs font-medium",children:"Look gerado com sucesso"})]})]})]})]}),e.jsxs("button",{onClick:re,disabled:Oe,className:"w-full py-3 rounded-xl font-bold text-sm transition-all flex items-center justify-center gap-2 "+(Oe?"bg-green-500/20 text-green-400 border-2 border-green-500/30":"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white hover:opacity-90 "),children:[e.jsx("i",{className:"fas "+(Oe?"fa-check-circle":"fa-images")}),e.jsx("span",{children:Oe?"Look Salvo!":"Salvar Look"})]}),ct&&e.jsxs("button",{onClick:ct,className:(i?"bg-neutral-800 text-white hover:bg-neutral-700 border-neutral-700":"bg-white text-gray-700 hover:bg-gray-50 border-gray-200")+" w-full py-3 rounded-xl font-semibold text-sm border transition-all flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-plus"}),e.jsx("span",{children:"Criar Novo Look"})]}),e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[9px] uppercase tracking-wide",children:"Baixar Imagem"}),e.jsxs("button",{onClick:()=>oe(!I),className:(i?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700")+" text-[10px] flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-gear"}),H==="high"?"Alta Qualidade":"Performance"]})]}),I&&e.jsxs("div",{className:"mb-3 p-2 rounded-lg space-y-1.5 "+(i?"bg-neutral-800":"bg-gray-50"),children:[e.jsxs("button",{onClick:()=>b("high"),className:"w-full p-2 rounded-lg text-left text-xs flex items-center gap-2 transition-all "+(H==="high"?"bg-[#FF6B6B]/20 text-[#FF6B6B] border border-[#FF6B6B]/30":i?"hover:bg-neutral-700 text-neutral-300":"hover:bg-gray-100 text-gray-600"),children:[e.jsx("i",{className:"fas fa-gem w-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Alta Qualidade"}),e.jsx("span",{className:(i?"text-neutral-500":"text-gray-400")+" ml-2",children:"PNG 2048px"})]}),H==="high"&&e.jsx("i",{className:"fas fa-check ml-auto text-[#FF6B6B]"})]}),e.jsxs("button",{onClick:()=>b("performance"),className:"w-full p-2 rounded-lg text-left text-xs flex items-center gap-2 transition-all "+(H==="performance"?"bg-[#FF6B6B]/20 text-[#FF6B6B] border border-[#FF6B6B]/30":i?"hover:bg-neutral-700 text-neutral-300":"hover:bg-gray-100 text-gray-600"),children:[e.jsx("i",{className:"fas fa-bolt w-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Performance"}),e.jsx("span",{className:(i?"text-neutral-500":"text-gray-400")+" ml-2",children:"JPEG 1024px"})]}),H==="performance"&&e.jsx("i",{className:"fas fa-check ml-auto text-[#FF6B6B]"})]})]}),e.jsxs("div",{className:"grid gap-2 "+(R?"grid-cols-2":"grid-cols-1"),children:[e.jsxs("button",{onClick:X,className:"py-2.5 px-4 rounded-lg transition-all flex items-center justify-center gap-2 "+(i?"bg-neutral-800 hover:bg-neutral-700 border-neutral-700 text-white":"bg-gray-50 hover:bg-gray-100 border-gray-200 text-gray-700")+" border",title:R?`Baixar imagem ${O==="front"?"de frente":"de costas"}`:"Baixar imagem",children:[e.jsx("i",{className:"fas fa-download text-sm"}),e.jsx("span",{className:"text-xs font-medium",children:R?O==="front"?"Frente":"Costas":"Baixar"})]}),R&&e.jsxs("button",{onClick:Fe,className:(i?"bg-purple-500/20 hover:bg-purple-500/30 border-[#A855F7]/30":"bg-purple-50 hover:bg-purple-100 border-[#A855F7]/20")+" py-2.5 px-4 rounded-lg border transition-all flex items-center justify-center gap-2",title:"Baixar frente e costas",children:[e.jsx("i",{className:"fas fa-images text-purple-400 text-sm"}),e.jsx("span",{className:"text-purple-400 text-xs font-medium",children:"Baixar Todas"})]})]})]}),e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-3",children:[e.jsx("p",{className:(i?"text-neutral-500":"text-gray-500")+" text-[9px] uppercase tracking-wide mb-2",children:"Ações"}),e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:We,className:(i?"bg-neutral-800 hover:bg-neutral-700 border-neutral-700":"bg-gray-50 hover:bg-gray-100 border-gray-200")+" p-2.5 rounded-lg border transition-all flex flex-col items-center gap-1",children:[e.jsx("i",{className:(i?"text-neutral-300":"text-gray-600")+" fas fa-rotate text-sm"}),e.jsx("span",{className:(i?"text-neutral-400":"text-gray-500")+" text-[9px]",children:"Refazer"})]}),e.jsxs("button",{onClick:()=>ie(!0),className:(i?"bg-neutral-800 hover:bg-neutral-700 border-neutral-700":"bg-gray-50 hover:bg-gray-100 border-gray-200")+" p-2.5 rounded-lg border transition-all flex flex-col items-center gap-1",children:[e.jsx("i",{className:(i?"text-neutral-300":"text-gray-600")+" fas fa-expand text-sm"}),e.jsx("span",{className:(i?"text-neutral-400":"text-gray-500")+" text-[9px]",children:"Ampliar"})]}),e.jsxs("button",{onClick:()=>ae(!0),className:(i?"bg-amber-500/10 hover:bg-amber-500/20 border-amber-500/30":"bg-amber-50 hover:bg-amber-100 border-amber-200")+" p-2.5 rounded-lg border transition-all flex flex-col items-center gap-1",children:[e.jsx("i",{className:"fas fa-flag text-amber-400 text-sm"}),e.jsx("span",{className:"text-amber-400 text-[9px]",children:"Report"})]}),e.jsxs("button",{onClick:()=>ge(!0),className:(i?"bg-red-500/10 hover:bg-red-500/20 border-red-500/30":"bg-red-50 hover:bg-red-100 border-red-200")+" p-2.5 rounded-lg border transition-all flex flex-col items-center gap-1",children:[e.jsx("i",{className:"fas fa-trash text-red-400 text-sm"}),e.jsx("span",{className:"text-red-400 text-[9px]",children:"Excluir"})]})]})]})]})]})}),Re&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-black/95",onClick:()=>ie(!1),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 flex-shrink-0",style:{paddingTop:"max(1rem, env(safe-area-inset-top, 1rem))"},onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1 bg-white/10 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>Ne(!1),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(E?"text-white/70 hover:text-white":"bg-white text-black"),children:"Look"}),e.jsx("button",{onClick:()=>Ne(!0),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(E?"bg-white text-black":"text-white/70 hover:text-white"),children:"Original"})]}),R&&e.jsxs("div",{className:"flex items-center gap-1 bg-white/10 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>p("front"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(O==="front"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":"text-white/70 hover:text-white"),children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"Frente"]}),e.jsxs("button",{onClick:()=>p("back"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(O==="back"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":"text-white/70 hover:text-white"),children:[e.jsx("i",{className:"fas fa-eye mr-1"}),"Costas"]})]})]}),e.jsx("button",{onClick:()=>ie(!1),className:"w-10 h-10 rounded-full bg-white/10 text-white flex items-center justify-center hover:bg-white/20",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",onClick:y=>y.stopPropagation(),children:e.jsx(ps,{src:C||"",alt:n.name,className:"w-full h-full"})}),R&&e.jsxs("div",{className:"flex items-center justify-center gap-2 pb-4",onClick:y=>y.stopPropagation(),children:[e.jsx("button",{onClick:()=>p("front"),className:"w-2.5 h-2.5 rounded-full transition-all "+(O==="front"?"bg-[#FF6B6B]/100 scale-125":"bg-white/30 hover:bg-white/50")}),e.jsx("button",{onClick:()=>p("back"),className:"w-2.5 h-2.5 rounded-full transition-all "+(O==="back"?"bg-[#FF6B6B]/100 scale-125":"bg-white/30 hover:bg-white/50")})]})]}),De&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>ne(!1)}),e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" relative z-10 w-full max-w-sm rounded-2xl border p-5 ",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-yellow-500/20 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-exclamation-triangle text-yellow-500 text-xl"})}),e.jsx("h3",{className:(i?"text-white":"text-gray-900")+" text-base font-bold font-serif",children:"Sair sem salvar?"}),e.jsx("p",{className:(i?"text-neutral-400":"text-gray-500")+" text-xs mt-1",children:"O look gerado será perdido"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("button",{onClick:()=>he(!0),className:"w-full py-2.5 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-xl font-semibold text-sm hover:opacity-90",children:[e.jsx("i",{className:"fas fa-images mr-2"}),"Salvar e Sair"]}),e.jsx("button",{onClick:()=>he(!1),className:(i?"bg-neutral-800 text-neutral-300 hover:bg-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200")+" w-full py-2.5 rounded-xl font-semibold text-sm",children:"Sair sem Salvar"}),e.jsx("button",{onClick:()=>ne(!1),className:(i?"text-neutral-500":"text-gray-500")+" w-full py-2 text-xs font-medium",children:"Cancelar"})]})]})]}),e.jsx(Fs,{isOpen:D,onClose:()=>ae(!1),onSubmit:Ze,generationType:"look-composer",productName:n.name,theme:dt}),Qe&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>ge(!1)}),e.jsxs("div",{className:(i?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" relative z-10 w-full max-w-sm rounded-2xl border p-5 ",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-trash text-red-500 text-xl"})}),e.jsx("h3",{className:(i?"text-white":"text-gray-900")+" text-base font-bold font-serif",children:"Descartar look?"}),e.jsx("p",{className:(i?"text-neutral-400":"text-gray-500")+" text-xs mt-1",children:"Esta ação não pode ser desfeita"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>ge(!1),className:(i?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200")+" flex-1 py-2.5 rounded-xl font-semibold text-sm",children:"Cancelar"}),e.jsxs("button",{onClick:w,className:"flex-1 py-2.5 bg-red-500 text-white rounded-xl font-semibold text-sm hover:bg-red-600",children:[e.jsx("i",{className:"fas fa-trash mr-2"}),"Excluir"]})]})]})]})]})},Pa=["Preparando o modelo...","Vestindo o look selecionado...","Ajustando a composição...","Aplicando o fundo escolhido...","Processando texturas...","Harmonizando cores e estilos...","Finalizando detalhes...","Otimizando a imagem...","Quase pronto! Últimos ajustes..."],za=["Aplicando detalhes finais...","Melhorando iluminação...","Otimizando qualidade...","Ajustando cores e contraste...","Refinando texturas...","Suavizando bordas...","Aprimorando nitidez...","Balanceando tons...","Quase lá! Últimos retoques..."],Ht="vizzu_pending_generation",zs=n=>{try{localStorage.setItem(Ht,JSON.stringify(n))}catch(Y){console.error("Erro ao salvar geração pendente:",Y)}},Ta=()=>{try{const n=localStorage.getItem(Ht);if(n)return JSON.parse(n)}catch(n){console.error("Erro ao ler geração pendente:",n)}return null},nt=()=>{try{localStorage.removeItem(Ht)}catch(n){console.error("Erro ao limpar geração pendente:",n)}},wt=[{id:"solid-color",name:"Cor Sólida",url:"",category:"solid",icon:"fa-palette",sceneHint:"solid colored background, studio lighting, model standing on matching colored floor"},{id:"photo-studio",name:"Estúdio Fotográfico",url:"https://images.unsplash.com/photo-1604014237800-1c9102c219da?w=1200",category:"estudio",icon:"fa-camera",sceneHint:"professional photo studio with white seamless backdrop and floor, soft studio lighting"},{id:"green-garden",name:"Jardim Verde",url:"https://images.unsplash.com/photo-1558293842-c0fd3db86157?w=1200",category:"natureza",icon:"fa-leaf",sceneHint:"lush green garden with grass, model standing naturally on the grass, natural daylight, outdoor setting"},{id:"minimalist-room",name:"Sala Minimalista",url:"https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?w=1200",category:"interior",icon:"fa-couch",sceneHint:"modern minimalist room interior, model standing on wooden floor, natural light from large windows"},{id:"mountain-trail",name:"Trilha na Montanha",url:"https://images.unsplash.com/photo-1551632811-561732d1e306?w=1200",category:"natureza",icon:"fa-mountain",sceneHint:"scenic mountain hiking trail, model standing on rocky trail path, mountains in background, outdoor adventure setting"},{id:"urban-street",name:"Rua Urbana",url:"https://images.unsplash.com/photo-1517457373958-b7bdd4587205?w=1200",category:"urbano",icon:"fa-city",sceneHint:"urban city street with graffiti walls, model standing on concrete sidewalk, street photography style"},{id:"subway-station",name:"Estação de Metrô",url:"https://images.unsplash.com/photo-1534430480872-3498386e7856?w=1200",category:"urbano",icon:"fa-train-subway",sceneHint:"subway station platform, model standing on tiled platform floor, urban underground setting with dramatic lighting"}],Le=[{id:"product",label:"Produto",icon:"fa-shirt"},{id:"model",label:"Modelo",icon:"fa-user"},{id:"look",label:"Look",icon:"fa-layer-group"},{id:"pose",label:"Pose",icon:"fa-person-walking"},{id:"background",label:"Fundo",icon:"fa-image"},{id:"views",label:"Gerar",icon:"fa-wand-magic-sparkles"}],Ts={Bonés:["head"],Chapéus:["head"],Tiaras:["head"],Lenços:["head"],Camisetas:["top"],Blusas:["top"],Regatas:["top"],Tops:["top"],Camisas:["top"],Jaquetas:["top"],Casacos:["top"],Blazers:["top"],Moletons:["top"],Bodies:["top"],Calças:["bottom"],Shorts:["bottom"],Bermudas:["bottom"],Saias:["bottom"],Leggings:["bottom"],"Shorts Fitness":["bottom"],Vestidos:["top","bottom"],Macacões:["top","bottom"],Jardineiras:["top","bottom"],Tênis:["feet"],Sandálias:["feet"],Botas:["feet"],Calçados:["feet"],Acessórios:[],Bolsas:[],Cintos:[],Relógios:[],Óculos:[],Bijuterias:[]},As=({product:n,products:Y,userCredits:me,onUpdateProduct:it,onDeductCredits:Ue,onAddHistoryLog:Me,onBack:Z,onCheckCredits:je,theme:$="dark",userId:z,savedModels:Ee,onSaveModel:kt,onOpenCreateModel:We,modelLimit:Pe=10,isGenerating:ot=!1,isMinimized:ct=!1,generationProgress:dt=0,generationText:Oe="",onSetGenerating:ye,onSetMinimized:De,onSetProgress:ne,onSetLoadingText:Qe,isAnyGenerationRunning:ge=!1,currentPlan:Re,onOpenPlanModal:ie})=>{var ea,ta;const[E,Ne]=m.useState("product"),[l,ve]=m.useState("generated"),te=m.useMemo(()=>Ee.filter(r=>!r.id.startsWith("default-")),[Ee]),xt=m.useMemo(()=>Ee.filter(r=>r.id.startsWith("default-")),[Ee]),[H,b]=m.useState(null),[I,oe]=m.useState("composer"),[G,we]=m.useState({}),[D,ae]=m.useState({top:"",bottom:"",shoes:"",accessories:""}),ue=m.useMemo(()=>Ts[n.category]||[],[n.category]),[S,O]=m.useState("default"),[p,R]=m.useState(""),[_,ce]=m.useState("studio"),[T,ke]=m.useState("preset"),[V,de]=m.useState(null),[i,fe]=m.useState(null),[M,ze]=m.useState("#ffffff"),[K,Ye]=m.useState(""),[C,Te]=m.useState([]),[re,X]=m.useState(!1),[Fe,Ze]=m.useState(""),[Nt,he]=m.useState(!1),[w,_e]=m.useState("front"),[be,y]=m.useState(!1),[A,se]=m.useState(0),[Ge,Ve]=m.useState(""),[qe,a]=m.useState(0),[x,o]=m.useState(0),[c,f]=m.useState(null),[j,k]=m.useState(0),[L,W]=m.useState([]),[Je,Ke]=m.useState(null),[Xe,Be]=m.useState(null),[Mt,et]=m.useState(!1),[Wt,tt]=m.useState(null),[La,at]=m.useState(null),[Ft,st]=m.useState(null),[mt,Qt]=m.useState(()=>Bs()),[Ua,Ot]=m.useState(!1),[Us,Dt]=m.useState(!1),Ma=Re?Ns(Re):!1,ee=ye?ot:be,Bt=ne?dt:A,t=$==="dark";m.useEffect(()=>{const r=localStorage.getItem(`vizzu-saved-backgrounds-${z}`);if(r)try{Te(JSON.parse(r))}catch(g){console.error("Erro ao carregar fundos salvos:",g)}},[z]);const Yt=m.useCallback(async()=>{const r=Ta();if(!r||!z)return;if((Date.now()-r.startTime)/1e3/60>5){nt();return}const{data:s,error:u}=await Lt.from("generations").select("id, output_image_url, status, error_message").eq("user_id",z).eq("product_id",r.productId).order("created_at",{ascending:!1}).limit(1).single();if(u)return"polling";if((s==null?void 0:s.status)==="failed"||(s==null?void 0:s.status)==="error"){nt();const N=s.error_message||"Erro desconhecido na geração";return console.error("Geração falhou em background:",N),{status:"failed",message:N}}if(s!=null&&s.output_image_url&&s.status==="completed"){if(nt(),z){const P=`vizzu_bg_notified_${z}`,F=JSON.parse(localStorage.getItem(P)||"[]");F.push(`lc-${s.id}`),localStorage.setItem(P,JSON.stringify(F.slice(-200)))}tt(s.output_image_url);const{data:N}=await Lt.from("product_images").select("url").eq("generation_id",s.id).ilike("file_name","%back%").limit(1).maybeSingle();return at((N==null?void 0:N.url)||null),st(s.id),et(!0),"completed"}return"polling"},[z]);m.useEffect(()=>{const r=Ta();if(!r||!z)return;const g=ye||y,s=ne||se;g(!0),f(r.startTime),r.lookItems&&W(r.lookItems),r.productThumbnail&&Ke(r.productThumbnail),r.modelThumbnail&&Be(r.modelThumbnail);const u=Date.now()-r.startTime,N=2.3*60*1e3,P=Math.min(95,Math.floor(u/N*100));s(P);const F=setInterval(async()=>{const q=await Yt();if(q==="completed")clearInterval(F),g(!1),s(0),W([]),Ke(null),Be(null),f(null),k(0);else if(q&&typeof q=="object"&&q.status==="failed")clearInterval(F),g(!1),s(0),W([]),Ke(null),Be(null),f(null),k(0),alert(`Erro na geração: ${q.message}`);else if(q==="polling"){const Ce=Date.now()-r.startTime,Ie=Math.min(95,Math.floor(Ce/N*100));s(Ie)}},5e3),U=setTimeout(()=>{clearInterval(F),nt(),g(!1),s(0),W([]),Ke(null),Be(null),f(null),k(0),alert("A geração expirou após 5 minutos. Tente novamente.")},5*60*1e3);return()=>{clearInterval(F),clearTimeout(U)}},[z,Yt,ye,ne]),m.useEffect(()=>{if(!ee)return;const r=setInterval(()=>{a(g=>(g+1)%Pa.length)},3e3);return()=>clearInterval(r)},[ee]),m.useEffect(()=>{ee&&(Qe||Ve)(Pa[qe])},[qe,ee,Qe]),m.useEffect(()=>{if(!ee){o(0);return}const r=setInterval(()=>{o(g=>(g+1)%za.length)},2500);return()=>clearInterval(r)},[ee]);const d=Ee.find(r=>r.id===H),Zt=m.useCallback(r=>{var g,s,u,N,P,F,U,q,Ce,Ie;if((s=(g=r.generatedImages)==null?void 0:g.productStudio)!=null&&s.length){const Se=r.generatedImages.productStudio[r.generatedImages.productStudio.length-1];if((u=Se.images)!=null&&u.length){const J=Se.images.find(le=>le.angle==="front");if(J!=null&&J.url)return J.url;if((N=Se.images[0])!=null&&N.url)return Se.images[0].url}}if((F=(P=r.originalImages)==null?void 0:P.front)!=null&&F.url)return r.originalImages.front.url;if((q=(U=r.images)==null?void 0:U[0])!=null&&q.url)return r.images[0].url;if((Ie=(Ce=r.images)==null?void 0:Ce[0])!=null&&Ie.base64)return r.images[0].base64},[]),Ct=m.useMemo(()=>{var P;const r=[],g=((P=d==null?void 0:d.images)==null?void 0:P.front)||(d==null?void 0:d.referenceImageUrl)||Xe;r.push({id:"model-setup",label:"Preparando modelo IA",thumbnail:g||void 0,type:"setup"});const s=Zt(n)||Je;r.push({id:`product-${n.id}`,label:n.name,thumbnail:s||void 0,type:"product"});const u=I==="composer"&&Object.keys(G).length>0,N=L.length>0;return u?Object.entries(G).forEach(([F,U])=>{U&&U.image&&r.push({id:`look-${F}`,label:U.name||F,thumbnail:U.image,type:"item"})}):N&&L.forEach(F=>{r.push({id:`look-${F.slot}`,label:F.name,thumbnail:F.image,type:"item"})}),r.push({id:"finalize",label:w==="front-back"?"Finalizando imagens":"Finalizando imagem",type:"finalize"}),r},[n,G,I,d,w,L,Je,Xe]);m.useEffect(()=>{if(!ee){f(null),k(0);return}if(!c)return;const r=2*60*1e3,g=setInterval(()=>{const s=Date.now()-c,u=Ct.length,N=u-1;if(s>=r)k(u-1);else{const P=s/r,F=Math.floor(P*N);k(Math.min(F,N-1))}},500);return()=>clearInterval(g)},[ee,c,Ct.length]);const He=m.useMemo(()=>{var u,N,P,F,U,q,Ce,Ie,Se;const r=[],g=new Set,s=(J,le)=>{J&&!g.has(J)&&(g.add(J),r.push({url:J,type:le}))};if((N=(u=n.generatedImages)==null?void 0:u.productStudio)!=null&&N.length){const J=n.generatedImages.productStudio[n.generatedImages.productStudio.length-1];if((P=J.images)!=null&&P.length){const le=J.images.find(ut=>ut.angle==="front"),$e=J.images.find(ut=>ut.angle==="back");le!=null&&le.url&&s(le.url,"Frente (Otimizada)"),$e!=null&&$e.url&&s($e.url,"Costas (Otimizada)")}}return(U=(F=n.originalImages)==null?void 0:F.front)!=null&&U.url&&s(n.originalImages.front.url,"Frente"),(Ce=(q=n.originalImages)==null?void 0:q.back)!=null&&Ce.url&&s(n.originalImages.back.url,"Costas"),(Se=(Ie=n.originalImages)==null?void 0:Ie.detail)!=null&&Se.url&&s(n.originalImages.detail.url,"Detalhe"),r.length===0&&n.images&&n.images.forEach((J,le)=>{const $e=J.url||J.base64;$e&&s($e,`Foto ${le+1}`)}),r},[n]),[Xt,Rt]=m.useState(0),_t=m.useMemo(()=>ee?j:0,[ee,j]),Oa=["Tênis","Sapatos","Sandálias","Calçados","Botas","Meias","Relógios","Bolsas","Cintos","Bijuterias","Óculos","Pulseiras","Colares","Brincos","Anéis","Carteiras","Mochilas","Acessórios"],It=r=>r?!Oa.some(g=>r.toLowerCase().includes(g.toLowerCase())):!0,gt=m.useMemo(()=>{var g,s;const r=[];return It(n.category)&&!((s=(g=n.originalImages)==null?void 0:g.back)!=null&&s.url)&&r.push({name:n.name,sku:n.sku,id:n.id}),I==="composer"&&Object.entries(G).forEach(([u,N])=>{var P,F;if(N.productId){const U=Y.find(q=>q.id===N.productId);U&&It(U.category)&&!((F=(P=U.originalImages)==null?void 0:P.back)!=null&&F.url)&&(r.find(q=>q.id===U.id)||r.push({name:U.name,sku:U.sku,id:U.id}))}}),r},[n,G,I,Y]),Gt=m.useMemo(()=>{var r;return d?!!((r=d.images)!=null&&r.back):!1},[d]),rt=1*(w==="front-back"?2:1)*vs[mt],Da=r=>{if(r==="4k"&&!Ss()){Dt(!0),Ot(!0);return}Qt(r),Ea(r)},Ra=()=>{Qt("4k"),Ea("4k"),Ot(!1),Dt(!1)},_a=()=>{Ot(!1),Dt(!1)},Ga=()=>{ie&&ie()},vt=r=>{switch(r){case"product":return He.length>0;case"model":return!!H||l==="create";case"look":return I==="describe"?D.top!==""||D.bottom!==""||D.shoes!=="":!0;case"pose":return S==="default"||p.trim().length>0;case"background":return _==="studio"?!0:T==="prompt"?K.trim().length>0:T==="preset"&&i==="solid-color"?!0:T==="saved"?!!i:!!V||!!i;case"views":return w==="front"?!0:gt.length===0;default:return!1}},Va=()=>{if(!Fe.trim())return;const r={id:`bg-${Date.now()}`,name:Fe.trim(),createdAt:new Date().toISOString()};if(T==="preset"&&i==="solid-color")r.color=M;else if(T==="prompt")r.prompt=K;else if(V)r.base64=V;else if(i){const s=wt.find(u=>u.id===i);r.url=s==null?void 0:s.url}const g=[...C,r];Te(g),localStorage.setItem(`vizzu-saved-backgrounds-${z}`,JSON.stringify(g)),X(!1),Ze("")},qa=r=>{const g=C.filter(s=>s.id!==r);Te(g),localStorage.setItem(`vizzu-saved-backgrounds-${z}`,JSON.stringify(g)),i===r&&fe(null)},Ja=r=>{Ne(r)},Ka=()=>{const r=Le.findIndex(g=>g.id===E);r<Le.length-1&&Ne(Le[r+1].id)},Ha=()=>{const r=Le.findIndex(g=>g.id===E);r>0&&Ne(Le[r-1].id)},Vt=r=>{if(!r.type.startsWith("image/"))return;const g=new FileReader;g.onload=s=>{var u;de((u=s.target)==null?void 0:u.result),fe(null)},g.readAsDataURL(r)},Wa=r=>{var s;r.preventDefault(),r.stopPropagation();const g=(s=r.dataTransfer.files)==null?void 0:s[0];g&&g.type.startsWith("image/")&&Vt(g)},Qa=r=>{r.preventDefault(),r.stopPropagation()},Ya=()=>{De&&De(!0)},Za=()=>{et(!1),tt(null),at(null),st(null)},Xa=()=>{et(!1),tt(null),at(null),st(null)},es=()=>{if(Ft){const r=n.generatedImages||{studioReady:[],cenarioCriativo:[],modeloIA:[],productStudio:[]};it(n.id,{generatedImages:{...r,modeloIA:(r.modeloIA||[]).filter(g=>g.id!==Ft)}})}et(!1),tt(null),at(null),st(null)},ts=()=>{et(!1),tt(null),at(null),st(null)},as=()=>{et(!1),tt(null),at(null),st(null),Ne("model"),we({}),ae({top:"",bottom:"",shoes:"",accessories:""}),O("default"),R(""),ce("studio"),ke("preset"),de(null),fe(null),Ye(""),_e("front")},ss=async()=>{var u,N,P,F,U,q,Ce,Ie,Se,J,le,$e,ut,aa,sa,ra,la,na;if(ge){alert("Aguarde a geração atual terminar.");return}if(je&&!je(rt,"lifestyle"))return;if(!d&&l!=="create"){alert("Selecione um modelo para continuar.");return}if(!z){alert("Usuário não identificado.");return}const r=ye||y,g=ne||se;r(!0),g(0),a(0),f(Date.now()),k(0);let s=!1;try{const pe={child:"3-12 years old child",teen:"13-19 years old teenager",young:"20-25 years old young adult",adult:"25-35 years old adult",mature:"35-50 years old mature adult",senior:"50-60 years old senior",elderly:"60+ years old elderly"},xe=[];d&&(d.ageRange&&xe.push(pe[d.ageRange]||d.ageRange),xe.push(d.gender==="woman"?"female":"male"),d.ethnicity&&xe.push(d.ethnicity),d.ageRange!=="child"&&d.bodyType&&xe.push(d.bodyType));const qt=xe.join(" ")||"female brazilian average adult";let ft;I==="composer"&&Object.keys(G).length>0&&(ft=Object.entries(G).map(([h,B])=>{var yt,At;const v=B.productId?Y.find(Kt=>Kt.id===B.productId):null,jt=((At=(yt=v==null?void 0:v.originalImages)==null?void 0:yt.detail)==null?void 0:At.url)||void 0;return{slot:h,image:B.image||"",name:B.name||"",sku:B.sku||"",productId:B.productId,imageId:B.imageId,detailImage:jt}}));let ht;if(I==="describe"){const h=[];D.top&&h.push(`top: ${D.top}`),D.bottom&&h.push(`bottom: ${D.bottom}`),D.shoes&&h.push(`shoes: ${D.shoes}`),D.accessories&&h.push(`accessories: ${D.accessories}`),ht=h.join(", ")}const Jt=He[0],ia=(Jt==null?void 0:Jt.url)||"",oa=((N=(u=n.originalImages)==null?void 0:u.front)==null?void 0:N.id)||((F=(P=n.images)==null?void 0:P[0])==null?void 0:F.id)||"",ca=((q=(U=n.originalImages)==null?void 0:U.detail)==null?void 0:q.url)||void 0,da=It(n.category),ls=((Ie=(Ce=n.originalImages)==null?void 0:Ce.back)==null?void 0:Ie.url)||(da?"":ia),ns=((J=(Se=n.originalImages)==null?void 0:Se.back)==null?void 0:J.id)||(da?"":oa);let xa;w==="front-back"&&I==="composer"&&Object.keys(G).length>0&&(xa=Object.entries(G).map(([h,B])=>{var ua,fa,ha,ba,pa,ja,ya,Na,va,wa,ka,Fa,Ba,Ca,Ia,Sa;const v=B.productId?Y.find(us=>us.id===B.productId):null,jt=It(v==null?void 0:v.category),yt=((fa=(ua=v==null?void 0:v.originalImages)==null?void 0:ua.front)==null?void 0:fa.url)||((ba=(ha=v==null?void 0:v.images)==null?void 0:ha[0])==null?void 0:ba.url)||((ja=(pa=v==null?void 0:v.images)==null?void 0:pa[0])==null?void 0:ja.base64)||B.image||"",At=((Na=(ya=v==null?void 0:v.originalImages)==null?void 0:ya.front)==null?void 0:Na.id)||((wa=(va=v==null?void 0:v.images)==null?void 0:va[0])==null?void 0:wa.id)||"",Kt=((Fa=(ka=v==null?void 0:v.originalImages)==null?void 0:ka.back)==null?void 0:Fa.url)||(jt?"":yt),ms=((Ca=(Ba=v==null?void 0:v.originalImages)==null?void 0:Ba.back)==null?void 0:Ca.id)||(jt?"":At),gs=((Sa=(Ia=v==null?void 0:v.originalImages)==null?void 0:Ia.detail)==null?void 0:Sa.url)||void 0;return{slot:h,image:Kt,name:B.name||"",sku:B.sku||"",productId:B.productId,imageId:ms,detailImage:gs}}).filter(h=>h.image));let St;S==="custom"&&p.trim()&&(St=p.trim());let $t,Et,Pt,zt,lt;if(_==="custom"){if(T==="prompt"&&K.trim())Pt=K.trim(),lt=`scene: ${K.trim()}, model standing naturally on the ground`;else if(T==="preset"&&i==="solid-color")zt=M,lt=`solid ${M} colored background, professional studio lighting, model standing on matching colored floor`;else if(T==="saved"&&i){const h=C.find(B=>B.id===i);h&&(h.color?(zt=h.color,lt=`solid ${h.color} colored background, model standing on floor`):h.prompt?(Pt=h.prompt,lt=`scene: ${h.prompt}, model standing naturally on the ground`):h.base64?Et=h.base64:h.url&&($t=h.url))}else if(V)Et=V;else if(i){const h=wt.find(B=>B.id===i);$t=h==null?void 0:h.url,lt=h==null?void 0:h.sceneHint}}g(5);const is=ft?ft.map(h=>({name:h.name||h.slot,image:h.image,slot:h.slot})):[],os=Zt(n),cs=((le=d==null?void 0:d.images)==null?void 0:le.front)||(d==null?void 0:d.referenceImageUrl);zs({oderId:`gen_${Date.now()}`,productId:n.id,productName:n.name,productThumbnail:os,startTime:Date.now(),viewsMode:w,lookItems:is,modelThumbnail:cs});const ds=w==="front-back"?48:95,bt=await $a({productId:n.id,userId:z,imageId:oa,imageUrl:ia,detailImageUrl:ca,modelPrompt:qt,clothingPrompt:ht,posePrompt:St,referenceImage:(($e=d==null?void 0:d.images)==null?void 0:$e.front)||(d==null?void 0:d.referenceImageUrl),productCategory:n.category||"Roupas",productDescription:n.description||n.name,productAttributes:n.attributes||{},lookItems:ft,backgroundType:_,customBackgroundUrl:$t,customBackgroundBase64:Et,backgroundPrompt:Pt,solidColor:zt,sceneHint:lt,modelDetails:d?[`${d.hairColor||""} hair, ${d.hairStyle||""}, ${d.expression||""} expression`,d.physicalNotes?`Physical: ${d.physicalNotes}`:"",d.hairNotes?`Face & Hair: ${d.hairNotes}`:"",d.skinNotes?`Skin: ${d.skinNotes}`:""].filter(Boolean).join(". "):"",viewsMode:"front",resolution:mt,onProgress:h=>{const B=5+(h-10)/85*(ds-5);g(Math.round(B))}});if(!bt.success||!((ut=bt.generation)!=null&&ut.image_url))throw new Error(bt.error||bt.message||"Erro ao gerar imagem de frente");let Tt=bt.generation.image_url,Ae=bt.generation.id,pt;if(w==="front-back"){g(50),(Qe||Ve)("Agora gerando a imagem de costas...");const B=((aa=d==null?void 0:d.images)==null?void 0:aa.back)||((sa=d==null?void 0:d.images)==null?void 0:sa.front)||(d==null?void 0:d.referenceImageUrl),v=await $a({productId:n.id,userId:z,imageId:ns,imageUrl:ls,detailImageUrl:ca,modelPrompt:qt,clothingPrompt:ht?ht+" (back view, from behind)":void 0,posePrompt:St?St+", back view, from behind":void 0,referenceImage:B,productCategory:n.category||"Roupas",productDescription:(n.description||n.name)+" - vista de costas",productAttributes:n.attributes||{},lookItems:xa,backgroundType:_,customBackgroundUrl:$t,customBackgroundBase64:Et,backgroundPrompt:Pt,solidColor:zt,sceneHint:lt,modelDetails:d?[`${d.hairColor||""} hair, ${d.hairStyle||""}, ${d.expression||""} expression, back view, from behind`,d.physicalNotes?`Physical: ${d.physicalNotes}`:"",d.hairNotes?`Face & Hair: ${d.hairNotes}`:"",d.skinNotes?`Skin: ${d.skinNotes}`:""].filter(Boolean).join(". "):"back view, from behind",viewsMode:"front",isBackView:!0,frontGenerationId:Ae,resolution:mt,onProgress:jt=>{const yt=50+(jt-10)/85*45;g(Math.round(yt))}});v.success&&((ra=v.generation)!=null&&ra.image_url)&&(pt=v.generation.image_url)}g(90);const xs={id:Ae,createdAt:new Date().toISOString(),tool:"lifestyle",images:{front:Tt,back:pt},metadata:{prompt:I==="describe"?ht:void 0,orientation:"vertical",lookItems:ft,viewsMode:w,modelId:d==null?void 0:d.id,modelName:d==null?void 0:d.name,modelThumbnail:((la=d==null?void 0:d.images)==null?void 0:la.front)||(d==null?void 0:d.referenceImageUrl)}},ma={prompt:I==="describe"?ht:void 0,orientation:"vertical",lookItems:ft,viewsMode:w,modelId:d==null?void 0:d.id,modelName:d==null?void 0:d.name,modelThumbnail:((na=d==null?void 0:d.images)==null?void 0:na.front)||(d==null?void 0:d.referenceImageUrl),backImageUrl:pt||void 0};if(z){const{error:h}=await Lt.from("product_images").insert({product_id:n.id,user_id:z,type:"modelo_ia",angle:"front",url:Tt,file_name:`look_composer_front_${Ae}.png`,mime_type:"image/png",is_primary:!1,generation_id:Ae,metadata:JSON.stringify(ma)});if(h&&console.error("Erro ao salvar imagem front no banco:",h),pt){const{error:B}=await Lt.from("product_images").insert({product_id:n.id,user_id:z,type:"modelo_ia",angle:"back",url:pt,file_name:`look_composer_back_${Ae}.png`,mime_type:"image/png",is_primary:!1,generation_id:Ae,metadata:JSON.stringify(ma)});B&&console.error("Erro ao salvar imagem back no banco:",B)}}const ga=n.generatedImages||{studioReady:[],cenarioCriativo:[],modeloIA:[],productStudio:[]};if(it(n.id,{generatedImages:{...ga,modeloIA:[...ga.modeloIA||[],xs]}}),Ue&&Ue(rt,`Look Composer - ${I==="composer"?"Com peças":"Descrito"} (${w==="front-back"?"Frente e Costas":"Frente"})`),Me){const h=w==="front-back"?" (frente e costas)":"";Me("Look Composer",`Look gerado para "${n.name}"${h}`,"success",[n],"ai",rt,Tt)}if(g(100),nt(),z&&Ae){const h=`vizzu_bg_notified_${z}`,B=JSON.parse(localStorage.getItem(h)||"[]");B.push(`lc-${Ae}`),localStorage.setItem(h,JSON.stringify(B.slice(-200)))}tt(Tt),at(pt||null),st(Ae),setTimeout(()=>{(ye||y)(!1),et(!0)},500);return}catch(pe){const xe=pe instanceof Error?pe.message:"";xe.includes("Failed to fetch")||xe.includes("Load failed")||xe.includes("NetworkError")||xe.includes("AbortError")?(s=!0,console.warn("Geração interrompida por rede — pending mantido para polling")):(console.error("Erro ao gerar:",pe),nt(),Me&&Me("Look Composer",`Erro ao gerar look para "${n.name}": ${pe instanceof Error?pe.message:"Erro desconhecido"}`,"error",[n],"ai",0),alert(`Erro ao gerar look: ${pe instanceof Error?pe.message:"Erro desconhecido"}`))}finally{const pe=ye||y,xe=ne||se;pe(!1),xe(0),s||nt(),W([]),Ke(null),Be(null),f(null),k(0),De&&De(!1)}},rs=()=>{var r,g;switch(E){case"product":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-shirt text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Peça Principal"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Confirme o produto selecionado"})]})]}),e.jsx("div",{className:(t?"bg-neutral-800/50":"bg-gray-50")+" rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex gap-2 flex-shrink-0",children:He.map((s,u)=>e.jsx("div",{className:`w-16 h-16 rounded-lg overflow-hidden cursor-pointer border-2 transition-colors ${Xt===u?t?"border-[#FF6B6B]":"border-[#FF6B6B]/50":"border-transparent"}`,onClick:()=>Rt(u),title:s.type,children:e.jsx(Q,{src:s.url,alt:s.type,className:"w-full h-full",size:"thumb"})},u))}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm truncate",children:n.name}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:n.sku}),n.category&&e.jsx("span",{className:(t?"bg-neutral-700 text-neutral-300":"bg-gray-200 text-gray-600")+" px-2 py-0.5 rounded text-[10px] mt-1 inline-block",children:n.category})]})]})}),e.jsx("div",{className:(t?"bg-green-500/10 border-green-500/20":"bg-green-50 border-green-200")+" rounded-xl p-3 border",children:e.jsxs("p",{className:(t?"text-green-400":"text-green-600")+" text-xs",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Produto confirmado! Avance para selecionar o modelo."]})})]});case"model":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-user text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Modelo IA"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escolha um modelo salvo ou crie um novo"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>ve("generated"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${l==="generated"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles mr-1"}),"Gerados (",te.length,")"]}),e.jsxs("button",{onClick:()=>ve("presets"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${l==="presets"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:[e.jsx("i",{className:"fas fa-users mr-1"}),"Pré-definidos (",xt.length,")"]}),e.jsxs("button",{onClick:()=>ve("create"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${l==="create"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:[e.jsx("i",{className:"fas fa-plus mr-1"}),"Criar Novo"]})]}),l==="generated"?e.jsx("div",{className:"space-y-3",children:te.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-2",children:te.map(s=>{var u,N;return e.jsxs("div",{onClick:()=>b(s.id),className:`relative rounded-xl overflow-hidden cursor-pointer border-2 transition-all ${H===s.id?"border-[#FF6B6B] ring-2 ring-[#FF6B6B]/30":t?"border-neutral-700 hover:border-neutral-600":"border-gray-200 hover:border-gray-300"}`,children:[(u=s.images)!=null&&u.front||s.referenceImageUrl?e.jsx(Q,{src:((N=s.images)==null?void 0:N.front)||s.referenceImageUrl||"",alt:s.name,className:"w-full aspect-square",size:"thumb"}):e.jsx("div",{className:(t?"bg-neutral-800":"bg-gray-100")+" w-full aspect-square flex items-center justify-center",children:e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-user text-2xl"})}),e.jsx("div",{className:(t?"bg-black/70":"bg-white/90")+" absolute inset-x-0 bottom-0 p-2",children:e.jsx("p",{className:(t?"text-white":"text-gray-900")+" text-[10px] font-medium truncate",children:s.name})}),H===s.id&&e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-[#FF6B6B]/100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check text-white text-[8px]"})})]},s.id)})}):e.jsxs("div",{className:(t?"bg-neutral-800":"bg-gray-100")+" rounded-xl p-6 text-center",children:[e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-user-slash text-3xl mb-3"}),e.jsx("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-sm mb-2",children:"Nenhum modelo gerado"}),e.jsx("button",{onClick:()=>ve("create"),className:"text-[#FF6B6B] text-xs font-medium hover:underline",children:"Criar primeiro modelo"})]})}):l==="presets"?e.jsx("div",{className:"space-y-3",children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:xt.map(s=>{var u,N;return e.jsxs("div",{onClick:()=>b(s.id),className:`relative rounded-xl overflow-hidden cursor-pointer border-2 transition-all ${H===s.id?"border-[#FF6B6B] ring-2 ring-[#FF6B6B]/30":t?"border-neutral-700 hover:border-neutral-600":"border-gray-200 hover:border-gray-300"}`,children:[(u=s.images)!=null&&u.front||s.referenceImageUrl?e.jsx(Q,{src:((N=s.images)==null?void 0:N.front)||s.referenceImageUrl||"",alt:s.name,className:"w-full aspect-square",size:"thumb"}):e.jsx("div",{className:(t?"bg-neutral-800":"bg-gray-100")+" w-full aspect-square flex items-center justify-center",children:e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-user text-2xl"})}),e.jsx("div",{className:(t?"bg-black/70":"bg-white/90")+" absolute inset-x-0 bottom-0 p-2",children:e.jsx("p",{className:(t?"text-white":"text-gray-900")+" text-[10px] font-medium truncate",children:s.name})}),H===s.id&&e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-[#FF6B6B]/100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check text-white text-[8px]"})})]},s.id)})})}):e.jsx("div",{className:"space-y-3",children:te.length>=Pe?e.jsx("div",{className:(t?"bg-amber-500/10 border-amber-500/30":"bg-amber-50 border-amber-200")+" rounded-xl p-4 border",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:(t?"bg-amber-500/20":"bg-amber-100")+" w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:(t?"text-amber-400":"text-amber-600")+" fas fa-exclamation-triangle"})}),e.jsxs("div",{children:[e.jsx("h4",{className:(t?"text-amber-400":"text-amber-700")+" font-semibold text-sm mb-1",children:"Limite de modelos atingido"}),e.jsxs("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-xs leading-relaxed",children:["Você já possui ",te.length,"/",Pe," modelo",Pe>1?"s":""," criado",Pe>1?"s":"",". Para criar um novo, acesse a área de ",e.jsx("strong",{children:"Modelos"})," e exclua um existente."]})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-xs",children:"Clique no botão abaixo para criar um novo modelo personalizado com a IA."}),e.jsxs("button",{onClick:We,disabled:!We,className:"w-full py-3 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-xl font-medium text-sm transition-opacity "+(We?"hover:opacity-90":"opacity-50 cursor-not-allowed"),children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles mr-2"}),"Criar Novo Modelo"]}),e.jsxs("p",{className:(t?"text-neutral-600":"text-gray-400")+" text-[10px] text-center",children:[te.length,"/",Pe," modelos criados"]})]})})]});case"look":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-layer-group text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Monte o Look"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escolha suas peças ou descreva genericamente"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>oe("composer"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${I==="composer"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:["Suas Peças ",e.jsx("span",{className:"opacity-60",children:"(1 crédito)"})]}),e.jsxs("button",{onClick:()=>oe("describe"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${I==="describe"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:["Composição Genérica ",e.jsx("span",{className:"opacity-60",children:"(1 crédito)"})]})]}),I==="composer"?e.jsxs("div",{className:"space-y-3",children:[e.jsx(ks,{products:Y,composition:G,onChange:we,theme:$,lockedSlots:ue,lockedMessage:"Peça principal"}),e.jsxs("p",{className:(t?"text-neutral-500":"text-gray-400")+" text-[10px] text-center",children:[e.jsx("i",{className:"fas fa-info-circle mr-1"}),"Slots vazios serão preenchidos com roupas genéricas pela IA"]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Parte de cima"}),e.jsx("input",{type:"text",value:D.top,onChange:s=>ae(u=>({...u,top:s.target.value})),placeholder:"Ex: camiseta branca básica",className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Parte de baixo"}),e.jsx("input",{type:"text",value:D.bottom,onChange:s=>ae(u=>({...u,bottom:s.target.value})),placeholder:"Ex: calça jeans skinny azul",className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Calçados"}),e.jsx("input",{type:"text",value:D.shoes,onChange:s=>ae(u=>({...u,shoes:s.target.value})),placeholder:"Ex: tênis branco",className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Acessórios (opcional)"}),e.jsx("input",{type:"text",value:D.accessories,onChange:s=>ae(u=>({...u,accessories:s.target.value})),placeholder:"Ex: relógio prata, óculos escuros",className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm"})]})]})]});case"pose":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-person-walking text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Pose do Modelo"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escolha pose padrão ou descreva a pose desejada"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{onClick:()=>O("default"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${S==="default"?"border-[#FF6B6B] bg-[#FF6B6B]/10":t?"border-neutral-700 bg-neutral-800/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:(S==="default"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-700 text-neutral-400":"bg-gray-200 text-gray-500")+" w-10 h-10 rounded-lg flex items-center justify-center transition-colors",children:e.jsx("i",{className:"fas fa-person"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:"Pose Padrão"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Pose natural de catálogo, em pé de frente"})]}),S==="default"&&e.jsx("i",{className:"fas fa-check-circle text-[#FF6B6B]"})]})}),e.jsx("div",{onClick:()=>O("custom"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${S==="custom"?"border-[#FF6B6B] bg-[#FF6B6B]/10":t?"border-neutral-700 bg-neutral-800/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:(S==="custom"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-700 text-neutral-400":"bg-gray-200 text-gray-500")+" w-10 h-10 rounded-lg flex items-center justify-center transition-colors",children:e.jsx("i",{className:"fas fa-pen-fancy"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:"Descrever Pose"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escreva um prompt descrevendo a pose desejada"})]}),S==="custom"&&e.jsx("i",{className:"fas fa-check-circle text-[#FF6B6B]"})]})})]}),S==="custom"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Descreva a pose"}),e.jsx("textarea",{value:p,onChange:s=>R(s.target.value),placeholder:"Ex: modelo sentada em uma cadeira com as pernas cruzadas, olhando para o lado",maxLength:200,rows:3,className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm resize-none"}),e.jsx("div",{className:"flex justify-between mt-1",children:e.jsxs("span",{className:(t?"text-neutral-600":"text-gray-400")+" text-[10px]",children:[p.length,"/200 caracteres"]})})]}),e.jsx("div",{className:(t?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-200")+" rounded-xl p-3 border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:(t?"text-blue-400":"text-blue-600")+" fas fa-lightbulb text-sm mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:(t?"text-blue-400":"text-blue-700")+" font-medium text-xs mb-1",children:"Boas práticas"}),e.jsxs("ul",{className:(t?"text-blue-300/80":"text-blue-600")+" text-[10px] space-y-1",children:[e.jsx("li",{children:"• Seja objetivo e direto na descrição"}),e.jsx("li",{children:"• Evite prompts muito longos ou complexos"}),e.jsx("li",{children:"• Descreva uma única pose clara"}),e.jsx("li",{children:"• Evite poses muito elaboradas ou impossíveis"}),e.jsx("li",{children:"• Use referências simples (sentada, andando, apoiada)"})]})]})]})})]})]});case"background":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-image text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Escolha o Fundo"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Estúdio, preset, upload ou descreva"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>ce("studio"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${_==="studio"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:[e.jsx("i",{className:"fas fa-store mr-1"}),"Estúdio"]}),e.jsxs("button",{onClick:()=>ce("custom"),className:`flex-1 py-2 rounded-lg text-xs font-medium transition-colors ${_==="custom"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-800 text-neutral-300":"bg-gray-200 text-gray-600"}`,children:[e.jsx("i",{className:"fas fa-image mr-1"}),"Personalizado"]})]}),_==="studio"?e.jsx("div",{className:(t?"bg-neutral-800/50":"bg-gray-50")+" rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg bg-gradient-to-br from-gray-300 to-gray-400 flex items-center justify-center",children:e.jsx("i",{className:"fas fa-camera text-gray-500 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:"Fundo Estúdio Cinza"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Fundo neutro profissional, ideal para e-commerce e catálogos"})]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsxs("button",{onClick:()=>ke("preset"),className:`flex-1 py-1.5 rounded-lg text-[10px] font-medium transition-colors ${T==="preset"?t?"bg-neutral-700 text-white":"bg-gray-300 text-gray-900":t?"bg-neutral-800/50 text-neutral-400":"bg-gray-100 text-gray-500"}`,children:[e.jsx("i",{className:"fas fa-images mr-1"}),"Presets"]}),e.jsxs("button",{onClick:()=>ke("upload"),className:`flex-1 py-1.5 rounded-lg text-[10px] font-medium transition-colors ${T==="upload"?t?"bg-neutral-700 text-white":"bg-gray-300 text-gray-900":t?"bg-neutral-800/50 text-neutral-400":"bg-gray-100 text-gray-500"}`,children:[e.jsx("i",{className:"fas fa-upload mr-1"}),"Upload"]}),e.jsxs("button",{onClick:()=>ke("prompt"),className:`flex-1 py-1.5 rounded-lg text-[10px] font-medium transition-colors ${T==="prompt"?t?"bg-neutral-700 text-white":"bg-gray-300 text-gray-900":t?"bg-neutral-800/50 text-neutral-400":"bg-gray-100 text-gray-500"}`,children:[e.jsx("i",{className:"fas fa-pen mr-1"}),"Prompt"]}),e.jsxs("button",{onClick:()=>ke("saved"),className:`flex-1 py-1.5 rounded-lg text-[10px] font-medium transition-colors ${T==="saved"?t?"bg-neutral-700 text-white":"bg-gray-300 text-gray-900":t?"bg-neutral-800/50 text-neutral-400":"bg-gray-100 text-gray-500"}`,children:[e.jsx("i",{className:"fas fa-bookmark mr-1"}),"Salvos"]})]}),T==="preset"&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2",children:wt.map(s=>e.jsxs("div",{onClick:()=>{fe(s.id),de(null)},className:`relative rounded-xl overflow-hidden cursor-pointer border-2 transition-all ${i===s.id?"border-[#FF6B6B] ring-2 ring-[#FF6B6B]/30":t?"border-neutral-700 hover:border-neutral-600":"border-gray-200 hover:border-gray-300"}`,children:[s.id==="solid-color"?e.jsx("div",{className:"w-full h-20 flex items-center justify-center",style:{backgroundColor:M},children:e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-palette text-2xl",style:{color:M==="#ffffff"?"#9ca3af":"#ffffff"}})}):e.jsx(Q,{src:s.url,alt:s.name,className:"w-full h-20",size:"thumb"}),e.jsxs("div",{className:(t?"bg-black/70":"bg-white/90")+" absolute inset-x-0 bottom-0 py-1.5 px-2 flex items-center gap-1.5",children:[e.jsx("i",{className:(t?"text-neutral-400":"text-gray-500")+" fas "+(s.icon||"fa-image")+" text-[10px]"}),e.jsx("p",{className:(t?"text-white":"text-gray-900")+" text-[10px] font-medium",children:s.name})]}),i===s.id&&e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-[#FF6B6B]/100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check text-white text-[8px]"})})]},s.id))}),i==="solid-color"&&e.jsxs("div",{className:(t?"bg-neutral-800/50":"bg-gray-50")+" rounded-xl p-3",children:[e.jsx("label",{className:(t?"text-neutral-400":"text-gray-600")+" block text-[10px] font-medium uppercase tracking-wide mb-2",children:"Escolha a cor"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",value:M,onChange:s=>ze(s.target.value),className:"w-12 h-10 rounded-lg border-0 cursor-pointer"}),e.jsx("input",{type:"text",value:M,onChange:s=>ze(s.target.value),placeholder:"#ffffff",className:(t?"bg-neutral-700 border-neutral-600 text-white":"bg-white border-gray-300 text-gray-900")+" flex-1 px-3 py-2 border rounded-lg text-sm font-mono uppercase"})]}),e.jsx("div",{className:"flex gap-1.5 mt-2",children:["#ffffff","#f3f4f6","#e5e7eb","#fce7f3","#fee2e2","#fef3c7","#d1fae5","#dbeafe","#1f2937","#000000"].map(s=>e.jsx("button",{onClick:()=>ze(s),className:"w-6 h-6 rounded-full border-2 transition-all "+(M===s?"border-[#FF6B6B] scale-110":t?"border-neutral-600":"border-gray-300"),style:{backgroundColor:s}},s))})]})]}),T==="upload"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{onClick:()=>he(!0),onDragOver:Qa,onDrop:Wa,className:`block w-full py-6 border-2 border-dashed rounded-xl text-center cursor-pointer transition-colors ${t?"border-neutral-700 hover:border-[#FF6B6B]/50":"border-gray-300 hover:border-[#FF6B6B]/50"}`,children:[e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-cloud-upload-alt text-3xl mb-2"}),e.jsx("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-sm font-medium",children:"Clique para enviar"}),e.jsx("p",{className:(t?"text-neutral-600":"text-gray-400")+" text-[10px] mt-1",children:"Imagem de fundo sem pessoas"}),e.jsx("p",{className:(t?"text-neutral-600":"text-gray-400")+" text-[9px] mt-1 opacity-60",children:"ou arraste aqui"})]}),V&&e.jsxs("div",{className:"relative rounded-xl overflow-hidden border-2 border-[#FF6B6B]",children:[e.jsx("img",{src:V,alt:"Fundo personalizado",className:"w-full h-32 object-cover"}),e.jsx("button",{onClick:()=>de(null),className:"absolute top-2 right-2 w-7 h-7 bg-black/50 rounded-full flex items-center justify-center text-white hover:bg-black/70",children:e.jsx("i",{className:"fas fa-times text-sm"})})]})]}),T==="prompt"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:(t?"text-neutral-500":"text-gray-500")+" block text-[10px] font-medium uppercase tracking-wide mb-1",children:"Descreva o fundo desejado"}),e.jsx("textarea",{value:K,onChange:s=>Ye(s.target.value),placeholder:"Ex: praia tropical com palmeiras ao pôr do sol, areia branca...",maxLength:300,rows:3,className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-3 py-2 border rounded-lg text-sm resize-none"}),e.jsx("div",{className:"flex justify-between mt-1",children:e.jsxs("span",{className:(t?"text-neutral-600":"text-gray-400")+" text-[10px]",children:[K.length,"/300 caracteres"]})})]}),e.jsx("div",{className:(t?"bg-amber-500/10 border-amber-500/20":"bg-amber-50 border-amber-200")+" rounded-xl p-3 border",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("i",{className:(t?"text-amber-400":"text-amber-600")+" fas fa-info-circle text-sm mt-0.5"}),e.jsx("p",{className:(t?"text-amber-300/80":"text-amber-700")+" text-[10px]",children:"Descreva um cenário simples e claro. A IA irá gerar o fundo baseado na descrição."})]})})]}),T==="saved"&&e.jsx("div",{className:"space-y-3",children:C.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:C.map(s=>e.jsxs("div",{onClick:()=>{fe(s.id),de(null)},className:`relative rounded-xl overflow-hidden cursor-pointer border-2 transition-all group ${i===s.id?"border-[#FF6B6B] ring-2 ring-[#FF6B6B]/30":t?"border-neutral-700 hover:border-neutral-600":"border-gray-200 hover:border-gray-300"}`,children:[s.color?e.jsx("div",{className:"w-full h-20",style:{backgroundColor:s.color}}):s.base64?e.jsx("img",{src:s.base64,alt:s.name,className:"w-full h-20 object-cover"}):s.url?e.jsx(Q,{src:s.url,alt:s.name,className:"w-full h-20",size:"thumb"}):e.jsx("div",{className:(t?"bg-neutral-800":"bg-gray-100")+" w-full h-20 flex items-center justify-center",children:e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-pen text-xl"})}),e.jsx("div",{className:(t?"bg-black/70":"bg-white/90")+" absolute inset-x-0 bottom-0 py-1.5 px-2",children:e.jsx("p",{className:(t?"text-white":"text-gray-900")+" text-[10px] font-medium truncate",children:s.name})}),i===s.id&&e.jsx("div",{className:"absolute top-2 right-2 w-5 h-5 bg-[#FF6B6B]/100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-check text-white text-[8px]"})}),e.jsx("button",{onClick:u=>{u.stopPropagation(),qa(s.id)},className:"absolute top-2 left-2 w-5 h-5 bg-red-500/80 rounded-full flex items-center justify-center text-white opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-600",children:e.jsx("i",{className:"fas fa-times text-[8px]"})})]},s.id))}):e.jsxs("div",{className:(t?"bg-neutral-800":"bg-gray-100")+" rounded-xl p-6 text-center",children:[e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-bookmark text-3xl mb-3"}),e.jsx("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-sm mb-1",children:"Nenhum fundo salvo"}),e.jsx("p",{className:(t?"text-neutral-600":"text-gray-400")+" text-[10px]",children:"Salve seus fundos favoritos para reutilizar"})]})}),(V||i||K)&&T!=="saved"&&e.jsxs("button",{onClick:()=>X(!0),className:(t?"bg-neutral-800 text-neutral-300 hover:bg-neutral-700 border-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200 border-gray-200")+" w-full py-2 rounded-xl text-xs font-medium border transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-bookmark"}),"Salvar este fundo"]})]})]});case"views":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:(t?"bg-[#FF6B6B]/20":"bg-[#FF6B6B]/15")+" w-8 h-8 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"text-[#FF6B6B] fas fa-clone text-sm"})}),e.jsxs("div",{children:[e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" font-semibold text-sm",children:"Ângulos do Look"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escolha se quer gerar só frente ou frente e costas"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{onClick:()=>_e("front"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${w==="front"?"border-[#FF6B6B] bg-[#FF6B6B]/10":t?"border-neutral-700 bg-neutral-800/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:(w==="front"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-700 text-neutral-400":"bg-gray-200 text-gray-500")+" w-10 h-10 rounded-lg flex items-center justify-center transition-colors",children:e.jsx("i",{className:"fas fa-image"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:"Só Frente"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Gera uma imagem frontal do look"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-[#FF6B6B] font-semibold text-sm",children:[I==="composer"?20:10," créditos"]})}),w==="front"&&e.jsx("i",{className:"fas fa-check-circle text-[#FF6B6B]"})]})}),e.jsx("div",{onClick:()=>_e("front-back"),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${w==="front-back"?"border-[#FF6B6B] bg-[#FF6B6B]/10":t?"border-neutral-700 bg-neutral-800/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:(w==="front-back"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white":t?"bg-neutral-700 text-neutral-400":"bg-gray-200 text-gray-500")+" w-10 h-10 rounded-lg flex items-center justify-center transition-colors",children:e.jsx("i",{className:"fas fa-clone"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:"Frente e Costas"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs",children:"Gera duas imagens: vista frontal e traseira"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-[#FF6B6B] font-semibold text-sm",children:[(I==="composer"?20:10)*2," créditos"]})}),w==="front-back"&&e.jsx("i",{className:"fas fa-check-circle text-[#FF6B6B]"})]})})]}),w==="front-back"&&!Gt&&d&&e.jsx("div",{className:(t?"bg-amber-500/10 border-amber-500/30":"bg-amber-50 border-amber-200")+" rounded-xl p-4 border",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:(t?"bg-amber-500/20":"bg-amber-100")+" w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:(t?"text-amber-400":"text-amber-600")+" fas fa-user-slash"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:(t?"text-amber-400":"text-amber-700")+" font-semibold text-sm mb-1",children:"Modelo sem foto de costas"}),e.jsxs("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-xs leading-relaxed",children:["O modelo ",e.jsx("strong",{children:d.name})," não possui imagem de referência de costas. A imagem de costas será gerada usando a referência frontal do modelo, o que pode afetar a consistência."]}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-[10px] mt-2",children:"Para melhores resultados, recrie o modelo para gerar a imagem de costas."})]})]})}),w==="front-back"&&gt.length>0&&e.jsx("div",{className:(t?"bg-amber-500/10 border-amber-500/30":"bg-amber-50 border-amber-200")+" rounded-xl p-4 border",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:(t?"bg-amber-500/20":"bg-amber-100")+" w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:(t?"text-amber-400":"text-amber-600")+" fas fa-exclamation-triangle"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:(t?"text-amber-400":"text-amber-700")+" font-semibold text-sm mb-1",children:gt.length===1?"Produto sem foto de costas":"Produtos sem foto de costas"}),e.jsx("p",{className:(t?"text-neutral-400":"text-gray-600")+" text-xs leading-relaxed mb-2",children:"Para gerar a imagem de costas, você precisa cadastrar a foto de costas dos seguintes produtos:"}),e.jsx("ul",{className:(t?"text-neutral-300":"text-gray-700")+" text-xs space-y-1",children:gt.map(s=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-times-circle text-red-400 text-[10px]"}),e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("span",{className:t?"text-neutral-500":"text-gray-400",children:["(",s.sku,")"]})]},s.id))}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-[10px] mt-2",children:"Acesse o Product Studio para adicionar as fotos de costas."})]})]})}),w==="front-back"&&gt.length===0&&Gt&&e.jsx("div",{className:(t?"bg-green-500/10 border-green-500/20":"bg-green-50 border-green-200")+" rounded-xl p-3 border",children:e.jsxs("p",{className:(t?"text-green-400":"text-green-600")+" text-xs",children:[e.jsx("i",{className:"fas fa-check-circle mr-2"}),"Todos os produtos e o modelo têm foto de costas. Você pode gerar frente e costas!"]})}),w==="front-back"&&gt.length===0&&!Gt&&d&&e.jsx("div",{className:(t?"bg-blue-500/10 border-blue-500/20":"bg-blue-50 border-blue-200")+" rounded-xl p-3 border",children:e.jsxs("p",{className:(t?"text-blue-400":"text-blue-600")+" text-xs",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"Produtos OK. A imagem de costas usará a referência frontal do modelo."]})}),e.jsx("div",{className:(t?"bg-neutral-800/50 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl p-4 border mt-4",children:e.jsx(Is,{resolution:mt,onChange:Da,canUse4K:Ma,onUpgradeClick:Ga,theme:$,disabled:ee})}),e.jsxs("div",{className:(t?"bg-neutral-800/50 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl p-4 border mt-4",children:[e.jsx("h4",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm mb-3",children:"Resumo da Geração"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Produto"}),e.jsx("span",{className:(t?"text-white":"text-gray-900")+" truncate max-w-[140px]",children:n.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Modelo"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:(d==null?void 0:d.name)||"Novo modelo"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Look"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:I==="describe"?"Descrito":"Com suas peças"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Pose"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:S==="default"?"Padrão":"Personalizada"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Fundo"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:_==="studio"?"Estúdio Cinza":T==="prompt"?"Por prompt":i==="solid-color"?`Cor ${M}`:i?((r=wt.find(s=>s.id===i))==null?void 0:r.name)||((g=C.find(s=>s.id===i))==null?void 0:g.name):"Personalizado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Ângulos"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:w==="front"?"Só Frente":"Frente e Costas"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Resolução"}),e.jsx("span",{className:t?"text-white":"text-gray-900",children:mt.toUpperCase()})]}),e.jsx("div",{className:"h-px my-2 "+(t?"bg-neutral-700":"bg-gray-200")}),e.jsxs("div",{className:"flex justify-between font-medium",children:[e.jsx("span",{className:t?"text-neutral-400":"text-gray-500",children:"Créditos"}),e.jsxs("span",{className:"text-[#FF6B6B]",children:[rt,mt==="4k"?" (4K)":""]})]})]})]})]})}};return Mt&&Wt&&Ft?e.jsx(Ps,{product:n,generatedImageUrl:Wt,generatedBackImageUrl:La||void 0,generationId:Ft,lookMode:I,lookComposition:G,describedLook:D,selectedModel:d,backgroundType:_,creditsUsed:rt,userCredits:me,onSave:Za,onRegenerate:Xa,onDelete:es,onBack:ts,onNewLook:as,theme:$}):e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 "+(t?"bg-black":"bg-gray-50"),children:[e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:Z,className:(t?"bg-neutral-800 text-neutral-400 hover:text-white hover:bg-neutral-700":"bg-white text-gray-500 hover:text-gray-700 hover:bg-gray-100 ")+" w-10 h-10 rounded-xl flex items-center justify-center transition-all",children:e.jsx("i",{className:"fas fa-arrow-left"})}),e.jsxs("div",{children:[e.jsx("h1",{className:(t?"text-white":"text-gray-900")+" text-lg font-extrabold",children:"Look Composer"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-xs font-serif italic",children:n.name})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-lg "+(t?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200 "),children:[e.jsx("i",{className:"fas fa-coins text-[#FF6B6B] text-xs"}),e.jsx("span",{className:(t?"text-white":"text-gray-900")+" font-medium text-sm",children:me})]})]}),e.jsx("div",{className:(t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-4 mb-6",children:e.jsx("div",{className:"flex items-center justify-between",children:Le.map((r,g)=>{const s=E===r.id,u=Le.findIndex(P=>P.id===E)>g,N=u||g===0||vt(Le[g-1].id);return e.jsxs(ws.Fragment,{children:[e.jsxs("button",{onClick:()=>N&&Ja(r.id),disabled:!N,className:`flex flex-col items-center gap-1.5 transition-all ${N?"cursor-pointer":"cursor-not-allowed opacity-50"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${s?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":u?"bg-green-500 text-white":t?"bg-neutral-800 text-neutral-500":"bg-gray-100 text-gray-400"}`,children:u?e.jsx("i",{className:"fas fa-check"}):e.jsx("i",{className:`fas ${r.icon}`})}),e.jsx("span",{className:`text-[10px] font-medium ${s?"text-[#FF6B6B]":u?t?"text-green-400":"text-green-600":t?"text-neutral-500":"text-gray-400"}`,children:r.label})]}),g<Le.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mx-2 rounded-full ${u?"bg-green-500":t?"bg-neutral-800":"bg-gray-200"}`})]},r.id)})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:(t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border overflow-hidden",children:e.jsx("div",{className:"relative flex items-center justify-center p-4 min-h-[350px] "+(t?"bg-neutral-800/50":"bg-gray-100"),children:E==="background"||E==="views"?_==="studio"?e.jsx("div",{className:"w-full h-full min-h-[300px] rounded-lg bg-gradient-to-br from-gray-300 via-gray-400 to-gray-500 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"fas fa-camera text-gray-500/50 text-5xl mb-3"}),e.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Fundo Estúdio Cinza"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Fundo neutro profissional"})]})}):V?e.jsx("img",{src:V,alt:"Fundo personalizado",className:"w-full h-full min-h-[300px] object-cover rounded-lg"}):i?e.jsx("img",{src:(ea=wt.find(r=>r.id===i))==null?void 0:ea.url,alt:"Fundo selecionado",className:"w-full h-full min-h-[300px] object-cover rounded-lg"}):e.jsx("div",{className:"w-full h-full min-h-[300px] rounded-lg border-2 border-dashed border-neutral-600 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-image text-4xl mb-2"}),e.jsx("p",{className:(t?"text-neutral-500":"text-gray-500")+" text-sm",children:"Selecione um fundo"})]})}):He.length>0?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:(ta=He[Xt])==null?void 0:ta.url,alt:n.name,className:"max-w-full max-h-[400px] object-contain rounded-lg"}),He.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Rt(r=>r===0?He.length-1:r-1),className:"absolute left-3 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm text-white flex items-center justify-center hover:bg-black/70 transition-colors",children:e.jsx("i",{className:"fas fa-chevron-left"})}),e.jsx("button",{onClick:()=>Rt(r=>r===He.length-1?0:r+1),className:"absolute right-3 top-1/2 -translate-y-1/2 w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm text-white flex items-center justify-center hover:bg-black/70 transition-colors",children:e.jsx("i",{className:"fas fa-chevron-right"})})]})]}):e.jsx("div",{className:"w-full h-64 flex items-center justify-center",children:e.jsx("i",{className:(t?"text-neutral-600":"text-gray-400")+" fas fa-image text-4xl"})})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:(t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-xl border p-5",children:rs()}),e.jsxs("div",{className:"flex gap-3",children:[E!=="product"&&e.jsxs("button",{onClick:Ha,className:(t?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200")+" flex-1 py-3 rounded-xl font-medium text-sm transition-colors",children:[e.jsx("i",{className:"fas fa-arrow-left mr-2"}),"Voltar"]}),E!=="views"?e.jsxs("button",{onClick:Ka,disabled:!vt(E),className:"flex-1 py-3 rounded-xl font-medium text-sm transition-all "+(vt(E)?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white hover:opacity-90":(t?"bg-neutral-700":"bg-gray-300")+" text-white cursor-not-allowed opacity-50"),children:["Próximo",e.jsx("i",{className:"fas fa-arrow-right ml-2"})]}):e.jsx("button",{onClick:ss,disabled:ee||ge||!vt("views"),className:"flex-1 py-3 rounded-xl font-semibold text-sm transition-all "+(ee||ge?"bg-[#FF6B6B] cursor-wait":vt("views")?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] hover:opacity-90 ":(t?"bg-neutral-700":"bg-gray-300")+" cursor-not-allowed opacity-50")+" text-white",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"Gerando",w==="front-back"?" 2 imagens":"","..."]}):ge?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-clock mr-2"}),"Aguardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles mr-2"}),"Gerar ",w==="front-back"?"2 Looks":"Look"," (",rt," crédito",rt>1?"s":"",")"]})})]})]})]})]}),ee&&!ct&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:`absolute inset-0 backdrop-blur-2xl ${$==="dark"?"bg-black/80":"bg-white/30"}`}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center max-w-lg mx-auto p-6 w-full",children:[e.jsx("div",{className:"w-24 h-24 mb-4 flex items-center justify-center",children:e.jsx("div",{className:`w-16 h-16 rounded-full border-4 animate-spin ${$==="dark"?"border-neutral-700 border-t-neutral-400":"border-gray-200 border-t-gray-500"}`})}),e.jsx("h2",{className:`text-xl font-bold font-serif mb-1 text-center ${$==="dark"?"text-white":"text-gray-900"}`,children:w==="front-back"?"Criando 2 imagens...":"Criando seu look..."}),e.jsx("p",{className:`text-xs mb-5 text-center ${$==="dark"?"text-neutral-500":"text-gray-500"}`,children:w==="front-back"&&Bt>=48?"Gerando imagem de costas":"Vestindo cada peça com IA"}),e.jsx("div",{className:`w-full max-w-md rounded-2xl p-4 mb-5 border ${$==="dark"?"bg-neutral-900/80 border-neutral-800":"bg-white/80 border-gray-200/60 shadow-sm"}`,children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ct.map((r,g)=>{const s=g<_t,u=g===_t,N=g>_t,F=g===Ct.length-1&&u?za[x]:r.label;return e.jsxs("div",{className:`flex items-center gap-2 transition-all duration-300 ${N?"opacity-40":"opacity-100"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 transition-all duration-300 ${s?"bg-green-500":u?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] animate-pulse":$==="dark"?"bg-neutral-700":"bg-gray-200"}`,children:s?e.jsx("i",{className:"fas fa-check text-white text-[10px]"}):u?e.jsx("i",{className:"fas fa-spinner fa-spin text-white text-[10px]"}):e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-neutral-500"})}),r.thumbnail?e.jsx("div",{className:`w-8 h-8 rounded-md overflow-hidden flex-shrink-0 border-2 transition-all duration-300 ${s?"border-green-500/50":u?"border-[#FF9F43]":$==="dark"?"border-neutral-700":"border-gray-200"}`,children:e.jsx(Q,{src:r.thumbnail,alt:r.label,className:"w-full h-full",size:"thumb"})}):e.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center flex-shrink-0 border-2 transition-all duration-300 ${s?"border-green-500/50 bg-green-500/10":u?"border-[#FF9F43] bg-[#FF9F43]/10":$==="dark"?"border-neutral-700 bg-neutral-800":"border-gray-200 bg-gray-50"}`,children:e.jsx("i",{className:`fas ${r.type==="setup"?"fa-user":r.type==="finalize"?"fa-wand-magic-sparkles":"fa-shirt"} ${s?"text-green-400":u?"text-[#FF9F43]":$==="dark"?"text-neutral-500":"text-gray-400"} text-xs`})}),e.jsx("span",{className:`text-xs font-medium transition-all duration-300 flex-1 leading-tight ${s?"text-green-400":u?$==="dark"?"text-white":"text-gray-900":$==="dark"?"text-neutral-500":"text-gray-400"}`,children:F})]},r.id)})})}),e.jsxs("div",{className:"w-full max-w-md mb-5",children:[e.jsx("div",{className:`h-2 rounded-full overflow-hidden ${$==="dark"?"bg-neutral-800":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] rounded-full transition-all duration-500",style:{width:`${Bt}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:`text-xs ${$==="dark"?"text-neutral-500":"text-gray-500"}`,children:w==="front-back"?Bt<48?"Imagem de frente":"Imagem de costas":"Processando"}),e.jsxs("span",{className:`text-sm font-bold ${$==="dark"?"text-white":"text-gray-900"}`,children:[Bt,"%"]})]})]}),e.jsxs("button",{onClick:Ya,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-medium transition-all ${$==="dark"?"bg-neutral-800 hover:bg-neutral-700 text-white border border-neutral-700":"bg-white/80 hover:bg-white text-gray-700 border border-gray-200/60 shadow-sm"}`,children:[e.jsx("i",{className:"fas fa-minus"}),e.jsx("span",{children:"Minimizar e continuar navegando"})]})]})]}),re&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 safe-area-all",children:[e.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>X(!1)}),e.jsxs("div",{className:(t?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" relative z-10 w-full max-w-sm rounded-2xl border p-5 ",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#FF6B6B]/20 flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:"fas fa-bookmark text-[#FF6B6B] text-xl"})}),e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" text-base font-bold font-serif",children:"Salvar Fundo"}),e.jsx("p",{className:(t?"text-neutral-400":"text-gray-500")+" text-xs mt-1",children:"Dê um nome para este fundo"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",value:Fe,onChange:r=>Ze(r.target.value),placeholder:"Ex: Meu jardim favorito",maxLength:30,className:(t?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full px-4 py-3 border rounded-xl text-sm",autoFocus:!0})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{X(!1),Ze("")},className:(t?"bg-neutral-800 text-white hover:bg-neutral-700":"bg-gray-100 text-gray-700 hover:bg-gray-200")+" flex-1 py-2.5 rounded-xl font-semibold text-sm",children:"Cancelar"}),e.jsxs("button",{onClick:Va,disabled:!Fe.trim(),className:"flex-1 py-2.5 rounded-xl font-semibold text-sm transition-all "+(Fe.trim()?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white hover:opacity-90":(t?"bg-neutral-700 text-neutral-500":"bg-gray-200 text-gray-400")+" cursor-not-allowed"),children:[e.jsx("i",{className:"fas fa-save mr-2"}),"Salvar"]})]})]})]}),Nt&&e.jsx("div",{className:"fixed inset-0 z-[60] bg-black/60 flex items-end justify-center",onClick:()=>he(!1),children:e.jsxs("div",{className:(t?"bg-neutral-900/95 backdrop-blur-2xl border-neutral-800":"bg-white/95 backdrop-blur-2xl border-gray-200")+" rounded-t-2xl w-full max-w-md p-5 pb-8 border-t",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:(t?"bg-neutral-700":"bg-gray-300")+" w-10 h-1 rounded-full mx-auto mb-4"}),e.jsx("h3",{className:(t?"text-white":"text-gray-900")+" text-sm font-medium text-center mb-4",children:"Adicionar fundo personalizado"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("label",{className:(t?"bg-neutral-800 border-neutral-700 hover:border-[#FF6B6B]/50":"bg-gray-50 border-gray-200 hover:border-[#FF6B6B]/50")+" border rounded-xl p-4 flex flex-col items-center gap-2 cursor-pointer transition-all",children:[e.jsx("div",{className:(t?"bg-neutral-700":"bg-[#FF6B6B]/15")+" w-12 h-12 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-images text-[#FF6B6B]"})}),e.jsx("span",{className:(t?"text-white":"text-gray-900")+" text-xs font-medium",children:"Galeria"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:r=>{var g;(g=r.target.files)!=null&&g[0]&&(Vt(r.target.files[0]),he(!1))}})]}),e.jsxs("label",{className:(t?"bg-neutral-800 border-neutral-700 hover:border-[#FF6B6B]/50":"bg-gray-50 border-gray-200 hover:border-[#FF6B6B]/50")+" border rounded-xl p-4 flex flex-col items-center gap-2 cursor-pointer transition-all",children:[e.jsx("div",{className:(t?"bg-neutral-700":"bg-orange-100")+" w-12 h-12 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"fas fa-camera text-[#FF9F43]"})}),e.jsx("span",{className:(t?"text-white":"text-gray-900")+" text-xs font-medium",children:"Câmera"}),e.jsx("input",{type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:r=>{var g;(g=r.target.files)!=null&&g[0]&&(Vt(r.target.files[0]),he(!1))}})]})]}),e.jsx("button",{onClick:()=>he(!1),className:(t?"text-neutral-500 hover:text-white":"text-gray-500 hover:text-gray-700")+" w-full mt-4 py-2 text-xs font-medium",children:"Cancelar"})]})}),e.jsx(Cs,{isOpen:Ua,onConfirm:Ra,onCancel:_a,theme:$})]})},Ut=[{id:"cabeca",label:"👒 Cabeça",items:["Bonés","Chapéus","Tiaras","Lenços"]},{id:"parte-de-cima",label:"👕 Parte de Cima",items:["Camisetas","Blusas","Regatas","Tops","Camisas","Bodies","Jaquetas","Casacos","Blazers","Moletons"]},{id:"parte-de-baixo",label:"👖 Parte de Baixo",items:["Calças","Shorts","Bermudas","Saias","Leggings","Shorts Fitness"]},{id:"pecas-inteiras",label:"👗 Peças Inteiras",items:["Vestidos","Macacões","Jardineiras","Biquínis","Maiôs"]},{id:"calcados",label:"👟 Calçados",items:["Tênis","Sandálias","Botas","Sapatos","Chinelos"]},{id:"acessorios",label:"💍 Acessórios",items:["Bolsas","Cintos","Relógios","Óculos","Bijuterias","Mochilas","Outros Acessórios"]}];Ut.flatMap(n=>n.items);const Ls=n=>Ut.find(Y=>Y.items.includes(n)),Js=({products:n,userCredits:Y,onUpdateProduct:me,onDeductCredits:it,onAddHistoryLog:Ue,onImport:Me,currentPlan:Z,onCheckCredits:je,theme:$="dark",userId:z,savedModels:Ee,onSaveModel:kt,onOpenCreateModel:We,modelLimit:Pe=10,isGenerating:ot=!1,isMinimized:ct=!1,generationProgress:dt=0,generationText:Oe="",onSetGenerating:ye,onSetMinimized:De,onSetProgress:ne,onSetLoadingText:Qe,isAnyGenerationRunning:ge=!1,initialProduct:Re,onClearInitialProduct:ie,onBack:E,onOpenPlanModal:Ne})=>{var se,Ge,Ve,qe;const l=$==="dark",[ve,te]=m.useState(null),[xt,H]=m.useState(!1),[b,I]=m.useState(null),[oe,G]=m.useState("front"),[we,D]=m.useState(6),[ae,ue]=m.useState(20),[S,O]=m.useState(null),[p,R]=m.useState(null),[_,ce]=m.useState("front"),[T,ke]=m.useState({});m.useEffect(()=>{const a="vizzu_pending_generation";try{const x=localStorage.getItem(a);if(x){const o=JSON.parse(x);if((Date.now()-o.startTime)/1e3/60<=5&&o.productId){const f=n.find(j=>j.id===o.productId);f&&te(f)}}}catch(x){console.error("Erro ao verificar geração pendente:",x)}},[n]),m.useEffect(()=>{Re&&(te(Re),H(!0),ie==null||ie())},[Re,ie]);const V=(a,x,o)=>{o.stopPropagation(),ke(c=>({...c,[a]:x}))},de=a=>T[a]||"front",[i,fe]=m.useState(""),[M,ze]=m.useState(""),[K,Ye]=m.useState(""),C=m.useMemo(()=>{const a=[];return n.forEach(x=>{var o;(o=x.generatedImages)!=null&&o.modeloIA&&x.generatedImages.modeloIA.forEach((c,f)=>{var W,Je;const j=((W=c.images)==null?void 0:W.front)||c.imageUrl||c.url,k=((Je=c.images)==null?void 0:Je.back)||void 0,L=k?2:1;j&&a.push({id:c.id||`${x.id}-${f}`,productId:x.id,productName:x.name,productSku:x.sku,productCategory:x.category,imageUrl:j,backImageUrl:k,imageCount:L,createdAt:c.createdAt||new Date().toISOString(),metadata:c.metadata})})}),a.sort((x,o)=>new Date(o.createdAt).getTime()-new Date(x.createdAt).getTime())},[n]),Te=m.useMemo(()=>{const a={};C.forEach(o=>{var c;a[o.productId]||(a[o.productId]={asMain:[],asItem:[]}),a[o.productId].asMain.push(o),(c=o.metadata)!=null&&c.lookItems&&o.metadata.lookItems.forEach(f=>{f.productId&&f.productId!==o.productId&&(a[f.productId]||(a[f.productId]={asMain:[],asItem:[]}),a[f.productId].asItem.push(o))})});const x=[];return n.forEach(o=>{const c=a[o.id];if(c&&(c.asMain.length>0||c.asItem.length>0)){const f=new Set([...c.asMain,...c.asItem]),j=Array.from(f),k=c.asMain.reduce((L,W)=>L+W.imageCount,0);x.push({product:o,lookCount:j.length,looks:c.asMain,totalImageCount:k,participations:c.asItem.length})}}),x.sort((o,c)=>c.lookCount-o.lookCount)},[n,C]);m.useEffect(()=>{ue(20)},[i,M,K]);const re=m.useMemo(()=>n.filter(a=>{const x=!i||a.name.toLowerCase().includes(i.toLowerCase())||a.sku.toLowerCase().includes(i.toLowerCase()),o=Ls(a.category),c=!M||(o==null?void 0:o.id)===M,f=!K||a.category===K;return x&&c&&f}).sort((a,x)=>{const o=a.createdAt?new Date(a.createdAt).getTime():0;return(x.createdAt?new Date(x.createdAt).getTime():0)-o}),[n,i,M,K]),X=a=>{var x,o,c,f,j,k,L,W,Je,Ke;if((o=(x=a.generatedImages)==null?void 0:x.productStudio)!=null&&o.length){const Xe=a.generatedImages.productStudio[a.generatedImages.productStudio.length-1];if((c=Xe.images)!=null&&c.length){const Be=Xe.images.find(Mt=>Mt.angle==="front");if(Be!=null&&Be.url)return Be.url;if((f=Xe.images[0])!=null&&f.url)return Xe.images[0].url}}if((k=(j=a.originalImages)==null?void 0:j.front)!=null&&k.url)return a.originalImages.front.url;if((W=(L=a.images)==null?void 0:L[0])!=null&&W.url)return a.images[0].url;if((Ke=(Je=a.images)==null?void 0:Je[0])!=null&&Ke.base64)return a.images[0].base64},Fe=a=>{var x,o;return!!((o=(x=a.generatedImages)==null?void 0:x.productStudio)!=null&&o.length&&a.generatedImages.productStudio.some(c=>{var f;return((f=c.images)==null?void 0:f.length)>0}))},Ze=a=>{const x={};return C.filter(o=>{var c;return o.productId===a&&((c=o.metadata)==null?void 0:c.lookItems)}).forEach(o=>{var c,f;(f=(c=o.metadata)==null?void 0:c.lookItems)==null||f.forEach(j=>{j.productId&&j.productId!==a&&(x[j.productId]=(x[j.productId]||0)+1)})}),C.filter(o=>{var c,f;return(f=(c=o.metadata)==null?void 0:c.lookItems)==null?void 0:f.some(j=>j.productId===a)}).forEach(o=>{var c,f;o.productId!==a&&(x[o.productId]=(x[o.productId]||0)+1),(f=(c=o.metadata)==null?void 0:c.lookItems)==null||f.forEach(j=>{j.productId&&j.productId!==a&&(x[j.productId]=(x[j.productId]||0)+1)})}),Object.entries(x).sort((o,c)=>c[1]-o[1]).slice(0,6).map(([o,c])=>{const f=n.find(j=>j.id===o);return f?{product:f,count:c}:null}).filter(Boolean)},Nt=a=>{const x={};return C.filter(o=>{var c;return o.productId===a&&((c=o.metadata)==null?void 0:c.lookItems)}).forEach(o=>{var c,f;(f=(c=o.metadata)==null?void 0:c.lookItems)==null||f.forEach(j=>{if(j.productId){const k=n.find(L=>L.id===j.productId);k!=null&&k.color&&(x[k.color]=(x[k.color]||0)+1)}})}),C.filter(o=>{var c,f;return(f=(c=o.metadata)==null?void 0:c.lookItems)==null?void 0:f.some(j=>j.productId===a)}).forEach(o=>{var f,j;const c=n.find(k=>k.id===o.productId);c!=null&&c.color&&(x[c.color]=(x[c.color]||0)+1),(j=(f=o.metadata)==null?void 0:f.lookItems)==null||j.forEach(k=>{if(k.productId&&k.productId!==a){const L=n.find(W=>W.id===k.productId);L!=null&&L.color&&(x[L.color]=(x[L.color]||0)+1)}})}),Object.entries(x).sort((o,c)=>c[1]-o[1]).slice(0,6).map(([o,c])=>({color:o,count:c}))},he=()=>{H(!0),fe(""),ze(""),Ye(""),ue(20)},w=a=>{te(a),H(!1)},_e=()=>{te(null)},be=async(a,x,o="png")=>{await Aa(a,{filename:`look-${x.replace(/\s+/g,"-").toLowerCase()}.${o}`,shareTitle:"Vizzu Look Composer",shareText:`Look: ${x}`})},y=a=>{var o;const x=n.find(c=>c.id===a.productId);if(x&&((o=x.generatedImages)!=null&&o.modeloIA)){const c=x.generatedImages.modeloIA.filter((f,j)=>(f.id||`${x.id}-${j}`)!==a.id);me(x.id,{generatedImages:{...x.generatedImages,modeloIA:c}}),I(null),R(null)}},A=a=>{O(a),R(null)};return ve?e.jsx(As,{product:ve,products:n,userCredits:Y,onUpdateProduct:me,onDeductCredits:it,onAddHistoryLog:Ue,onBack:_e,onCheckCredits:je,theme:$,userId:z,savedModels:Ee,onSaveModel:kt,onOpenCreateModel:We,modelLimit:Pe,isGenerating:ot,isMinimized:ct,generationProgress:dt,generationText:Oe,onSetGenerating:ye,onSetMinimized:De,onSetProgress:ne,onSetLoadingText:Qe,isAnyGenerationRunning:ge,currentPlan:Z,onOpenPlanModal:Ne}):e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 "+(l?"bg-black":"bg-gray-50"),style:{paddingTop:"max(1rem, env(safe-area-inset-top, 1rem))"},children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[E&&e.jsx("button",{onClick:E,className:"w-10 h-10 shrink-0 rounded-xl flex items-center justify-center transition-all "+(l?"bg-white/10 backdrop-blur-xl border border-white/20 text-neutral-300 hover:text-white hover:bg-white/15 shadow-lg":"bg-white/60 backdrop-blur-xl border border-gray-200/60 text-gray-500 hover:text-gray-700 hover:bg-white/80 shadow-sm"),children:e.jsx("i",{className:"fas fa-arrow-left text-sm"})}),e.jsx("div",{className:"w-10 h-10 shrink-0 rounded-xl flex items-center justify-center backdrop-blur-xl "+(l?"bg-white/10 border border-white/15":"bg-white/60 border border-gray-200/60 shadow-sm"),children:e.jsx("i",{className:"fas fa-layer-group text-sm "+(l?"text-neutral-200":"text-[#1A1A1A]")})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h1",{className:(l?"text-white":"text-gray-900")+" text-base sm:text-lg font-extrabold truncate",children:"Vizzu Look Composer®"}),Z&&e.jsx("span",{className:(l?"bg-[#FF6B6B]/20 text-[#FF6B6B]":"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white")+" px-2 py-0.5 text-[9px] font-medium rounded-full uppercase tracking-wide shrink-0",children:Z.name})]}),e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-xs font-serif italic",children:"Seus looks criados com modelo IA"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end sm:self-auto shrink-0",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-1.5 px-3 py-1.5 rounded-lg "+(l?"bg-neutral-900 border border-neutral-800":"bg-white border border-gray-200 "),children:[e.jsx("i",{className:"fas fa-coins text-[#FF6B6B] text-xs"}),e.jsx("span",{className:(l?"text-white":"text-gray-900")+" font-medium text-sm",children:Y})]}),e.jsxs("button",{onClick:he,className:"flex items-center gap-1.5 px-3 py-2 sm:px-4 sm:py-2.5 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-xl font-medium text-xs sm:text-sm hover:opacity-90 transition-opacity",children:[e.jsx("i",{className:"fas fa-plus text-xs"}),e.jsx("span",{children:"Novo Look"})]})]})]}),e.jsxs("div",{className:(l?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-2xl border mb-6 overflow-hidden",children:[e.jsx("div",{className:"p-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center backdrop-blur-xl "+(l?"bg-white/10 border border-white/15":"bg-white/60 border border-gray-200/60 shadow-sm"),children:e.jsx("i",{className:(l?"text-neutral-200":"text-[#1A1A1A]")+" fas fa-clock text-sm"})}),e.jsxs("div",{children:[e.jsx("h2",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold",children:"Últimos Looks"}),e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[10px]",children:C.length>we?`Mostrando ${Math.min(we,C.length)} de ${C.length} looks`:`${C.length} looks criados`})]})]})}),C.length>0?e.jsxs("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-t p-4",children:[e.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-3",children:C.slice(0,we).map(a=>{const x=de(a.id),o=x==="back"&&a.backImageUrl?a.backImageUrl:a.imageUrl;return e.jsx("div",{onClick:()=>{I(a),G("front")},className:(l?"bg-neutral-800 border-neutral-700 hover:border-[#FF6B6B]/50":"bg-gray-50 border-gray-200 hover:border-[#FF6B6B]/40")+" rounded-xl border overflow-hidden cursor-pointer transition-all group",children:e.jsxs("div",{className:"aspect-[3/4] relative overflow-hidden bg-neutral-900",children:[e.jsx(Q,{src:o,alt:a.productName,className:"w-full h-full group-hover:scale-105 transition-transform",objectFit:"contain",size:"preview"}),a.imageCount>1&&e.jsxs("div",{className:"absolute top-2 right-2 px-1.5 py-0.5 bg-purple-500 text-white text-[9px] font-bold rounded-full flex items-center gap-0.5",children:[e.jsx("i",{className:"fas fa-images text-[7px]"}),a.imageCount]}),a.imageCount>1&&a.backImageUrl&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:c=>V(a.id,"front",c),className:"absolute left-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded-full flex items-center justify-center transition-all "+(x==="front"?"bg-[#FF6B6B]/100 text-white":"bg-black/50 text-white/70 hover:bg-black/70 hover:text-white"),children:e.jsx("i",{className:"fas fa-chevron-left text-[8px]"})}),e.jsx("button",{onClick:c=>V(a.id,"back",c),className:"absolute right-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded-full flex items-center justify-center transition-all "+(x==="back"?"bg-[#FF6B6B]/100 text-white":"bg-black/50 text-white/70 hover:bg-black/70 hover:text-white"),children:e.jsx("i",{className:"fas fa-chevron-right text-[8px]"})})]}),a.imageCount>1&&a.backImageUrl&&e.jsxs("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex items-center gap-1.5 z-10",children:[e.jsx("button",{onClick:c=>V(a.id,"front",c),className:"w-1.5 h-1.5 rounded-full transition-all "+(x==="front"?"bg-[#FF6B6B]/100 scale-125":"bg-white/50 hover:bg-white/80")}),e.jsx("button",{onClick:c=>V(a.id,"back",c),className:"w-1.5 h-1.5 rounded-full transition-all "+(x==="back"?"bg-[#FF6B6B]/100 scale-125":"bg-white/50 hover:bg-white/80")})]}),a.imageCount>1&&e.jsx("div",{className:"absolute top-2 left-2 px-1.5 py-0.5 rounded text-[8px] font-medium "+(l?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:x==="front"?"Frente":"Costas"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none"}),e.jsx("div",{className:"absolute bottom-6 left-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsx("p",{className:"text-white text-[9px] font-medium truncate",children:a.productName})})]})},a.id)})}),we<C.length&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{onClick:()=>D(a=>a+6),className:(l?"bg-neutral-800 hover:bg-neutral-700 text-white border-neutral-700":"bg-gray-50 hover:bg-gray-100 text-gray-700 border-gray-200")+" px-6 py-2.5 border rounded-xl font-medium text-sm flex items-center gap-2 transition-colors",children:[e.jsx("i",{className:"fas fa-chevron-down text-xs"}),"Carregar mais (",C.length-we," restantes)"]})})]}):e.jsxs("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-t p-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center mx-auto mb-3 "+(l?"bg-neutral-800":"bg-gray-100"),children:e.jsx("i",{className:(l?"text-neutral-600":"text-gray-400")+" fas fa-layer-group text-xl"})}),e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-sm mb-4",children:"Nenhum look criado ainda"}),e.jsxs("button",{onClick:he,className:"px-4 py-2 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-lg font-medium text-xs hover:opacity-90 transition-opacity",children:[e.jsx("i",{className:"fas fa-plus mr-1.5"}),"Criar primeiro look"]})]})]}),Te.length>0&&e.jsxs("div",{className:(l?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200 ")+" rounded-2xl border overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center "+(l?"bg-purple-500/20":"bg-purple-100"),children:e.jsx("i",{className:(l?"text-purple-400":"text-purple-500")+" fas fa-shirt text-sm"})}),e.jsxs("div",{children:[e.jsx("h2",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold",children:"Explorar por Produto"}),e.jsxs("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[10px]",children:[Te.length," produtos com looks"]})]})]})}),e.jsx("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-t p-4",children:e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-3",children:Te.map(a=>{const x=X(a.product),o=Fe(a.product);return e.jsxs("div",{onClick:()=>A(a),className:(l?"bg-neutral-800 border-neutral-700 hover:border-[#A855F7]/50":"bg-gray-50 border-gray-200 hover:border-[#A855F7]/30")+" rounded-xl border overflow-hidden cursor-pointer transition-all group",children:[e.jsxs("div",{className:(l?"bg-neutral-700":"bg-gray-100")+" aspect-square relative overflow-hidden",children:[x?e.jsx(Q,{src:x,alt:a.product.name,className:"w-full h-full group-hover:scale-105 transition-transform",size:"preview"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:(l?"text-neutral-600":"text-gray-400")+" fas fa-image text-2xl"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1 items-end",children:[a.looks.length>0&&e.jsxs("div",{className:"px-2 py-1 bg-[#FF6B6B]/100 text-white text-[10px] font-bold rounded-full flex items-center gap-1",title:`${a.looks.length} look${a.looks.length>1?"s":""} criado${a.looks.length>1?"s":""}`,children:[e.jsx("i",{className:"fas fa-layer-group text-[8px]"}),a.looks.length]}),a.totalImageCount>a.looks.length&&e.jsxs("div",{className:"px-2 py-1 bg-purple-500 text-white text-[10px] font-bold rounded-full flex items-center gap-1",title:`${a.totalImageCount} imagens (frente + costas)`,children:[e.jsx("i",{className:"fas fa-images text-[8px]"}),a.totalImageCount]}),a.participations&&a.participations>0&&e.jsxs("div",{className:"px-2 py-1 bg-blue-500 text-white text-[10px] font-bold rounded-full flex items-center gap-1",title:"Participou em looks",children:[e.jsx("i",{className:"fas fa-plus text-[8px]"}),a.participations]})]}),o&&e.jsx("div",{className:"absolute top-2 left-2 w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center",title:"Otimizado no Product Studio",children:e.jsx("i",{className:"fas fa-cube text-[10px]"})})]}),e.jsxs("div",{className:"p-2.5",children:[e.jsx("p",{className:(l?"text-neutral-500":"text-gray-400")+" text-[8px] font-medium uppercase tracking-wide",children:a.product.sku}),e.jsx("p",{className:(l?"text-white":"text-gray-900")+" text-xs font-medium truncate mt-0.5",children:a.product.name})]})]},a.product.id)})})})]})]}),xt&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:(l?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" rounded-2xl border w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:(l?"text-white":"text-gray-900")+" text-lg font-semibold font-serif",children:"Selecione o produto principal"}),e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-xs",children:"Escolha a peça base para criar o look"})]}),e.jsx("button",{onClick:()=>H(!1),className:(l?"text-neutral-500 hover:text-white":"text-gray-400 hover:text-gray-600")+" w-8 h-8 flex items-center justify-center rounded-lg hover:bg-neutral-800/50 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-4 flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("i",{className:(l?"text-neutral-600":"text-gray-400")+" fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-sm"}),e.jsx("input",{type:"text",id:"lc-modal-search",name:"lookComposerSearch",placeholder:"Buscar produto...",value:i,onChange:a=>fe(a.target.value),className:(l?"bg-neutral-800 border-neutral-700 text-white placeholder-neutral-500":"bg-gray-50 border-gray-200 text-gray-900 placeholder-gray-400")+" w-full pl-10 pr-4 py-2.5 border rounded-xl text-sm focus:outline-none focus:border-[#FF6B6B]/50",autoFocus:!0})]}),e.jsxs("select",{id:"lc-modal-category",name:"lookComposerCategory",value:M,onChange:a=>{ze(a.target.value),Ye("")},className:(l?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Categoria"}),Ut.map(a=>e.jsx("option",{value:a.id,children:a.label},a.id))]}),M&&e.jsxs("select",{id:"lc-modal-subcategory",name:"lookComposerSubcategory",value:K,onChange:a=>Ye(a.target.value),className:(l?"bg-neutral-800 border-neutral-700 text-white":"bg-gray-50 border-gray-200 text-gray-900")+" px-4 py-2.5 border rounded-xl text-sm sm:w-40",children:[e.jsx("option",{value:"",children:"Subcategoria"}),(se=Ut.find(a=>a.id===M))==null?void 0:se.items.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pt-0",children:re.length>0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[10px] mb-3",children:re.length>ae?`Mostrando ${Math.min(ae,re.length)} de ${re.length} produtos`:`${re.length} produtos`}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:re.slice(0,ae).map(a=>{const x=X(a),o=Fe(a);return e.jsxs("div",{onClick:()=>w(a),className:(l?"bg-neutral-800 border-neutral-700 hover:border-[#FF6B6B]/50":"bg-gray-50 border-gray-200 hover:border-[#FF6B6B]/40")+" rounded-xl border overflow-hidden cursor-pointer transition-all group",children:[e.jsxs("div",{className:(l?"bg-neutral-700":"bg-gray-100")+" aspect-square relative overflow-hidden",children:[e.jsx(Q,{src:x,size:"preview",alt:a.name,className:"w-full h-full group-hover:scale-105 transition-transform"}),o&&e.jsx("div",{className:"absolute top-2 left-2 w-6 h-6 bg-green-500 text-white rounded-full flex items-center justify-center",title:"Otimizado no Product Studio",children:e.jsx("i",{className:"fas fa-cube text-[10px]"})}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("button",{className:"w-full py-1.5 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-lg font-medium text-[10px]",children:[e.jsx("i",{className:"fas fa-check mr-1"}),"Selecionar"]})})]}),e.jsxs("div",{className:"p-2.5",children:[e.jsx("p",{className:(l?"text-neutral-500":"text-gray-400")+" text-[8px] font-medium uppercase tracking-wide",children:a.sku}),e.jsx("p",{className:(l?"text-white":"text-gray-900")+" text-xs font-medium truncate mt-0.5",children:a.name}),a.category&&e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[9px] mt-1",children:a.category})]})]},a.id)})}),ae<re.length&&e.jsx("div",{className:"flex justify-center mt-4",children:e.jsxs("button",{onClick:()=>ue(a=>a+20),className:(l?"bg-neutral-800 hover:bg-neutral-700 text-white border-neutral-700":"bg-gray-50 hover:bg-gray-100 text-gray-700 border-gray-200")+" px-6 py-2.5 border rounded-xl font-medium text-sm flex items-center gap-2 transition-colors",children:[e.jsx("i",{className:"fas fa-chevron-down text-xs"}),"Carregar mais (",re.length-ae," restantes)"]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:(l?"bg-neutral-800":"bg-gray-100")+" w-14 h-14 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx("i",{className:(l?"text-neutral-600":"text-gray-400")+" fas fa-search text-xl"})}),e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-sm",children:"Nenhum produto encontrado"})]})})]})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:(l?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" rounded-2xl border w-full max-w-3xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:(l?"text-white":"text-gray-900")+" text-lg font-semibold font-serif",children:b.productName}),e.jsxs("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-xs",children:[b.productSku," • ",new Date(b.createdAt).toLocaleDateString("pt-BR")]})]}),b.imageCount>1&&e.jsxs("div",{className:"px-2.5 py-1 bg-purple-500 text-white text-xs font-bold rounded-full flex items-center gap-1.5",children:[e.jsx("i",{className:"fas fa-images text-[10px]"}),b.imageCount," fotos"]})]}),e.jsx("button",{onClick:()=>{I(null),G("front")},className:(l?"text-neutral-500 hover:text-white":"text-gray-400 hover:text-gray-600")+" w-8 h-8 flex items-center justify-center rounded-lg hover:bg-neutral-800/50 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-4 flex flex-col md:flex-row gap-4 overflow-y-auto max-h-[calc(90vh-80px)]",children:[e.jsxs("div",{className:"md:w-2/3",children:[e.jsxs("div",{className:(l?"bg-neutral-800":"bg-gray-100")+" rounded-xl overflow-hidden relative",children:[e.jsx("img",{src:oe==="back"&&b.backImageUrl?b.backImageUrl:b.imageUrl,alt:b.productName,className:"w-full h-auto max-h-[60vh] object-contain"}),b.imageCount>1&&e.jsxs("div",{className:"absolute top-3 left-3 px-2 py-1 rounded-lg text-[10px] font-medium "+(l?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1 text-[8px]"}),oe==="front"?"Frente":"Costas"]})]}),b.imageCount>1&&b.backImageUrl&&e.jsx("div",{className:"flex items-center justify-center gap-2 mt-3",children:e.jsxs("div",{className:"flex items-center gap-1 p-1 rounded-lg "+(l?"bg-neutral-800":"bg-gray-100"),children:[e.jsxs("button",{onClick:()=>G("front"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(oe==="front"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":l?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1.5"}),"Frente"]}),e.jsxs("button",{onClick:()=>G("back"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(oe==="back"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":l?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1.5"}),"Costas"]})]})})]}),e.jsxs("div",{className:"md:w-1/3 flex flex-col gap-3",children:[((Ge=b.metadata)==null?void 0:Ge.modelName)&&e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsxs("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-user mr-2 text-[#FF6B6B]"}),"Modelo"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[(Ve=b.metadata)!=null&&Ve.modelThumbnail?e.jsx("div",{className:(l?"bg-neutral-700":"bg-gray-100")+" w-12 h-12 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx(Q,{src:b.metadata.modelThumbnail,alt:b.metadata.modelName,className:"w-full h-full",size:"thumb"})}):e.jsx("div",{className:(l?"bg-neutral-700":"bg-gray-100")+" w-12 h-12 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:(l?"text-neutral-500":"text-gray-400")+" fas fa-user"})}),e.jsx("div",{children:e.jsx("p",{className:(l?"text-white":"text-gray-900")+" text-sm font-medium",children:b.metadata.modelName})})]})]}),((qe=b.metadata)==null?void 0:qe.lookItems)&&b.metadata.lookItems.length>0&&e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsxs("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:[e.jsx("i",{className:"fas fa-shirt mr-2 text-purple-400"}),"Peças Utilizadas"]}),e.jsx("div",{className:"space-y-2",children:b.metadata.lookItems.map((a,x)=>{const o=a.productId?n.find(f=>f.id===a.productId):null,c=a.image||(o?X(o):void 0);return e.jsxs("div",{className:(l?"bg-neutral-700/50":"bg-gray-100")+" rounded-lg p-2 flex items-center gap-3",children:[c?e.jsx("div",{className:(l?"bg-neutral-600":"bg-gray-200")+" w-10 h-10 rounded-lg overflow-hidden flex-shrink-0",children:e.jsx(Q,{src:c,alt:a.name||a.slot,className:"w-full h-full",objectFit:"contain",size:"thumb"})}):e.jsx("div",{className:(l?"bg-neutral-600":"bg-gray-200")+" w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:(l?"text-neutral-500":"text-gray-400")+" fas fa-image text-xs"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(l?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:a.name||a.slot}),a.sku&&a.sku!=="external"&&e.jsx("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[10px]",children:a.sku})]}),e.jsx("span",{className:(l?"bg-neutral-600 text-neutral-400":"bg-gray-200 text-gray-500")+" px-2 py-0.5 rounded text-[9px] uppercase",children:a.slot})]},x)})})]}),e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsx("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:"Download"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>be(oe==="back"&&b.backImageUrl?b.backImageUrl:b.imageUrl,`${b.productName}${b.imageCount>1?`-${oe}`:""}`,"png"),className:(l?"bg-neutral-700 hover:bg-neutral-600 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-900")+" flex-1 py-2.5 rounded-lg font-medium text-xs transition-colors",children:["PNG ",b.imageCount>1&&(oe==="front"?"(Frente)":"(Costas)")]})}),b.imageCount>1&&b.backImageUrl&&e.jsxs("button",{onClick:async()=>{await be(b.imageUrl,`${b.productName}-frente`,"png"),await new Promise(a=>setTimeout(a,500)),b.backImageUrl&&await be(b.backImageUrl,`${b.productName}-costas`,"png")},className:"w-full py-2.5 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-medium text-xs transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-images"}),"Baixar Todas (",b.imageCount,")"]})]})]}),e.jsxs("button",{onClick:()=>{const a=n.find(x=>x.id===b.productId);a&&(I(null),G("front"),te(a))},className:"w-full py-3 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-xl font-medium text-sm hover:opacity-90 transition-opacity flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles"}),"Criar novo look"]}),e.jsxs("button",{onClick:()=>{confirm("Tem certeza que deseja excluir este look?")&&y(b)},className:(l?"bg-red-500/20 hover:bg-red-500/30 text-red-400":"bg-red-50 hover:bg-red-100 text-red-600")+" w-full py-2.5 rounded-xl font-medium text-xs transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-trash"}),"Excluir look"]})]})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:(l?"bg-neutral-900 border-neutral-800":"bg-white border-gray-200")+" rounded-2xl border w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:(l?"border-neutral-800":"border-gray-200")+" border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:(l?"bg-neutral-800":"bg-gray-100")+" w-12 h-12 rounded-lg overflow-hidden",children:X(S.product)?e.jsx(Q,{src:X(S.product),alt:"",className:"w-full h-full",size:"thumb"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:(l?"text-neutral-600":"text-gray-400")+" fas fa-image"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:(l?"text-white":"text-gray-900")+" text-lg font-semibold font-serif",children:S.product.name}),e.jsxs("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-xs",children:[S.product.sku," • ",S.lookCount," looks"]})]})]}),e.jsx("button",{onClick:()=>{O(null),R(null)},className:(l?"text-neutral-500 hover:text-white":"text-gray-400 hover:text-gray-600")+" w-8 h-8 flex items-center justify-center rounded-lg hover:bg-neutral-800/50 transition-colors",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsxs("div",{className:"lg:w-1/2",children:[e.jsxs("div",{className:(l?"bg-neutral-800":"bg-gray-100")+" rounded-xl overflow-hidden aspect-[3/4] relative",children:[e.jsx("img",{src:p?_==="back"&&p.backImageUrl?p.backImageUrl:p.imageUrl:X(S.product),alt:S.product.name,className:"w-full h-full object-contain"}),p&&p.imageCount>1&&e.jsxs("div",{className:"absolute top-3 left-3 px-2 py-1 rounded-lg text-[10px] font-medium "+(l?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1 text-[8px]"}),_==="front"?"Frente":"Costas"]}),p&&p.imageCount>1&&e.jsxs("div",{className:"absolute top-3 right-3 px-2 py-1 bg-purple-500 text-white text-[10px] font-bold rounded-lg flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-images text-[8px]"}),p.imageCount," fotos"]})]}),p&&e.jsxs("div",{className:"mt-3 flex flex-col gap-2",children:[e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>be(_==="back"&&p.backImageUrl?p.backImageUrl:p.imageUrl,`${p.productName}${p.imageCount>1?`-${_}`:""}`,"png"),className:"flex-1 py-2.5 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-lg font-medium text-xs hover:opacity-90 transition-opacity flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-download"}),"Download ",p.imageCount>1&&(_==="front"?"(Frente)":"(Costas)")]})}),p.imageCount>1&&p.backImageUrl&&e.jsxs("button",{onClick:async()=>{await be(p.imageUrl,`${p.productName}-frente`,"png"),await new Promise(a=>setTimeout(a,500)),p.backImageUrl&&await be(p.backImageUrl,`${p.productName}-costas`,"png")},className:"w-full py-2.5 bg-purple-500 hover:bg-purple-600 text-white rounded-lg font-medium text-xs transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-images"}),"Baixar Todas (",p.imageCount,")"]})]})]}),e.jsxs("div",{className:"lg:w-1/2 space-y-4",children:[e.jsxs("button",{onClick:()=>{O(null),R(null),te(S.product)},className:"w-full py-3 bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white rounded-xl font-medium text-sm hover:opacity-90 transition-opacity flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-wand-magic-sparkles"}),"Gerar novo look com este produto"]}),e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsxs("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:["Looks criados (",S.lookCount,")"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:S.looks.map(a=>{const x=de(`modal-${a.id}`),o=x==="back"&&a.backImageUrl?a.backImageUrl:a.imageUrl;return e.jsxs("div",{onClick:()=>{R(a),ce("front")},className:((p==null?void 0:p.id)===a.id?"ring-2 ring-[#FF6B6B] ":"")+(l?"bg-neutral-700 hover:bg-neutral-600":"bg-gray-100 hover:bg-gray-200")+" rounded-lg overflow-hidden cursor-pointer transition-all aspect-[3/4] relative group/thumb",children:[e.jsx(Q,{src:o,alt:a.productName,className:"w-full h-full",objectFit:"contain",size:"preview"}),a.imageCount>1&&e.jsxs("div",{className:"absolute top-1 right-1 px-1.5 py-0.5 bg-purple-500 text-white text-[8px] font-bold rounded-full flex items-center gap-0.5",children:[e.jsx("i",{className:"fas fa-images text-[6px]"}),a.imageCount]}),a.imageCount>1&&e.jsx("div",{className:"absolute top-1 left-1 px-1 py-0.5 rounded text-[7px] font-medium "+(l?"bg-black/60 text-white":"bg-white/80 text-gray-700"),children:x==="front"?"F":"C"}),a.imageCount>1&&a.backImageUrl&&e.jsxs("div",{className:"absolute bottom-1 left-1/2 -translate-x-1/2 flex items-center gap-1 z-10",children:[e.jsx("button",{onClick:c=>V(`modal-${a.id}`,"front",c),className:"w-1.5 h-1.5 rounded-full transition-all "+(x==="front"?"bg-[#FF6B6B]/100":"bg-white/50 hover:bg-white/80")}),e.jsx("button",{onClick:c=>V(`modal-${a.id}`,"back",c),className:"w-1.5 h-1.5 rounded-full transition-all "+(x==="back"?"bg-[#FF6B6B]/100":"bg-white/50 hover:bg-white/80")})]})]},a.id)})})]}),p&&p.imageCount>1&&p.backImageUrl&&e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsx("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:"Visualização"}),e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 p-1 rounded-lg "+(l?"bg-neutral-700":"bg-gray-200"),children:[e.jsxs("button",{onClick:()=>ce("front"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(_==="front"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":l?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1.5"}),"Frente"]}),e.jsxs("button",{onClick:()=>ce("back"),className:"px-3 py-1.5 rounded-md text-xs font-medium transition-all "+(_==="back"?"bg-gradient-to-r from-[#FF6B6B] to-[#FF9F43] text-white ":l?"text-neutral-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:[e.jsx("i",{className:"fas fa-eye mr-1.5"}),"Costas"]})]})})]}),(()=>{const a=Ze(S.product.id);return a.length===0?null:e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsx("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:"Muito usado com"}),e.jsx("div",{className:"space-y-2",children:a.map(({product:x,count:o})=>e.jsxs("div",{className:(l?"bg-neutral-700/50":"bg-gray-100")+" rounded-lg p-2 flex items-center gap-3",children:[e.jsx("div",{className:(l?"bg-neutral-600":"bg-gray-200")+" w-10 h-10 rounded-lg overflow-hidden flex-shrink-0",children:X(x)?e.jsx(Q,{src:X(x),alt:"",className:"w-full h-full",size:"thumb"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:(l?"text-neutral-500":"text-gray-400")+" fas fa-image text-xs"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:(l?"text-white":"text-gray-900")+" text-xs font-medium truncate",children:x.name}),e.jsxs("p",{className:(l?"text-neutral-500":"text-gray-500")+" text-[10px]",children:["Usado ",o,"x juntos"]})]}),e.jsxs("div",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 text-[10px] font-bold rounded-full",children:[o,"x"]})]},x.id))})]})})(),(()=>{const a=Nt(S.product.id);return a.length===0?null:e.jsxs("div",{className:(l?"bg-neutral-800 border-neutral-700":"bg-gray-50 border-gray-200")+" rounded-xl border p-4",children:[e.jsx("h3",{className:(l?"text-white":"text-gray-900")+" text-sm font-semibold mb-3",children:"Cores mais usadas com este produto"}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:a.map(({color:x,count:o})=>e.jsxs("span",{className:(l?"bg-neutral-700 text-neutral-300":"bg-gray-200 text-gray-700")+" px-3 py-1.5 rounded-full text-xs font-medium flex items-center gap-1.5",children:[x,e.jsxs("span",{className:(l?"bg-neutral-600 text-neutral-400":"bg-gray-300 text-gray-600")+" px-1.5 py-0.5 rounded-full text-[9px]",children:[o,"x"]})]},x))})]})})()]})]})})]})})]})};export{Js as LookComposer};
